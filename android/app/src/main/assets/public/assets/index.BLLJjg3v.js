const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/web.Bmh9vDzE.js","assets/vendor.jp6HjmV4.js","assets/supabase.DCGCbtK8.js","assets/web.BX5UnY3j.js","assets/web.CoCiFJBs.js","assets/index.DKlBgY7z.js"])))=>i.map(i=>d[i]);
var ta=Object.defineProperty;var sa=(s,t,r)=>t in s?ta(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r;var Ye=(s,t,r)=>sa(s,typeof t!="symbol"?t+"":t,r);import{r as i,a as Re,u as je,N as Ps,O as ra,R as Me,b as rs,g as na,c as Ae,d as ns,e as dn,f as aa,L as qe,B as ia,h as oa,i as xe,j as la}from"./vendor.jp6HjmV4.js";import{c as ca,_ as Tt,S as un,T as mn}from"./supabase.DCGCbtK8.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=r(a);fetch(a.href,o)}})();var hn={exports:{}},At={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var da=i,ua=Symbol.for("react.element"),ma=Symbol.for("react.fragment"),ha=Object.prototype.hasOwnProperty,ga=da.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,fa={key:!0,ref:!0,__self:!0,__source:!0};function gn(s,t,r){var n,a={},o=null,l=null;r!==void 0&&(o=""+r),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(l=t.ref);for(n in t)ha.call(t,n)&&!fa.hasOwnProperty(n)&&(a[n]=t[n]);if(s&&s.defaultProps)for(n in t=s.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:ua,type:s,key:o,ref:l,props:a,_owner:ga.current}}At.Fragment=ma;At.jsx=gn;At.jsxs=gn;hn.exports=At;var e=hn.exports,fn,Os=Re;fn=Os.createRoot,Os.hydrateRoot;var pa={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const xa=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Q=(s,t)=>{const r=i.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:o=2,absoluteStrokeWidth:l,children:d,...c},h)=>i.createElement("svg",{ref:h,...pa,width:a,height:a,stroke:n,strokeWidth:l?Number(o)*24/Number(a):o,className:`lucide lucide-${xa(s)}`,...c},[...t.map(([f,u])=>i.createElement(f,u)),...(Array.isArray(d)?d:[d])||[]]));return r.displayName=`${s}`,r},Ve=Q("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),yt=Q("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),as=Q("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),Ft=Q("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),is=Q("BarChart",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]),Zt=Q("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),va=Q("BookMarked",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20",key:"t4utmx"}],["polyline",{points:"10 2 10 10 13 7 16 10 16 2",key:"13o6vz"}]]),le=Q("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),Ut=Q("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),fe=Q("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),bt=Q("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),pn=Q("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),xn=Q("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),Fe=Q("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Be=Q("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]),ya=Q("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]),Ds=Q("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),Kt=Q("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),vn=Q("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),ba=Q("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),yn=Q("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),wa=Q("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),ja=Q("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]),bn=Q("LayoutList",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["path",{d:"M14 4h7",key:"3xa0d5"}],["path",{d:"M14 9h7",key:"1icrd9"}],["path",{d:"M14 15h7",key:"1mj8o2"}],["path",{d:"M14 20h7",key:"11slyb"}]]),wt=Q("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),Ts=Q("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),jt=Q("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),os=Q("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),at=Q("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),Na=Q("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),Yt=Q("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]),ka=Q("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),wn=Q("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),ls=Q("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),Ca=Q("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),Pe=Q("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Ce=Q("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),It=Q("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),tt=Q("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),jn=Q("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),La=Q("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Nn=Q("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),Ea=Q("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),Sa=Q("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),Jt=Q("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),We=Q("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),_a=Q("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),rt=Q("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),ze=Q("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),cs=Q("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),ve=Q("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Bt=Q("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),he=Q("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Ma="https://cwbdhswftljelgwgjxnc.supabase.co",Pa="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImN3YmRoc3dmdGxqZWxnd2dqeG5jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDc5NTgxODYsImV4cCI6MjA2MzUzNDE4Nn0.A1QyHH0w_AxLzSFxbuvne4pqtJI17S5vs11CIjx6UgE",O=ca(Ma,Pa,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storageKey:"supabase.auth.token",flowType:"pkce"}});async function kn(){try{const{data:s,error:t}=await O.auth.getSession();if(t)return console.error("Auth initialization failed:",t.message),!1;const{error:r}=await O.from("profiles").select("count").limit(0);return r?(console.error("Database connection test failed:",r.message),!1):!0}catch(s){return console.error("Supabase connection test failed:",s),!1}}async function Oa(s){try{const{data:{user:t}}=await O.auth.getUser();if(!t)throw new Error("No user found");let r=s.profile_photo_url;if(s.photo_file){const d=s.photo_file.name.split(".").pop(),h=`profile-photos/${`${t.id}-${Date.now()}.${d}`}`,{error:f,data:u}=await O.storage.from("profile-photos").upload(h,s.photo_file);if(f)throw f;const{data:{publicUrl:v}}=O.storage.from("profile-photos").getPublicUrl(h);r=v}const{photo_file:n,...a}=s,{data:o,error:l}=await O.from("user_settings").upsert({user_id:t.id,...a,profile_photo_url:r,updated_at:new Date().toISOString()}).select().single();if(l)throw l;return{data:o,error:null}}catch(t){return console.error("Error saving settings:",t),{data:null,error:t}}}const Cn=i.createContext(void 0),Ue=()=>{const s=i.useContext(Cn);if(!s)throw new Error("useProfiles must be used within a ProfilesProvider");return s},Da=({children:s})=>{const[t,r]=i.useState([]),[n,a]=i.useState([]),[o,l]=i.useState(!0),[d,c]=i.useState(null),[h,f]=i.useState([]),u=[...t,...n];i.useEffect(()=>{let g=!0;return(async()=>{try{if(!await kn())throw new Error("Failed to establish connection with Supabase");if(g){const C=O.auth.onAuthStateChange((_,A)=>{_==="SIGNED_IN"||_==="INITIAL_SESSION"?A!=null&&A.user&&v():_==="SIGNED_OUT"&&(r([]),a([]),f([]))}),{data:{session:L}}=await O.auth.getSession();return L!=null&&L.user&&await v(),()=>{C.data.subscription.unsubscribe()}}}catch(x){if(g){const C=x instanceof Error?x.message:"Failed to initialize Supabase connection";c(C),console.error("Connection initialization error:",x)}}finally{g&&l(!1)}})(),()=>{g=!1}},[]);const v=async()=>{try{const{data:{user:g},error:p}=await O.auth.getUser();if(p)throw p;if(!g){r([]),a([]),f([]);return}console.log("🔍 PROFILES: Fetching profiles for user:",g.id),await N(g.id),await b(g.id),await S(g.id)}catch(g){const p=g instanceof Error?g.message:"Failed to fetch profiles";c(p),console.error("Error fetching profiles:",g),r([]),a([]),f([])}},N=async g=>{try{console.log("🤝 PROFILES: Fetching friendship cache for user:",g);const{data:p,error:x}=await O.from("friendships").select(`
          user_id,
          role,
          created_at,
          updated_at
        `).eq("friend_id",g).order("updated_at",{ascending:!1});if(x)throw console.error("❌ PROFILES: Error fetching friendships:",x),x;if(console.log("🤝 PROFILES: Found friendships where user is friend:",(p==null?void 0:p.length)||0),console.log("🤝 PROFILES: Friendship details:",p),!p||p.length===0){console.log("❌ PROFILES: No friendships found where user is friend"),f([]);return}const C=p.map(R=>R.user_id),{data:L,error:_}=await O.from("user_settings").select("user_id, full_name").in("user_id",C);if(_)throw console.error("❌ PROFILES: Error fetching user settings for friendship cache:",_),_;const A=p.map(R=>{const q=L==null?void 0:L.find(z=>z.user_id===R.user_id);return{friend_user_id:R.user_id,role:R.role,friend_name:(q==null?void 0:q.full_name)||"Friend"}});console.log("✅ PROFILES: Built friendship cache:",A),console.log("👑 PROFILES: Administrator access to users:",A.filter(R=>R.role==="administrator").map(R=>R.friend_name)),f(A)}catch(p){console.error("💥 PROFILES: Error fetching friendship cache:",p),f([])}},b=async g=>{console.log("📋 PROFILES: Fetching own profiles for user:",g);const{data:p,error:x}=await O.from("profiles").select(`
        id,
        name,
        age,
        color,
        photo_url,
        notes,
        user_id,
        profile_sports (
          sport,
          color
        )
      `).eq("user_id",g);if(x)throw console.error("❌ PROFILES: Error fetching own profiles:",x),x;console.log("✅ PROFILES: Found own profiles:",(p==null?void 0:p.length)||0);const C=(p==null?void 0:p.map(L=>{var _;return{id:L.id,name:L.name,age:L.age,color:L.color,photo_url:L.photo_url,notes:L.notes,sports:((_=L.profile_sports)==null?void 0:_.map(A=>({name:A.sport,color:A.color})))||[],eventCount:0,isOwnProfile:!0}}))||[];r(C)},S=async g=>{try{console.log("👥 PROFILES: Fetching friends profiles for user:",g);const p=h.filter(A=>A.role==="administrator");if(console.log("👑 PROFILES: Administrator friendships from cache:",p),p.length===0){console.log("❌ PROFILES: No administrator access found in friendship cache"),a([]);return}const x=p.map(A=>A.friend_user_id);console.log("👑 PROFILES: User IDs where we have admin access:",x);const{data:C,error:L}=await O.from("profiles").select(`
          id,
          name,
          age,
          color,
          photo_url,
          notes,
          user_id,
          profile_sports (
            sport,
            color
          )
        `).in("user_id",x);if(L)throw console.error("❌ PROFILES: Error fetching friend profiles:",L),L;console.log("✅ PROFILES: Found friend profiles:",(C==null?void 0:C.length)||0),console.log("✅ PROFILES: Friend profiles data:",C);const _=(C==null?void 0:C.map(A=>{var q;const R=p.find(z=>z.friend_user_id===A.user_id);return{id:A.id,name:A.name,age:A.age,color:A.color,photo_url:A.photo_url,notes:A.notes,sports:((q=A.profile_sports)==null?void 0:q.map(z=>({name:z.sport,color:z.color})))||[],eventCount:0,isOwnProfile:!1,ownerName:(R==null?void 0:R.friend_name)||"Friend",ownerPhoto:void 0,accessRole:R==null?void 0:R.role}}))||[];console.log("✅ PROFILES: Formatted friends profiles:",_),a(_)}catch(p){console.error("💥 PROFILES: Error fetching friends profiles:",p),a([])}},E=async g=>{var p;try{const{data:{user:x},error:C}=await O.auth.getUser();if(C)throw C;if(!x)throw new Error("No authenticated user");const{data:L,error:_}=await O.from("profiles").select(`
          id,
          name,
          age,
          color,
          photo_url,
          notes,
          user_id,
          profile_sports (
            sport,
            color
          )
        `).eq("id",g).single();if(_)throw _;if(!L)throw new Error("Profile not found");const A=L.user_id===x.id;let R,q;if(!A){const z=h.find(G=>G.friend_user_id===L.user_id);if(!z)throw new Error("Access denied: No friendship found");R=z.friend_name}return{id:L.id,name:L.name,age:L.age,color:L.color,photo_url:L.photo_url,notes:L.notes,sports:((p=L.profile_sports)==null?void 0:p.map(z=>({name:z.sport,color:z.color})))||[],eventCount:0,isOwnProfile:A,ownerName:R,ownerPhoto:q}}catch(x){throw new Error(x instanceof Error?x.message:"Failed to fetch profile")}},k=async g=>{var p;try{const{data:{user:x},error:C}=await O.auth.getUser();if(C)throw C;if(!x)throw new Error("No authenticated user");const{data:L,error:_}=await O.from("profiles").insert({name:g.name,age:g.age,color:g.color,photo_url:g.photo_url,notes:g.notes,user_id:x.id}).select().single();if(_)throw _;if(((p=g.sports)==null?void 0:p.length)>0){const{error:A}=await O.from("profile_sports").insert(g.sports.map(R=>({profile_id:L.id,sport:R.name,color:R.color})));if(A)throw A}await v()}catch(x){const C=x instanceof Error?x.message:"Failed to add profile";throw c(C),x}},y=async(g,p)=>{try{const{data:{user:x},error:C}=await O.auth.getUser();if(C)throw C;if(!x)throw new Error("No authenticated user");const{error:L}=await O.from("profiles").update({name:p.name,age:p.age,color:p.color,photo_url:p.photo_url,notes:p.notes}).eq("id",g);if(L)throw L;if(p.sports&&(await O.from("profile_sports").delete().eq("profile_id",g),p.sports.length>0)){const{error:_}=await O.from("profile_sports").insert(p.sports.map(A=>({profile_id:g,sport:A.name,color:A.color})));if(_)throw _}await v()}catch(x){const C=x instanceof Error?x.message:"Failed to update profile";throw c(C),x}},m=async g=>{try{const{data:{user:p},error:x}=await O.auth.getUser();if(x)throw x;if(!p)throw new Error("No authenticated user");const{error:C}=await O.from("profiles").delete().eq("id",g);if(C)throw C;r(t.filter(L=>L.id!==g)),a(n.filter(L=>L.id!==g))}catch(p){const x=p instanceof Error?p.message:"Failed to delete profile";throw c(x),p}};return e.jsx(Cn.Provider,{value:{profiles:t,friendsProfiles:n,allProfiles:u,addProfile:k,updateProfile:y,deleteProfile:m,getProfile:E,loading:o,error:d},children:s})},As=({onClose:s})=>{const{profiles:t,friendsProfiles:r}=Ue(),n=je(),a=[{name:"Dashboard",icon:yn,href:"/"},{name:"Calendar",icon:le,href:"/calendar"},{name:"Connections",icon:wt,href:"/connections",subItems:[{name:"TeamSnap",href:"/connections/teamsnap"},{name:"Playmetrics",href:"/connections/playmetrics"}]},{name:"Profiles",icon:ve,href:"/profiles"},{name:"Friends",icon:ze,href:"/friends"},{name:"Settings",icon:La,href:"/settings"}],o=l=>{n(`/profiles/${l}`),s()};return e.jsxs("div",{className:"flex h-full flex-col overflow-y-auto bg-white dark:bg-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-5",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-600 flex items-center justify-center",children:e.jsx(le,{className:"h-5 w-5 text-white"})}),e.jsx("span",{className:"ml-2 text-xl font-bold text-gray-900 dark:text-white",children:"TeamSync"})]}),e.jsx("button",{type:"button",className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 lg:hidden",onClick:s,children:e.jsx(he,{className:"h-6 w-6"})})]}),e.jsx("div",{className:"mt-5 px-2 space-y-1",children:a.map(l=>e.jsxs("div",{children:[e.jsxs(Ps,{to:l.href,className:({isActive:d})=>`group flex items-center px-2 py-2 text-base font-medium rounded-md ${d?"bg-blue-50 dark:bg-blue-900/50 text-blue-600 dark:text-blue-400":"text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-white"}`,end:l.href==="/",children:[e.jsx(l.icon,{className:({isActive:d})=>`mr-4 h-6 w-6 flex-shrink-0 ${d?"text-blue-600 dark:text-blue-400":"text-gray-400 dark:text-gray-500 group-hover:text-gray-500 dark:group-hover:text-gray-300"}`}),l.name]}),l.subItems&&e.jsx("div",{className:"ml-8 mt-1 space-y-1",children:l.subItems.map(d=>e.jsx(Ps,{to:d.href,className:({isActive:c})=>`block px-3 py-2 text-sm font-medium rounded-md ${c?"bg-blue-50 dark:bg-blue-900/50 text-blue-600 dark:text-blue-400":"text-gray-500 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-white"}`,children:d.name},d.name))})]},l.name))}),t.length>0&&e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"px-3 text-sm font-medium text-gray-500 dark:text-gray-400",children:"Your Children"}),e.jsx("div",{className:"mt-1 space-y-1 px-3",children:t.map(l=>e.jsxs("button",{onClick:()=>o(l.id),className:"w-full group flex items-center rounded-md px-2 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-white transition-colors",children:[e.jsx("div",{className:"mr-3 h-6 w-6 rounded-full flex items-center justify-center text-white",style:{backgroundColor:l.color},children:l.photo_url?e.jsx("img",{src:l.photo_url,alt:l.name,className:"h-full w-full rounded-full object-cover"}):l.name.charAt(0)}),l.name]},l.id))})]}),r.length>0&&e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"px-3 text-sm font-medium text-gray-500 dark:text-gray-400",children:"Friends' Children"}),e.jsx("div",{className:"mt-1 space-y-1 px-3",children:r.map(l=>e.jsxs("button",{onClick:()=>o(l.id),className:"w-full group flex items-center rounded-md px-2 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-white transition-colors",children:[e.jsxs("div",{className:"mr-3 h-6 w-6 rounded-full flex items-center justify-center text-white relative",style:{backgroundColor:l.color},children:[l.photo_url?e.jsx("img",{src:l.photo_url,alt:l.name,className:"h-full w-full rounded-full object-cover"}):l.name.charAt(0),e.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-yellow-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs text-white",children:"👑"})})]}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"text-sm",children:l.name}),e.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:l.ownerName})]})]},l.id))})]})]})},Ln=i.createContext(void 0),Ta=()=>{const s=i.useContext(Ln);if(!s)throw new Error("useApp must be used within an AppProvider");return s},Aa=({children:s})=>{const[t]=i.useState({name:"John Smith",email:"john.smith@example.com"}),[r]=i.useState([{id:"1",name:"Emma",age:10,color:"#3B82F6",sports:[{name:"Soccer",color:"#10B981"},{name:"Swimming",color:"#3B82F6"}],eventCount:5},{id:"2",name:"Jack",age:8,color:"#EF4444",sports:[{name:"Baseball",color:"#F59E0B"},{name:"Basketball",color:"#EF4444"}],eventCount:3},{id:"3",name:"Sophia",age:12,color:"#8B5CF6",sports:[{name:"Volleyball",color:"#EC4899"},{name:"Tennis",color:"#8B5CF6"}],eventCount:4}]),[n]=i.useState([{id:1,name:"SportsEngine",icon:le,color:"#2563EB",connected:!0,hasIssue:!1},{id:2,name:"TeamSnap",icon:ve,color:"#7C3AED",connected:!0,hasIssue:!1},{id:3,name:"PlayMetrics",icon:is,color:"#10B981",connected:!1,hasIssue:!1},{id:4,name:"GameChanger",icon:wt,color:"#F97316",connected:!0,hasIssue:!0}]),a=()=>{const c=new Date,h=c.getFullYear(),f=c.getMonth(),u=[];return r.forEach(v=>{v.sports.forEach(N=>{for(let b=1;b<=28;b++)if(b%3===0||b%5===0){const S=b%3===0,E=new Date(h,f,b,16+b%4,0),k=new Date(E);k.setHours(k.getHours()+(S?2:1.5));const y=n[Math.floor(Math.random()*n.length)];u.push({id:u.length+1,title:`${N.name} ${S?"Game":"Practice"}`,description:S?`${v.name}'s ${N.name} game against ${["Tigers","Eagles","Warriors","Sharks"][b%4]}`:`Regular ${N.name} practice session`,startTime:E,endTime:k,location:S?`${["City Park","Memorial Field","Community Center","Sports Complex"][b%4]}`:"Training Center",sport:N.name,color:N.color,child:v,platform:y.name,platformColor:y.color,platformIcon:y.icon,isToday:E.getDate()===c.getDate()})}})}),u},[o]=i.useState(a()),l=o.filter(c=>c.startTime>=new Date).sort((c,h)=>c.startTime.getTime()-h.startTime.getTime()),d={user:t,children:r,platforms:n,connectedPlatforms:n.filter(c=>c.connected),events:o,upcomingEvents:l};return e.jsx(Ln.Provider,{value:d,children:s})},En=i.createContext(void 0),Sn=()=>{const s=i.useContext(En);if(!s)throw new Error("useTheme must be used within a ThemeProvider");return s},Ia=({children:s})=>{const[t,r]=i.useState(()=>localStorage.getItem("theme")||"light");i.useEffect(()=>{localStorage.setItem("theme",t),t==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[t]);const n=()=>{r(a=>a==="light"?"dark":"light")};return e.jsx(En.Provider,{value:{theme:t,toggleTheme:n},children:s})},Ra=({onClose:s,onOpenChat:t})=>{const[r,n]=i.useState([]),[a,o]=i.useState(!0),[l,d]=i.useState(null),c=i.useRef(null);i.useEffect(()=>(h(),c.current&&c.current.unsubscribe(),(async()=>{const{data:{user:g}}=await O.auth.getUser();g&&(console.log("Setting up notifications subscription for user:",g.id),c.current=O.channel(`notifications:user_id=eq.${g.id}`).on("postgres_changes",{event:"*",schema:"public",table:"notifications",filter:`user_id=eq.${g.id}`},p=>{if(console.log("Notification change received:",p),p.new&&p.new.type!=="message"){if(p.eventType==="INSERT"){const x=p.new;n(C=>[x,...C])}else if(p.eventType==="UPDATE"){const x=p.new;n(C=>C.map(L=>L.id===x.id?x:L))}}else if(p.eventType==="DELETE"){const x=p.old.id;n(C=>C.filter(L=>L.id!==x))}}).subscribe(p=>{console.log("Notifications subscription status:",p)}))})(),()=>{c.current&&c.current.unsubscribe()}),[]);const h=async()=>{try{const{data:{user:m},error:g}=await O.auth.getUser();if(g)throw g;if(!m)return;const{data:p,error:x}=await O.from("notifications").select("*").eq("user_id",m.id).neq("type","message").order("created_at",{ascending:!1});if(x)throw x;n(p||[])}catch(m){console.error("Error fetching notifications:",m),d("Failed to load notifications")}finally{o(!1)}},f=async m=>{m.read||await v(m.id)},u=async(m,g)=>{try{if(m.type!=="friend_request")return;const p=m.data.friend_request_id,{data:x,error:C}=await O.from("friend_requests").update({status:g==="accept"?"accepted":"declined"}).eq("id",p).select().single();if(C)throw C;if(g==="accept"){const{data:{user:L}}=await O.auth.getUser();if(!L)throw new Error("No authenticated user");const{error:_}=await O.from("friendships").insert([{user_id:L.id,friend_id:x.requester_id,role:"none"},{user_id:x.requester_id,friend_id:L.id,role:"none"}]);if(_)throw _}await b(m.id)}catch(p){console.error("Error handling friend request:",p),d("Failed to process friend request")}},v=async m=>{try{const{error:g}=await O.from("notifications").update({read:!0}).eq("id",m);if(g)throw g;n(p=>p.map(x=>x.id===m?{...x,read:!0}:x))}catch(g){console.error("Error marking notification as read:",g)}},N=async()=>{try{const{data:{user:m}}=await O.auth.getUser();if(!m)return;const{error:g}=await O.from("notifications").update({read:!0}).eq("user_id",m.id).eq("read",!1).neq("type","message");if(g)throw g;n(p=>p.map(x=>({...x,read:!0})))}catch(m){console.error("Error marking all notifications as read:",m)}},b=async m=>{try{const{error:g}=await O.from("notifications").delete().eq("id",m);if(g)throw g;n(p=>p.filter(x=>x.id!==m))}catch(g){console.error("Error deleting notification:",g)}},S=async()=>{try{const{data:{user:m}}=await O.auth.getUser();if(!m)return;const{error:g}=await O.from("notifications").delete().eq("user_id",m.id).neq("type","message");if(g)throw g;n([])}catch(m){console.error("Error clearing all notifications:",m)}},E=m=>{switch(m){case"friend_request":return e.jsx(ze,{className:"h-5 w-5 text-blue-500"});case"new_event":return e.jsx(le,{className:"h-5 w-5 text-green-500"});case"schedule_change":return e.jsx(Fe,{className:"h-5 w-5 text-orange-500"});default:return e.jsx(Zt,{className:"h-5 w-5 text-gray-500"})}},k=m=>{const g=new Date,p=new Date(m),x=Math.floor((g.getTime()-p.getTime())/(1e3*60));if(x<1)return"Just now";if(x<60)return`${x}m ago`;const C=Math.floor(x/60);return C<24?`${C}h ago`:`${Math.floor(C/24)}d ago`},y=r.filter(m=>!m.read).length;return e.jsxs("div",{className:"absolute right-0 mt-2 w-96 origin-top-right rounded-md bg-white dark:bg-gray-800 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-50",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Notifications"}),y>0&&e.jsxs("span",{className:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:[y," new"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[r.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:N,className:"text-sm text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300",title:"Mark all as read",children:e.jsx(va,{className:"h-4 w-4"})}),e.jsx("button",{onClick:S,className:"text-sm text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300",title:"Clear all",children:e.jsx(We,{className:"h-4 w-4"})})]}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300",children:e.jsx(he,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:a?e.jsx("div",{className:"px-4 py-6 text-center",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mx-auto"})}):l?e.jsx("div",{className:"px-4 py-6 text-center text-red-600 dark:text-red-400",children:l}):r.length>0?r.map(m=>e.jsx("div",{className:`px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-700 border-b border-gray-100 dark:border-gray-600 last:border-b-0 cursor-pointer ${m.read?"":"bg-blue-50 dark:bg-blue-900/20"}`,onClick:()=>f(m),children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0 pt-0.5",children:E(m.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:m.title}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1",children:m.message}),e.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:k(m.created_at)})]}),e.jsxs("div",{className:"flex items-center space-x-1 ml-2",children:[!m.read&&e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full",title:"Unread"}),e.jsx("button",{onClick:g=>{g.stopPropagation(),b(m.id)},className:"text-gray-400 hover:text-red-500 dark:text-gray-500 dark:hover:text-red-400",title:"Delete",children:e.jsx(he,{className:"h-4 w-4"})})]})]}),m.type==="friend_request"&&e.jsxs("div",{className:"flex space-x-2 mt-3",children:[e.jsx("button",{onClick:g=>{g.stopPropagation(),u(m,"accept")},className:"flex-1 px-3 py-1.5 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Accept"}),e.jsx("button",{onClick:g=>{g.stopPropagation(),u(m,"decline")},className:"flex-1 px-3 py-1.5 bg-gray-300 text-gray-700 text-sm rounded-md hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-500 dark:bg-gray-600 dark:text-gray-200 dark:hover:bg-gray-500",children:"Decline"})]})]})]})},m.id)):e.jsxs("div",{className:"px-4 py-8 text-center text-gray-500 dark:text-gray-400",children:[e.jsx(Zt,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No notifications"}),e.jsx("p",{className:"text-xs mt-1",children:"You're all caught up!"})]})})]})},Fa=({friend:s,onClose:t})=>{const[r,n]=i.useState([]),[a,o]=i.useState(""),[l,d]=i.useState(!0),[c,h]=i.useState(!1),[f,u]=i.useState(null),[v,N]=i.useState(null),[b,S]=i.useState(null),[E,k]=i.useState(!1),y=i.useRef(null),m=i.useRef(null),g=i.useRef(null),p=i.useRef(null),x=i.useRef(null),C={Smileys:["😀","😃","😄","😁","😆","😅","🤣","😂","🙂","🙃","😉","😊","😇","🥰","😍","🤩","😘","😗","😚","😙"],Emotions:["😋","😛","😜","🤪","😝","🤑","🤗","🤭","🤫","🤔","🤐","🤨","😐","😑","😶","😏","😒","🙄","😬","🤥"],Reactions:["😌","😔","😪","🤤","😴","😷","🤒","🤕","🤢","🤮","🤧","🥵","🥶","🥴","😵","🤯","🤠","🥳","😎","🤓"],Gestures:["👍","👎","👌","🤌","🤏","✌️","🤞","🤟","🤘","🤙","👈","👉","👆","🖕","👇","☝️","👋","🤚","🖐️","✋"],Hearts:["❤️","🧡","💛","💚","💙","💜","🖤","🤍","🤎","💔","❣️","💕","💞","💓","💗","💖","💘","💝","💟","♥️"],Objects:["🎉","🎊","🎈","🎁","🏆","🥇","🥈","🥉","⚽","🏀","🏈","⚾","🎾","🏐","🏉","🎱","🏓","🏸","🥅","⛳"]},L=(M="auto")=>{m.current&&(m.current.scrollTop=m.current.scrollHeight)},_=()=>{setTimeout(()=>{L("auto")},50)};i.useEffect(()=>{A(),setTimeout(()=>{var D;(D=g.current)==null||D.focus()},100);const M=D=>{p.current&&!p.current.contains(D.target)&&k(!1)};return document.addEventListener("mousedown",M),()=>{document.removeEventListener("mousedown",M),x.current&&x.current.unsubscribe()}},[s.friend_id]),i.useEffect(()=>{r.length>0&&_()},[r]),i.useEffect(()=>{!l&&r.length>0&&_()},[l]),i.useEffect(()=>{if(!(!f||!v))return x.current&&x.current.unsubscribe(),console.log("Setting up real-time subscription for conversation:",f.id),x.current=O.channel(`messages:conversation_id=eq.${f.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`conversation_id=eq.${f.id}`},async M=>{console.log("New message received via realtime:",M);const D=M.new,{data:F}=await O.from("user_settings").select("full_name, profile_photo_url").eq("user_id",D.sender_id).single(),$={...D,created_at:D.created_at,sender:F};n(B=>{if(B.some(U=>U.id===D.id))return console.log("Message already exists, skipping duplicate"),B;console.log("Adding new message to state");const w=[...B,$];return setTimeout(()=>_(),50),w}),D.sender_id!==v&&await Y(D.id)}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"messages",filter:`conversation_id=eq.${f.id}`},async M=>{console.log("Message updated via realtime:",M);const D=M.new,{data:F}=await O.from("user_settings").select("full_name, profile_photo_url").eq("user_id",D.sender_id).single(),$={...D,sender:F};n(B=>B.map(j=>j.id===D.id?$:j))}).subscribe(M=>{console.log("Chat subscription status:",M),M==="SUBSCRIBED"?console.log("Successfully subscribed to real-time messages for conversation:",f.id):M==="CHANNEL_ERROR"&&console.error("Error subscribing to real-time messages")}),()=>{x.current&&x.current.unsubscribe()}},[f,v]);const A=async()=>{try{const{data:{user:M},error:D}=await O.auth.getUser();if(D)throw D;if(!M)return;N(M.id);const{data:F}=await O.from("user_settings").select("full_name, profile_photo_url").eq("user_id",M.id).single();S(F);let $=await R(M.id,s.friend_id);u($),await q($.id),await T($.id,M.id)}catch(M){console.error("Error initializing chat:",M)}finally{d(!1)}},R=async(M,D)=>{const F=M<D?M:D,$=M<D?D:M,{data:B,error:j}=await O.from("conversations").select("*").eq("participant_1_id",F).eq("participant_2_id",$).maybeSingle();if(j)throw j;if(B)return B;try{const{data:w,error:U}=await O.from("conversations").insert({participant_1_id:F,participant_2_id:$}).select().single();if(U)throw U;return w}catch(w){if(w.code==="23505"){const{data:U,error:H}=await O.from("conversations").select("*").eq("participant_1_id",F).eq("participant_2_id",$).single();if(H)throw H;if(!U)throw new Error("Conversation not found after concurrent creation");return U}throw w}},q=async M=>{try{const{data:D,error:F}=await O.from("messages").select("*").eq("conversation_id",M).order("created_at",{ascending:!0});if(F)throw F;const $=await Promise.all((D||[]).map(async B=>{const{data:j}=await O.from("user_settings").select("full_name, profile_photo_url").eq("user_id",B.sender_id).single();return{...B,sender:j}}));n($)}catch(D){console.error("Error loading messages:",D)}},z=async()=>{if(!a.trim()||!f||!v||c)return;h(!0);const M=a.trim();o(""),k(!1);try{const{data:D,error:F}=await O.from("messages").insert({conversation_id:f.id,sender_id:v,content:M}).select().single();if(F)throw F;console.log("Message sent successfully:",D);const $={...D,sender:b};n(B=>{if(B.some(U=>U.id===D.id))return B;const w=[...B,$];return setTimeout(()=>_(),50),w})}catch(D){console.error("Error sending message:",D),o(M)}finally{h(!1)}},G=M=>{var D;o(F=>F+M),k(!1),(D=g.current)==null||D.focus()},Y=async M=>{try{await O.from("messages").update({read:!0}).eq("id",M)}catch(D){console.error("Error marking message as read:",D)}},T=async(M,D)=>{try{await O.from("messages").update({read:!0}).eq("conversation_id",M).neq("sender_id",D).eq("read",!1)}catch(F){console.error("Error marking conversation as read:",F)}},V=M=>{M.key==="Enter"&&!M.shiftKey&&(M.preventDefault(),z())},P=M=>{const D=new Date(M),$=(new Date().getTime()-D.getTime())/(1e3*60*60);return $<24?D.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):$<24*7?D.toLocaleDateString("en-US",{weekday:"short",hour:"numeric",minute:"2-digit",hour12:!0}):D.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl h-[600px] flex flex-col",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-300 dark:bg-gray-500 flex items-center justify-center",children:s.friend.profile_photo_url?e.jsx("img",{src:s.friend.profile_photo_url,alt:"",className:"w-10 h-10 rounded-full object-cover"}):e.jsx(cs,{className:"h-6 w-6 text-gray-600 dark:text-gray-300"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:s.friend.full_name||"Friend"}),e.jsxs("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:[e.jsx(Yt,{className:"h-4 w-4 mr-1"}),"Chat"]})]})]}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500 dark:text-gray-300 dark:hover:text-gray-200",children:e.jsx(he,{className:"h-6 w-6"})})]}),e.jsxs("div",{ref:m,className:"flex-1 overflow-y-auto p-4 space-y-4",style:{scrollBehavior:"smooth"},children:[l?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):r.length>0?r.map((M,D)=>{var B,j;const F=M.sender_id===v,$=!F&&(D===0||r[D-1].sender_id!==M.sender_id||new Date(M.created_at).getTime()-new Date(r[D-1].created_at).getTime()>5*60*1e3);return e.jsxs("div",{className:`flex ${F?"justify-end":"justify-start"} ${$?"mt-4":"mt-1"}`,children:[!F&&$&&e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-300 dark:bg-gray-500 flex items-center justify-center mr-2 flex-shrink-0",children:(B=M.sender)!=null&&B.profile_photo_url?e.jsx("img",{src:M.sender.profile_photo_url,alt:"",className:"w-8 h-8 rounded-full object-cover"}):e.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:(((j=M.sender)==null?void 0:j.full_name)||"F").charAt(0).toUpperCase()})}),!F&&!$&&e.jsx("div",{className:"w-8 mr-2 flex-shrink-0"}),e.jsxs("div",{className:`max-w-xs lg:max-w-md ${F?"order-1":"order-2"}`,children:[e.jsx("div",{className:`px-4 py-2 rounded-lg ${F?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-white"}`,children:e.jsx("p",{className:"text-sm whitespace-pre-wrap break-words",children:M.content})}),e.jsx("div",{className:`mt-1 text-xs text-gray-500 dark:text-gray-400 ${F?"text-right":"text-left"}`,children:P(M.created_at)})]})]},M.id)}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500 dark:text-gray-400",children:[e.jsx(Yt,{className:"h-12 w-12 mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium",children:"Start a conversation"}),e.jsxs("p",{className:"text-sm",children:["Send a message to ",s.friend.full_name||"your friend"]})]}),e.jsx("div",{ref:y})]}),E&&e.jsx("div",{ref:p,className:"border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700 max-h-64 overflow-y-auto",children:e.jsx("div",{className:"p-4",children:Object.entries(C).map(([M,D])=>e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:M}),e.jsx("div",{className:"grid grid-cols-10 gap-2",children:D.map((F,$)=>e.jsx("button",{onClick:()=>G(F),className:"text-xl hover:bg-gray-200 dark:hover:bg-gray-600 rounded p-1 transition-colors",title:F,children:F},$))})]},M))})}),e.jsx("div",{className:"px-4 py-4 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:()=>k(!E),className:`p-2 rounded-full transition-colors ${E?"bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-400":"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"}`,title:"Add emoticon",children:e.jsx(Sa,{className:"h-5 w-5"})}),e.jsx("input",{ref:g,type:"text",value:a,onChange:M=>o(M.target.value),onKeyPress:V,placeholder:"Type a message...",className:"flex-1 rounded-full border border-gray-300 dark:border-gray-600 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",disabled:c}),e.jsx("button",{onClick:z,disabled:!a.trim()||c,className:"bg-blue-600 text-white rounded-full p-2 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:c?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"}):e.jsx(jn,{className:"h-5 w-5"})})]})})]})})},Ua=({children:s})=>{const{user:t}=Ta(),{theme:r,toggleTheme:n}=Sn(),[a,o]=i.useState(!1),[l,d]=i.useState(!1),[c,h]=i.useState(!1),[f,u]=i.useState(0),[v,N]=i.useState([]),[b,S]=i.useState([]),[E,k]=i.useState(""),[y,m]=i.useState(!1),[g,p]=i.useState(null),x=je(),C=()=>o(!a),L=()=>d(!l),_=()=>{h(!c),!c&&v.length===0&&R(),c||k("")};i.useEffect(()=>{A(),(async()=>{const{data:{user:M}}=await O.auth.getUser();if(M){const D=O.channel(`header-notifications:user_id=eq.${M.id}`).on("postgres_changes",{event:"*",schema:"public",table:"notifications",filter:`user_id=eq.${M.id}`},()=>{A()}).subscribe();return()=>{D.unsubscribe()}}})()},[]),i.useEffect(()=>{(async()=>{const{data:{user:M}}=await O.auth.getUser();if(M){const D=O.channel(`header-messages:user_id=eq.${M.id}`).on("postgres_changes",{event:"*",schema:"public",table:"messages"},()=>{v.length>0&&R()}).subscribe();return()=>{D.unsubscribe()}}})()},[v.length]),i.useEffect(()=>{if(E.trim()){const P=E.toLowerCase(),D=v.filter(F=>(F.friend.full_name||"").toLowerCase().includes(P)).sort((F,$)=>{if((F.unreadCount||0)!==($.unreadCount||0))return($.unreadCount||0)-(F.unreadCount||0);if(F.lastMessageAt&&$.lastMessageAt)return new Date($.lastMessageAt).getTime()-new Date(F.lastMessageAt).getTime();const B=F.friend.full_name||"No name set",j=$.friend.full_name||"No name set";return B.localeCompare(j)});S(D)}else{const P=[...v].sort((M,D)=>{if((M.unreadCount||0)!==(D.unreadCount||0))return(D.unreadCount||0)-(M.unreadCount||0);if(M.lastMessageAt&&D.lastMessageAt)return new Date(D.lastMessageAt).getTime()-new Date(M.lastMessageAt).getTime();const F=M.friend.full_name||"No name set",$=D.friend.full_name||"No name set";return F.localeCompare($)});S(P)}},[v,E]);const A=async()=>{try{const{data:{user:P},error:M}=await O.auth.getUser();if(M||!P)return;const{count:D,error:F}=await O.from("notifications").select("*",{count:"exact",head:!0}).eq("user_id",P.id).eq("read",!1).neq("type","message");F||u(D||0)}catch(P){console.error("Error fetching notification count:",P)}},R=async()=>{try{m(!0);const{data:{user:P}}=await O.auth.getUser();if(!P)return;const{data:M,error:D}=await O.from("friendships").select("id, friend_id, role, created_at").eq("user_id",P.id);if(D)throw D;const F=(M==null?void 0:M.map(j=>j.friend_id))||[];let $=[];if(F.length>0){const{data:j,error:w}=await O.from("user_settings").select("user_id, full_name, profile_photo_url").in("user_id",F);if(w)throw w;$=F.map(U=>{const H=j==null?void 0:j.find(W=>W.user_id===U);return{id:U,full_name:(H==null?void 0:H.full_name)||"No name set",profile_photo_url:H==null?void 0:H.profile_photo_url}})}const B=await Promise.all((M||[]).map(async j=>{const w=$.find(X=>X.id===j.friend_id)||{id:j.friend_id,full_name:"No name set",profile_photo_url:void 0},{data:U}=await O.from("conversations").select("id, last_message_at").or(`and(participant_1_id.eq.${P.id},participant_2_id.eq.${j.friend_id}),and(participant_1_id.eq.${j.friend_id},participant_2_id.eq.${P.id})`).maybeSingle();let H=0,W=null;if(U){const{count:X}=await O.from("messages").select("*",{count:"exact",head:!0}).eq("conversation_id",U.id).eq("sender_id",j.friend_id).eq("read",!1);H=X||0,W=U.last_message_at}return{...j,friend:w,unreadCount:H,lastMessageAt:W}}));N(B)}catch(P){console.error("Error fetching friends:",P)}finally{m(!1)}},q=async()=>{await O.auth.signOut(),x("/auth/signin")},z=P=>{p(P),h(!1),k("")},G=()=>{h(!1),x("/friends")},Y=(P,M)=>{p(M),o(!1)},T=P=>P==="administrator"?"👑":P==="viewer"?"👁️":"💬",V=P=>P==="administrator"?"Admin":P==="viewer"?"Viewer":"Friend";return e.jsxs(e.Fragment,{children:[e.jsx("header",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 z-10",children:e.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex h-16 items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[s,e.jsx("div",{className:"ml-4 md:ml-6",children:e.jsx("h1",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"TeamSync"})})]}),e.jsx("div",{className:"hidden md:block",children:e.jsxs("div",{className:"relative mx-4 w-64",children:[e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:e.jsx(tt,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",placeholder:"Search events...",className:"block w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 py-2 pl-10 pr-3 text-sm placeholder-gray-500 dark:placeholder-gray-400 text-gray-900 dark:text-white focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500"})]})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:n,className:"relative rounded-full p-1 text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:r==="dark"?e.jsx(Jt,{className:"h-6 w-6"}):e.jsx(wn,{className:"h-6 w-6"})}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",className:"relative rounded-full bg-white dark:bg-gray-700 p-1 text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:C,children:[e.jsx("span",{className:"sr-only",children:"View notifications"}),e.jsx(Zt,{className:"h-6 w-6"}),f>0&&e.jsx("span",{className:"absolute -top-1 -right-1 flex h-5 w-5 items-center justify-center rounded-full bg-red-500 text-xs text-white font-medium",children:f>99?"99+":f})]}),a&&e.jsx(Ra,{onClose:()=>o(!1),onOpenChat:Y})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",className:"relative rounded-full bg-white dark:bg-gray-700 p-1 text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:_,children:[e.jsx("span",{className:"sr-only",children:"View friends"}),e.jsx(ve,{className:"h-6 w-6"}),v.some(P=>(P.unreadCount||0)>0)&&e.jsx("span",{className:"absolute -top-1 -right-1 flex h-5 w-5 items-center justify-center rounded-full bg-blue-500 text-xs text-white font-medium",children:v.reduce((P,M)=>P+(M.unreadCount||0),0)})]}),c&&e.jsxs("div",{className:"absolute right-0 mt-2 w-80 origin-top-right rounded-md bg-white dark:bg-gray-800 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-900 dark:text-white",children:["Friends (",v.length,")"]}),e.jsx("button",{onClick:G,className:"text-sm text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300",children:"Manage"})]}),v.length>0&&e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:e.jsx(tt,{className:"h-4 w-4 text-gray-400"})}),e.jsx("input",{type:"text",value:E,onChange:P=>k(P.target.value),placeholder:"Search friends...",className:"block w-full pl-9 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm placeholder-gray-500 dark:placeholder-gray-400 text-gray-900 dark:text-white bg-white dark:bg-gray-700 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsx("div",{className:"max-h-64 overflow-y-auto",children:y?e.jsx("div",{className:"px-4 py-6 text-center",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mx-auto"})}):b.length>0?e.jsxs(e.Fragment,{children:[E&&b.length!==v.length&&e.jsxs("div",{className:"px-4 py-2 text-xs text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-gray-700",children:[b.length," of ",v.length," friends"]}),b.map(P=>e.jsx("button",{onClick:()=>z(P),className:"w-full px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-700 border-b border-gray-100 dark:border-gray-600 last:border-b-0 text-left",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"w-8 h-8 rounded-full bg-gray-300 dark:bg-gray-500 flex items-center justify-center mr-3 relative",children:[P.friend.profile_photo_url?e.jsx("img",{src:P.friend.profile_photo_url,alt:"",className:"w-8 h-8 rounded-full object-cover"}):e.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:(P.friend.full_name||"U").charAt(0).toUpperCase()}),(P.unreadCount||0)>0&&e.jsx("span",{className:"absolute -top-1 -right-1 flex h-4 w-4 items-center justify-center rounded-full bg-red-500 text-xs text-white font-medium",children:P.unreadCount>9?"9+":P.unreadCount})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:`text-sm font-medium truncate ${(P.unreadCount||0)>0?"font-bold text-gray-900 dark:text-white":"text-gray-900 dark:text-white"}`,children:P.friend.full_name||"No name set"}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-center",children:[e.jsx("span",{className:"mr-1",children:T(P.role)}),V(P.role),(P.unreadCount||0)>0&&e.jsxs("span",{className:"ml-2 text-blue-600 dark:text-blue-400 font-medium",children:[P.unreadCount," new message",P.unreadCount>1?"s":""]})]})]})]})},P.id))]}):v.length>0?e.jsxs("div",{className:"px-4 py-6 text-center text-gray-500 dark:text-gray-400",children:[e.jsx(tt,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No friends found"}),e.jsx("p",{className:"text-xs",children:"Try a different search term"})]}):e.jsxs("div",{className:"px-4 py-6 text-center text-gray-500 dark:text-gray-400",children:[e.jsx(ve,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No friends added yet"}),e.jsx("button",{onClick:G,className:"mt-2 text-sm text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300",children:"Add friends"})]})})]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",className:"flex rounded-full bg-white dark:bg-gray-700 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:L,children:[e.jsx("span",{className:"sr-only",children:"Open user menu"}),e.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-500 flex items-center justify-center text-white",children:e.jsx(cs,{className:"h-5 w-5"})})]}),l&&e.jsxs("div",{className:"absolute right-0 mt-2 w-48 origin-top-right rounded-md bg-white dark:bg-gray-700 py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",children:[e.jsx("a",{href:"/settings",className:"block px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-600",children:"Settings"}),e.jsx("button",{onClick:q,className:"block w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-600",children:"Sign out"})]})]})]})]})})}),g&&e.jsx(Fa,{friend:g,onClose:()=>p(null)})]})},Ba=()=>{const[s,t]=i.useState(!1),r=()=>t(!s);return e.jsxs("div",{className:"flex h-screen w-full overflow-hidden bg-gray-50 dark:bg-gray-900",children:[e.jsxs("div",{className:`fixed inset-0 z-40 lg:hidden ${s?"block":"hidden"}`,children:[e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 transition-opacity dark:bg-gray-900 dark:bg-opacity-75",onClick:r}),e.jsx("div",{className:"fixed inset-y-0 left-0 flex w-full max-w-xs flex-col bg-white dark:bg-gray-800 shadow-xl",children:e.jsx(As,{onClose:r})})]}),e.jsx("div",{className:"hidden lg:flex lg:w-64 lg:flex-shrink-0",children:e.jsx("div",{className:"flex h-full flex-col border-r border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",children:e.jsx(As,{onClose:()=>{}})})}),e.jsxs("div",{className:"flex flex-1 flex-col w-full overflow-hidden",children:[e.jsx(Ua,{children:e.jsx("button",{type:"button",className:"text-gray-500 dark:text-gray-400 focus:outline-none lg:hidden",onClick:r,children:e.jsx(Na,{size:24})})}),e.jsx("main",{className:"flex-1 overflow-auto bg-gray-50 dark:bg-gray-900 p-4 md:p-6",children:e.jsx("div",{className:"container mx-auto max-w-7xl",children:e.jsx(ra,{})})})]})]})};function nt(s){"@babel/helpers - typeof";return nt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nt(s)}function $a(s,t){if(nt(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(nt(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}function qa(s){var t=$a(s,"string");return nt(t)=="symbol"?t:t+""}function I(s,t,r){return(t=qa(t))in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function _n(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var $t,Is;function za(){if(Is)return $t;Is=1;var s=function(r,n,a,o,l,d,c,h){if(!r){var f;if(n===void 0)f=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[a,o,l,d,c,h],v=0;f=new Error(n.replace(/%s/g,function(){return u[v++]})),f.name="Invariant Violation"}throw f.framesToPop=1,f}};return $t=s,$t}var Ha=za(),pe=_n(Ha),se=i.createContext(null);function Va(){pe(!!i.useContext,"useGoogleMap is React hook and requires React version 16.8+");var s=i.useContext(se);return pe(!!s,"useGoogleMap needs a GoogleMap available up in the tree"),s}function Wa(s,t,r){return Object.keys(s).reduce(function(a,o){return t(a,s[o],o)},r)}function Ga(s,t){Object.keys(s).forEach(r=>t(s[r],r))}function Za(s,t,r,n){var a={},o=(l,d)=>{var c=r[d];c!==t[d]&&(a[d]=c,l(n,c))};return Ga(s,o),a}function Ka(s,t,r){var n=Wa(r,function(o,l,d){return typeof s[d]=="function"&&o.push(google.maps.event.addListener(t,l,s[d])),o},[]);return n}function Ya(s){google.maps.event.removeListener(s)}function ae(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];s.forEach(Ya)}function re(s){var{updaterMap:t,eventMap:r,prevProps:n,nextProps:a,instance:o}=s,l=Ka(a,o,r);return Za(t,n,a,o),l}var Rs={onDblClick:"dblclick",onDragEnd:"dragend",onDragStart:"dragstart",onMapTypeIdChanged:"maptypeid_changed",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseDown:"mousedown",onMouseUp:"mouseup",onRightClick:"rightclick",onTilesLoaded:"tilesloaded",onBoundsChanged:"bounds_changed",onCenterChanged:"center_changed",onClick:"click",onDrag:"drag",onHeadingChanged:"heading_changed",onIdle:"idle",onProjectionChanged:"projection_changed",onResize:"resize",onTiltChanged:"tilt_changed",onZoomChanged:"zoom_changed"},Fs={extraMapTypes(s,t){t.forEach(function(n,a){s.mapTypes.set(String(a),n)})},center(s,t){s.setCenter(t)},clickableIcons(s,t){s.setClickableIcons(t)},heading(s,t){s.setHeading(t)},mapTypeId(s,t){s.setMapTypeId(t)},options(s,t){s.setOptions(t)},streetView(s,t){s.setStreetView(t)},tilt(s,t){s.setTilt(t)},zoom(s,t){s.setZoom(t)}};function Ja(s){var{children:t,options:r,id:n,mapContainerStyle:a,mapContainerClassName:o,center:l,onClick:d,onDblClick:c,onDrag:h,onDragEnd:f,onDragStart:u,onMouseMove:v,onMouseOut:N,onMouseOver:b,onMouseDown:S,onMouseUp:E,onRightClick:k,onCenterChanged:y,onLoad:m,onUnmount:g}=s,[p,x]=i.useState(null),C=i.useRef(null),[L,_]=i.useState(null),[A,R]=i.useState(null),[q,z]=i.useState(null),[G,Y]=i.useState(null),[T,V]=i.useState(null),[P,M]=i.useState(null),[D,F]=i.useState(null),[$,B]=i.useState(null),[j,w]=i.useState(null),[U,H]=i.useState(null),[W,X]=i.useState(null),[J,ee]=i.useState(null);return i.useEffect(()=>{r&&p!==null&&p.setOptions(r)},[p,r]),i.useEffect(()=>{p!==null&&typeof l<"u"&&p.setCenter(l)},[p,l]),i.useEffect(()=>{p&&c&&(A!==null&&google.maps.event.removeListener(A),R(google.maps.event.addListener(p,"dblclick",c)))},[c]),i.useEffect(()=>{p&&f&&(q!==null&&google.maps.event.removeListener(q),z(google.maps.event.addListener(p,"dragend",f)))},[f]),i.useEffect(()=>{p&&u&&(G!==null&&google.maps.event.removeListener(G),Y(google.maps.event.addListener(p,"dragstart",u)))},[u]),i.useEffect(()=>{p&&S&&(T!==null&&google.maps.event.removeListener(T),V(google.maps.event.addListener(p,"mousedown",S)))},[S]),i.useEffect(()=>{p&&v&&(P!==null&&google.maps.event.removeListener(P),M(google.maps.event.addListener(p,"mousemove",v)))},[v]),i.useEffect(()=>{p&&N&&(D!==null&&google.maps.event.removeListener(D),F(google.maps.event.addListener(p,"mouseout",N)))},[N]),i.useEffect(()=>{p&&b&&($!==null&&google.maps.event.removeListener($),B(google.maps.event.addListener(p,"mouseover",b)))},[b]),i.useEffect(()=>{p&&E&&(j!==null&&google.maps.event.removeListener(j),w(google.maps.event.addListener(p,"mouseup",E)))},[E]),i.useEffect(()=>{p&&k&&(U!==null&&google.maps.event.removeListener(U),H(google.maps.event.addListener(p,"rightclick",k)))},[k]),i.useEffect(()=>{p&&d&&(W!==null&&google.maps.event.removeListener(W),X(google.maps.event.addListener(p,"click",d)))},[d]),i.useEffect(()=>{p&&h&&(J!==null&&google.maps.event.removeListener(J),ee(google.maps.event.addListener(p,"drag",h)))},[h]),i.useEffect(()=>{p&&y&&(L!==null&&google.maps.event.removeListener(L),_(google.maps.event.addListener(p,"center_changed",y)))},[d]),i.useEffect(()=>{var ne=C.current===null?null:new google.maps.Map(C.current,r);return x(ne),ne!==null&&m&&m(ne),()=>{ne!==null&&g&&g(ne)}},[]),e.jsx("div",{id:n,ref:C,style:a,className:o,children:e.jsx(se.Provider,{value:p,children:p!==null?t:null})})}i.memo(Ja);class Qa extends i.PureComponent{constructor(){super(...arguments),I(this,"state",{map:null}),I(this,"registeredEvents",[]),I(this,"mapRef",null),I(this,"getInstance",()=>this.mapRef===null?null:new google.maps.Map(this.mapRef,this.props.options)),I(this,"panTo",t=>{var r=this.getInstance();r&&r.panTo(t)}),I(this,"setMapCallback",()=>{this.state.map!==null&&this.props.onLoad&&this.props.onLoad(this.state.map)}),I(this,"getRef",t=>{this.mapRef=t})}componentDidMount(){var t=this.getInstance();this.registeredEvents=re({updaterMap:Fs,eventMap:Rs,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{map:t}},this.setMapCallback)}componentDidUpdate(t){this.state.map!==null&&(ae(this.registeredEvents),this.registeredEvents=re({updaterMap:Fs,eventMap:Rs,prevProps:t,nextProps:this.props,instance:this.state.map}))}componentWillUnmount(){this.state.map!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.map),ae(this.registeredEvents))}render(){return e.jsx("div",{id:this.props.id,ref:this.getRef,style:this.props.mapContainerStyle,className:this.props.mapContainerClassName,children:e.jsx(se.Provider,{value:this.state.map,children:this.state.map!==null?this.props.children:null})})}}function Us(s,t,r,n,a,o,l){try{var d=s[o](l),c=d.value}catch(h){return void r(h)}d.done?t(c):Promise.resolve(c).then(n,a)}function Mn(s){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=s.apply(t,r);function l(c){Us(o,n,a,l,d,"next",c)}function d(c){Us(o,n,a,l,d,"throw",c)}l(void 0)})}}function Pn(s){var{googleMapsApiKey:t,googleMapsClientId:r,version:n="weekly",language:a,region:o,libraries:l,channel:d,mapIds:c,authReferrerPolicy:h}=s,f=[];return pe(t&&r||!(t&&r),"You need to specify either googleMapsApiKey or googleMapsClientId for @react-google-maps/api load script to work. You cannot use both at the same time."),t?f.push("key=".concat(t)):r&&f.push("client=".concat(r)),n&&f.push("v=".concat(n)),a&&f.push("language=".concat(a)),o&&f.push("region=".concat(o)),l&&l.length&&f.push("libraries=".concat(l.sort().join(","))),d&&f.push("channel=".concat(d)),c&&c.length&&f.push("map_ids=".concat(c.join(","))),h&&f.push("auth_referrer_policy=".concat(h)),f.push("loading=async"),f.push("callback=initMap"),"https://maps.googleapis.com/maps/api/js?".concat(f.join("&"))}var Ie=typeof document<"u";function On(s){var{url:t,id:r,nonce:n}=s;return Ie?new Promise(function(o,l){var d=document.getElementById(r),c=window;if(d){var h=d.getAttribute("data-state");if(d.src===t&&h!=="error"){if(h==="ready")return o(r);var f=c.initMap,u=d.onerror;c.initMap=function(){f&&f(),o(r)},d.onerror=function(N){u&&u(N),l(N)};return}else d.remove()}var v=document.createElement("script");v.type="text/javascript",v.src=t,v.id=r,v.async=!0,v.nonce=n||"",v.onerror=function(b){v.setAttribute("data-state","error"),l(b)},c.initMap=function(){v.setAttribute("data-state","ready"),o(r)},document.head.appendChild(v)}).catch(a=>{throw console.error("injectScript error: ",a),a}):Promise.reject(new Error("document is undefined"))}function Bs(s){var t=s.href;return t&&(t.indexOf("https://fonts.googleapis.com/css?family=Roboto")===0||t.indexOf("https://fonts.googleapis.com/css?family=Google+Sans+Text")===0)?!0:s.tagName.toLowerCase()==="style"&&s.styleSheet&&s.styleSheet.cssText&&s.styleSheet.cssText.replace(`\r
`,"").indexOf(".gm-style")===0?(s.styleSheet.cssText="",!0):s.tagName.toLowerCase()==="style"&&s.innerHTML&&s.innerHTML.replace(`\r
`,"").indexOf(".gm-style")===0?(s.innerHTML="",!0):s.tagName.toLowerCase()==="style"&&!s.styleSheet&&!s.innerHTML}function Dn(){var s=document.getElementsByTagName("head")[0];if(s){var t=s.insertBefore.bind(s);s.insertBefore=function(a,o){return Bs(a)||Reflect.apply(t,s,[a,o]),a};var r=s.appendChild.bind(s);s.appendChild=function(a){return Bs(a)||Reflect.apply(r,s,[a]),a}}}var Je=!1;function Tn(){return e.jsx("div",{children:"Loading..."})}var Qt={id:"script-loader",version:"weekly"};class Xa extends i.PureComponent{constructor(){super(...arguments),I(this,"check",null),I(this,"state",{loaded:!1}),I(this,"cleanupCallback",()=>{delete window.google.maps,this.injectScript()}),I(this,"isCleaningUp",Mn(function*(){function t(r){if(!Je)r();else if(Ie)var n=window.setInterval(function(){Je||(window.clearInterval(n),r())},1)}return new Promise(t)})),I(this,"cleanup",()=>{Je=!0;var t=document.getElementById(this.props.id);t&&t.parentNode&&t.parentNode.removeChild(t),Array.prototype.slice.call(document.getElementsByTagName("script")).filter(function(n){return typeof n.src=="string"&&n.src.includes("maps.googleapis")}).forEach(function(n){n.parentNode&&n.parentNode.removeChild(n)}),Array.prototype.slice.call(document.getElementsByTagName("link")).filter(function(n){return n.href==="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Google+Sans"}).forEach(function(n){n.parentNode&&n.parentNode.removeChild(n)}),Array.prototype.slice.call(document.getElementsByTagName("style")).filter(function(n){return n.innerText!==void 0&&n.innerText.length>0&&n.innerText.includes(".gm-")}).forEach(function(n){n.parentNode&&n.parentNode.removeChild(n)})}),I(this,"injectScript",()=>{this.props.preventGoogleFontsLoading&&Dn(),pe(!!this.props.id,'LoadScript requires "id" prop to be a string: %s',this.props.id);var t={id:this.props.id,nonce:this.props.nonce,url:Pn(this.props)};On(t).then(()=>{this.props.onLoad&&this.props.onLoad(),this.setState(function(){return{loaded:!0}})}).catch(r=>{this.props.onError&&this.props.onError(r),console.error(`
          There has been an Error with loading Google Maps API script, please check that you provided correct google API key (`.concat(this.props.googleMapsApiKey||"-",") or Client ID (").concat(this.props.googleMapsClientId||"-",`) to <LoadScript />
          Otherwise it is a Network issue.
        `))})}),I(this,"getRef",t=>{this.check=t})}componentDidMount(){if(Ie){if(window.google&&window.google.maps&&!Je){console.error("google api is already presented");return}this.isCleaningUp().then(this.injectScript).catch(function(r){console.error("Error at injecting script after cleaning up: ",r)})}}componentDidUpdate(t){this.props.libraries!==t.libraries&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),Ie&&t.language!==this.props.language&&(this.cleanup(),this.setState(function(){return{loaded:!1}},this.cleanupCallback))}componentWillUnmount(){if(Ie){this.cleanup();var t=()=>{this.check||(delete window.google,Je=!1)};window.setTimeout(t,1),this.props.onUnmount&&this.props.onUnmount()}}render(){return e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:this.getRef}),this.state.loaded?this.props.children:this.props.loadingElement||e.jsx(Tn,{})]})}}I(Xa,"defaultProps",Qt);function ei(s,t){if(s==null)return{};var r={};for(var n in s)if({}.hasOwnProperty.call(s,n)){if(t.includes(n))continue;r[n]=s[n]}return r}function ds(s,t){if(s==null)return{};var r,n,a=ei(s,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(s);for(n=0;n<o.length;n++)r=o[n],t.includes(r)||{}.propertyIsEnumerable.call(s,r)&&(a[r]=s[r])}return a}var $s;function us(s){var{id:t=Qt.id,version:r=Qt.version,nonce:n,googleMapsApiKey:a,googleMapsClientId:o,language:l,region:d,libraries:c,preventGoogleFontsLoading:h,channel:f,mapIds:u,authReferrerPolicy:v}=s,N=i.useRef(!1),[b,S]=i.useState(!1),[E,k]=i.useState(void 0);i.useEffect(function(){return N.current=!0,()=>{N.current=!1}},[]),i.useEffect(function(){Ie&&h&&Dn()},[h]),i.useEffect(function(){b&&pe(!!window.google,"useLoadScript was marked as loaded, but window.google is not present. Something went wrong.")},[b]);var y=Pn({version:r,googleMapsApiKey:a,googleMapsClientId:o,language:l,region:d,libraries:c,channel:f,mapIds:u,authReferrerPolicy:v});i.useEffect(function(){if(!Ie)return;function p(){N.current&&(S(!0),$s=y)}if(window.google&&window.google.maps&&$s===y){p();return}On({id:t,url:y,nonce:n}).then(p).catch(function(C){N.current&&k(C),console.warn(`
        There has been an Error with loading Google Maps API script, please check that you provided correct google API key (`.concat(a||"-",") or Client ID (").concat(o||"-",`)
        Otherwise it is a Network issue.
      `)),console.error(C)})},[t,y,n]);var m=i.useRef(void 0);return i.useEffect(function(){m.current&&c!==m.current&&console.warn("Performance warning! LoadScript has been reloaded unintentionally! You should not pass `libraries` prop as new array. Please keep an array of libraries as static class property for Components and PureComponents, or just a const variable outside of component, or somewhere in config files or ENV variables"),m.current=c},[c]),{isLoaded:b,loadError:E,url:y}}var ti=["loadingElement","onLoad","onError","onUnmount","children"],si=e.jsx(Tn,{});function ri(s){var{loadingElement:t,onLoad:r,onError:n,onUnmount:a,children:o}=s,l=ds(s,ti),{isLoaded:d,loadError:c}=us(l);return i.useEffect(function(){d&&typeof r=="function"&&r()},[d,r]),i.useEffect(function(){c&&typeof n=="function"&&n(c)},[c,n]),i.useEffect(function(){return()=>{a&&a()}},[a]),d?o:t||si}i.memo(ri);var qs;(function(s){s[s.INITIALIZED=0]="INITIALIZED",s[s.LOADING=1]="LOADING",s[s.SUCCESS=2]="SUCCESS",s[s.FAILURE=3]="FAILURE"})(qs||(qs={}));function zs(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function Nt(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zs(Object(r),!0).forEach(function(n){I(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):zs(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}var Hs={},Vs={options(s,t){s.setOptions(t)}};function ni(s){var{options:t,onLoad:r,onUnmount:n}=s,a=i.useContext(se),[o,l]=i.useState(null);return i.useEffect(()=>{o!==null&&o.setMap(a)},[a]),i.useEffect(()=>{t&&o!==null&&o.setOptions(t)},[o,t]),i.useEffect(()=>{var d=new google.maps.TrafficLayer(Nt(Nt({},t),{},{map:a}));return l(d),r&&r(d),()=>{o!==null&&(n&&n(o),o.setMap(null))}},[]),null}i.memo(ni);class ai extends i.PureComponent{constructor(){super(...arguments),I(this,"state",{trafficLayer:null}),I(this,"setTrafficLayerCallback",()=>{this.state.trafficLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.trafficLayer)}),I(this,"registeredEvents",[])}componentDidMount(){var t=new google.maps.TrafficLayer(Nt(Nt({},this.props.options),{},{map:this.context}));this.registeredEvents=re({updaterMap:Vs,eventMap:Hs,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{trafficLayer:t}},this.setTrafficLayerCallback)}componentDidUpdate(t){this.state.trafficLayer!==null&&(ae(this.registeredEvents),this.registeredEvents=re({updaterMap:Vs,eventMap:Hs,prevProps:t,nextProps:this.props,instance:this.state.trafficLayer}))}componentWillUnmount(){this.state.trafficLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.trafficLayer),ae(this.registeredEvents),this.state.trafficLayer.setMap(null))}render(){return null}}I(ai,"contextType",se);function ii(s){var{onLoad:t,onUnmount:r}=s,n=i.useContext(se),[a,o]=i.useState(null);return i.useEffect(()=>{a!==null&&a.setMap(n)},[n]),i.useEffect(()=>{var l=new google.maps.BicyclingLayer;return o(l),l.setMap(n),t&&t(l),()=>{l!==null&&(r&&r(l),l.setMap(null))}},[]),null}i.memo(ii);class oi extends i.PureComponent{constructor(){super(...arguments),I(this,"state",{bicyclingLayer:null}),I(this,"setBicyclingLayerCallback",()=>{this.state.bicyclingLayer!==null&&(this.state.bicyclingLayer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.bicyclingLayer))})}componentDidMount(){var t=new google.maps.BicyclingLayer;this.setState(()=>({bicyclingLayer:t}),this.setBicyclingLayerCallback)}componentWillUnmount(){this.state.bicyclingLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.bicyclingLayer),this.state.bicyclingLayer.setMap(null))}render(){return null}}I(oi,"contextType",se);function li(s){var{onLoad:t,onUnmount:r}=s,n=i.useContext(se),[a,o]=i.useState(null);return i.useEffect(()=>{a!==null&&a.setMap(n)},[n]),i.useEffect(()=>{var l=new google.maps.TransitLayer;return o(l),l.setMap(n),t&&t(l),()=>{a!==null&&(r&&r(a),a.setMap(null))}},[]),null}i.memo(li);class ci extends i.PureComponent{constructor(){super(...arguments),I(this,"state",{transitLayer:null}),I(this,"setTransitLayerCallback",()=>{this.state.transitLayer!==null&&(this.state.transitLayer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.transitLayer))})}componentDidMount(){var t=new google.maps.TransitLayer;this.setState(function(){return{transitLayer:t}},this.setTransitLayerCallback)}componentWillUnmount(){this.state.transitLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.transitLayer),this.state.transitLayer.setMap(null))}render(){return null}}I(ci,"contextType",se);function Ws(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function kt(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ws(Object(r),!0).forEach(function(n){I(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):Ws(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}var Gs={onCircleComplete:"circlecomplete",onMarkerComplete:"markercomplete",onOverlayComplete:"overlaycomplete",onPolygonComplete:"polygoncomplete",onPolylineComplete:"polylinecomplete",onRectangleComplete:"rectanglecomplete"},Zs={drawingMode(s,t){s.setDrawingMode(t)},options(s,t){s.setOptions(t)}};function di(s){var{options:t,drawingMode:r,onCircleComplete:n,onMarkerComplete:a,onOverlayComplete:o,onPolygonComplete:l,onPolylineComplete:d,onRectangleComplete:c,onLoad:h,onUnmount:f}=s,u=i.useContext(se),[v,N]=i.useState(null),[b,S]=i.useState(null),[E,k]=i.useState(null),[y,m]=i.useState(null),[g,p]=i.useState(null),[x,C]=i.useState(null),[L,_]=i.useState(null);return i.useEffect(()=>{v!==null&&v.setMap(u)},[u]),i.useEffect(()=>{t&&v!==null&&v.setOptions(t)},[v,t]),i.useEffect(()=>{v!==null&&v.setDrawingMode(r??null)},[v,r]),i.useEffect(()=>{v&&n&&(b!==null&&google.maps.event.removeListener(b),S(google.maps.event.addListener(v,"circlecomplete",n)))},[v,n]),i.useEffect(()=>{v&&a&&(E!==null&&google.maps.event.removeListener(E),k(google.maps.event.addListener(v,"markercomplete",a)))},[v,a]),i.useEffect(()=>{v&&o&&(y!==null&&google.maps.event.removeListener(y),m(google.maps.event.addListener(v,"overlaycomplete",o)))},[v,o]),i.useEffect(()=>{v&&l&&(g!==null&&google.maps.event.removeListener(g),p(google.maps.event.addListener(v,"polygoncomplete",l)))},[v,l]),i.useEffect(()=>{v&&d&&(x!==null&&google.maps.event.removeListener(x),C(google.maps.event.addListener(v,"polylinecomplete",d)))},[v,d]),i.useEffect(()=>{v&&c&&(L!==null&&google.maps.event.removeListener(L),_(google.maps.event.addListener(v,"rectanglecomplete",c)))},[v,c]),i.useEffect(()=>{pe(!!google.maps.drawing,"Did you include prop libraries={['drawing']} in the URL? %s",google.maps.drawing);var A=new google.maps.drawing.DrawingManager(kt(kt({},t),{},{map:u}));return r&&A.setDrawingMode(r),n&&S(google.maps.event.addListener(A,"circlecomplete",n)),a&&k(google.maps.event.addListener(A,"markercomplete",a)),o&&m(google.maps.event.addListener(A,"overlaycomplete",o)),l&&p(google.maps.event.addListener(A,"polygoncomplete",l)),d&&C(google.maps.event.addListener(A,"polylinecomplete",d)),c&&_(google.maps.event.addListener(A,"rectanglecomplete",c)),N(A),h&&h(A),()=>{v!==null&&(b&&google.maps.event.removeListener(b),E&&google.maps.event.removeListener(E),y&&google.maps.event.removeListener(y),g&&google.maps.event.removeListener(g),x&&google.maps.event.removeListener(x),L&&google.maps.event.removeListener(L),f&&f(v),v.setMap(null))}},[]),null}i.memo(di);class ui extends i.PureComponent{constructor(t){super(t),I(this,"registeredEvents",[]),I(this,"state",{drawingManager:null}),I(this,"setDrawingManagerCallback",()=>{this.state.drawingManager!==null&&this.props.onLoad&&this.props.onLoad(this.state.drawingManager)}),pe(!!google.maps.drawing,"Did you include prop libraries={['drawing']} in the URL? %s",google.maps.drawing)}componentDidMount(){var t=new google.maps.drawing.DrawingManager(kt(kt({},this.props.options),{},{map:this.context}));this.registeredEvents=re({updaterMap:Zs,eventMap:Gs,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{drawingManager:t}},this.setDrawingManagerCallback)}componentDidUpdate(t){this.state.drawingManager!==null&&(ae(this.registeredEvents),this.registeredEvents=re({updaterMap:Zs,eventMap:Gs,prevProps:t,nextProps:this.props,instance:this.state.drawingManager}))}componentWillUnmount(){this.state.drawingManager!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.drawingManager),ae(this.registeredEvents),this.state.drawingManager.setMap(null))}render(){return null}}I(ui,"contextType",se);function Ks(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function $e(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ks(Object(r),!0).forEach(function(n){I(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):Ks(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}var Ys={onAnimationChanged:"animation_changed",onClick:"click",onClickableChanged:"clickable_changed",onCursorChanged:"cursor_changed",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDraggableChanged:"draggable_changed",onDragStart:"dragstart",onFlatChanged:"flat_changed",onIconChanged:"icon_changed",onMouseDown:"mousedown",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onPositionChanged:"position_changed",onRightClick:"rightclick",onShapeChanged:"shape_changed",onTitleChanged:"title_changed",onVisibleChanged:"visible_changed",onZindexChanged:"zindex_changed"},Js={animation(s,t){s.setAnimation(t)},clickable(s,t){s.setClickable(t)},cursor(s,t){s.setCursor(t)},draggable(s,t){s.setDraggable(t)},icon(s,t){s.setIcon(t)},label(s,t){s.setLabel(t)},map(s,t){s.setMap(t)},opacity(s,t){s.setOpacity(t)},options(s,t){s.setOptions(t)},position(s,t){s.setPosition(t)},shape(s,t){s.setShape(t)},title(s,t){s.setTitle(t)},visible(s,t){s.setVisible(t)},zIndex(s,t){s.setZIndex(t)}},Ct={};function mi(s){var{position:t,options:r,clusterer:n,noClustererRedraw:a,children:o,draggable:l,visible:d,animation:c,clickable:h,cursor:f,icon:u,label:v,opacity:N,shape:b,title:S,zIndex:E,onClick:k,onDblClick:y,onDrag:m,onDragEnd:g,onDragStart:p,onMouseOut:x,onMouseOver:C,onMouseUp:L,onMouseDown:_,onRightClick:A,onClickableChanged:R,onCursorChanged:q,onAnimationChanged:z,onDraggableChanged:G,onFlatChanged:Y,onIconChanged:T,onPositionChanged:V,onShapeChanged:P,onTitleChanged:M,onVisibleChanged:D,onZindexChanged:F,onLoad:$,onUnmount:B}=s,j=i.useContext(se),[w,U]=i.useState(null),[H,W]=i.useState(null),[X,J]=i.useState(null),[ee,ne]=i.useState(null),[ce,Z]=i.useState(null),[K,ge]=i.useState(null),[de,be]=i.useState(null),[ye,ie]=i.useState(null),[me,ke]=i.useState(null),[ue,Ee]=i.useState(null),[xs,vs]=i.useState(null),[it,ys]=i.useState(null),[ot,bs]=i.useState(null),[lt,ws]=i.useState(null),[ct,js]=i.useState(null),[dt,Ns]=i.useState(null),[ut,ks]=i.useState(null),[mt,Cs]=i.useState(null),[Ls,Es]=i.useState(null),[ht,Ss]=i.useState(null),[gt,_s]=i.useState(null),[ft,Ms]=i.useState(null);i.useEffect(()=>{w!==null&&w.setMap(j)},[j]),i.useEffect(()=>{typeof r<"u"&&w!==null&&w.setOptions(r)},[w,r]),i.useEffect(()=>{typeof l<"u"&&w!==null&&w.setDraggable(l)},[w,l]),i.useEffect(()=>{t&&w!==null&&w.setPosition(t)},[w,t]),i.useEffect(()=>{typeof d<"u"&&w!==null&&w.setVisible(d)},[w,d]),i.useEffect(()=>{w==null||w.setAnimation(c)},[w,c]),i.useEffect(()=>{w&&h!==void 0&&w.setClickable(h)},[w,h]),i.useEffect(()=>{w&&f!==void 0&&w.setCursor(f)},[w,f]),i.useEffect(()=>{w&&u!==void 0&&w.setIcon(u)},[w,u]),i.useEffect(()=>{w&&v!==void 0&&w.setLabel(v)},[w,v]),i.useEffect(()=>{w&&N!==void 0&&w.setOpacity(N)},[w,N]),i.useEffect(()=>{w&&b!==void 0&&w.setShape(b)},[w,b]),i.useEffect(()=>{w&&S!==void 0&&w.setTitle(S)},[w,S]),i.useEffect(()=>{w&&E!==void 0&&w.setZIndex(E)},[w,E]),i.useEffect(()=>{w&&y&&(H!==null&&google.maps.event.removeListener(H),W(google.maps.event.addListener(w,"dblclick",y)))},[y]),i.useEffect(()=>{w&&g&&(X!==null&&google.maps.event.removeListener(X),J(google.maps.event.addListener(w,"dragend",g)))},[g]),i.useEffect(()=>{w&&p&&(ee!==null&&google.maps.event.removeListener(ee),ne(google.maps.event.addListener(w,"dragstart",p)))},[p]),i.useEffect(()=>{w&&_&&(ce!==null&&google.maps.event.removeListener(ce),Z(google.maps.event.addListener(w,"mousedown",_)))},[_]),i.useEffect(()=>{w&&x&&(K!==null&&google.maps.event.removeListener(K),ge(google.maps.event.addListener(w,"mouseout",x)))},[x]),i.useEffect(()=>{w&&C&&(de!==null&&google.maps.event.removeListener(de),be(google.maps.event.addListener(w,"mouseover",C)))},[C]),i.useEffect(()=>{w&&L&&(ye!==null&&google.maps.event.removeListener(ye),ie(google.maps.event.addListener(w,"mouseup",L)))},[L]),i.useEffect(()=>{w&&A&&(me!==null&&google.maps.event.removeListener(me),ke(google.maps.event.addListener(w,"rightclick",A)))},[A]),i.useEffect(()=>{w&&k&&(ue!==null&&google.maps.event.removeListener(ue),Ee(google.maps.event.addListener(w,"click",k)))},[k]),i.useEffect(()=>{w&&m&&(xs!==null&&google.maps.event.removeListener(xs),vs(google.maps.event.addListener(w,"drag",m)))},[m]),i.useEffect(()=>{w&&R&&(it!==null&&google.maps.event.removeListener(it),ys(google.maps.event.addListener(w,"clickable_changed",R)))},[R]),i.useEffect(()=>{w&&q&&(ot!==null&&google.maps.event.removeListener(ot),bs(google.maps.event.addListener(w,"cursor_changed",q)))},[q]),i.useEffect(()=>{w&&z&&(lt!==null&&google.maps.event.removeListener(lt),ws(google.maps.event.addListener(w,"animation_changed",z)))},[z]),i.useEffect(()=>{w&&G&&(ct!==null&&google.maps.event.removeListener(ct),js(google.maps.event.addListener(w,"draggable_changed",G)))},[G]),i.useEffect(()=>{w&&Y&&(dt!==null&&google.maps.event.removeListener(dt),Ns(google.maps.event.addListener(w,"flat_changed",Y)))},[Y]),i.useEffect(()=>{w&&T&&(ut!==null&&google.maps.event.removeListener(ut),ks(google.maps.event.addListener(w,"icon_changed",T)))},[T]),i.useEffect(()=>{w&&V&&(mt!==null&&google.maps.event.removeListener(mt),Cs(google.maps.event.addListener(w,"position_changed",V)))},[V]),i.useEffect(()=>{w&&P&&(Ls!==null&&google.maps.event.removeListener(Ls),Es(google.maps.event.addListener(w,"shape_changed",P)))},[P]),i.useEffect(()=>{w&&M&&(ht!==null&&google.maps.event.removeListener(ht),Ss(google.maps.event.addListener(w,"title_changed",M)))},[M]),i.useEffect(()=>{w&&D&&(gt!==null&&google.maps.event.removeListener(gt),_s(google.maps.event.addListener(w,"visible_changed",D)))},[D]),i.useEffect(()=>{w&&F&&(ft!==null&&google.maps.event.removeListener(ft),Ms(google.maps.event.addListener(w,"zindex_changed",F)))},[F]),i.useEffect(()=>{var Ke=$e($e($e({},r||Ct),n?Ct:{map:j}),{},{position:t}),te=new google.maps.Marker(Ke);return n?n.addMarker(te,!!a):te.setMap(j),t&&te.setPosition(t),typeof d<"u"&&te.setVisible(d),typeof l<"u"&&te.setDraggable(l),typeof h<"u"&&te.setClickable(h),typeof f=="string"&&te.setCursor(f),u&&te.setIcon(u),typeof v<"u"&&te.setLabel(v),typeof N<"u"&&te.setOpacity(N),b&&te.setShape(b),typeof S=="string"&&te.setTitle(S),typeof E=="number"&&te.setZIndex(E),y&&W(google.maps.event.addListener(te,"dblclick",y)),g&&J(google.maps.event.addListener(te,"dragend",g)),p&&ne(google.maps.event.addListener(te,"dragstart",p)),_&&Z(google.maps.event.addListener(te,"mousedown",_)),x&&ge(google.maps.event.addListener(te,"mouseout",x)),C&&be(google.maps.event.addListener(te,"mouseover",C)),L&&ie(google.maps.event.addListener(te,"mouseup",L)),A&&ke(google.maps.event.addListener(te,"rightclick",A)),k&&Ee(google.maps.event.addListener(te,"click",k)),m&&vs(google.maps.event.addListener(te,"drag",m)),R&&ys(google.maps.event.addListener(te,"clickable_changed",R)),q&&bs(google.maps.event.addListener(te,"cursor_changed",q)),z&&ws(google.maps.event.addListener(te,"animation_changed",z)),G&&js(google.maps.event.addListener(te,"draggable_changed",G)),Y&&Ns(google.maps.event.addListener(te,"flat_changed",Y)),T&&ks(google.maps.event.addListener(te,"icon_changed",T)),V&&Cs(google.maps.event.addListener(te,"position_changed",V)),P&&Es(google.maps.event.addListener(te,"shape_changed",P)),M&&Ss(google.maps.event.addListener(te,"title_changed",M)),D&&_s(google.maps.event.addListener(te,"visible_changed",D)),F&&Ms(google.maps.event.addListener(te,"zindex_changed",F)),U(te),$&&$(te),()=>{H!==null&&google.maps.event.removeListener(H),X!==null&&google.maps.event.removeListener(X),ee!==null&&google.maps.event.removeListener(ee),ce!==null&&google.maps.event.removeListener(ce),K!==null&&google.maps.event.removeListener(K),de!==null&&google.maps.event.removeListener(de),ye!==null&&google.maps.event.removeListener(ye),me!==null&&google.maps.event.removeListener(me),ue!==null&&google.maps.event.removeListener(ue),it!==null&&google.maps.event.removeListener(it),ot!==null&&google.maps.event.removeListener(ot),lt!==null&&google.maps.event.removeListener(lt),ct!==null&&google.maps.event.removeListener(ct),dt!==null&&google.maps.event.removeListener(dt),ut!==null&&google.maps.event.removeListener(ut),mt!==null&&google.maps.event.removeListener(mt),ht!==null&&google.maps.event.removeListener(ht),gt!==null&&google.maps.event.removeListener(gt),ft!==null&&google.maps.event.removeListener(ft),B&&B(te),n?n.removeMarker(te,!!a):te&&te.setMap(null)}},[]);var ea=i.useMemo(()=>o?i.Children.map(o,Ke=>{if(!i.isValidElement(Ke))return Ke;var te=Ke;return i.cloneElement(te,{anchor:w})}):null,[o,w]);return e.jsx(e.Fragment,{children:ea})||null}i.memo(mi);class An extends i.PureComponent{constructor(){super(...arguments),I(this,"registeredEvents",[])}componentDidMount(){var t=this;return Mn(function*(){var r=$e($e($e({},t.props.options||Ct),t.props.clusterer?Ct:{map:t.context}),{},{position:t.props.position});t.marker=new google.maps.Marker(r),t.props.clusterer?t.props.clusterer.addMarker(t.marker,!!t.props.noClustererRedraw):t.marker.setMap(t.context),t.registeredEvents=re({updaterMap:Js,eventMap:Ys,prevProps:{},nextProps:t.props,instance:t.marker}),t.props.onLoad&&t.props.onLoad(t.marker)})()}componentDidUpdate(t){this.marker&&(ae(this.registeredEvents),this.registeredEvents=re({updaterMap:Js,eventMap:Ys,prevProps:t,nextProps:this.props,instance:this.marker}))}componentWillUnmount(){this.marker&&(this.props.onUnmount&&this.props.onUnmount(this.marker),ae(this.registeredEvents),this.props.clusterer?this.props.clusterer.removeMarker(this.marker,!!this.props.noClustererRedraw):this.marker&&this.marker.setMap(null))}render(){var t=this.props.children?i.Children.map(this.props.children,r=>{if(!i.isValidElement(r))return r;var n=r;return i.cloneElement(n,{anchor:this.marker})}):null;return t||null}}I(An,"contextType",se);var hi=function(){function s(t,r){t.getClusterer().extend(s,google.maps.OverlayView),this.cluster=t,this.clusterClassName=this.cluster.getClusterer().getClusterClass(),this.className=this.clusterClassName,this.styles=r,this.center=void 0,this.div=null,this.sums=null,this.visible=!1,this.boundsChangedListener=null,this.url="",this.height=0,this.width=0,this.anchorText=[0,0],this.anchorIcon=[0,0],this.textColor="black",this.textSize=11,this.textDecoration="none",this.fontWeight="bold",this.fontStyle="normal",this.fontFamily="Arial,sans-serif",this.backgroundPosition="0 0",this.cMouseDownInCluster=null,this.cDraggingMapByCluster=null,this.timeOut=null,this.setMap(t.getMap()),this.onBoundsChanged=this.onBoundsChanged.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onClick=this.onClick.bind(this),this.onMouseOver=this.onMouseOver.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.onAdd=this.onAdd.bind(this),this.onRemove=this.onRemove.bind(this),this.draw=this.draw.bind(this),this.hide=this.hide.bind(this),this.show=this.show.bind(this),this.useStyle=this.useStyle.bind(this),this.setCenter=this.setCenter.bind(this),this.getPosFromLatLng=this.getPosFromLatLng.bind(this)}return s.prototype.onBoundsChanged=function(){this.cDraggingMapByCluster=this.cMouseDownInCluster},s.prototype.onMouseDown=function(){this.cMouseDownInCluster=!0,this.cDraggingMapByCluster=!1},s.prototype.onClick=function(t){if(this.cMouseDownInCluster=!1,!this.cDraggingMapByCluster){var r=this.cluster.getClusterer();if(google.maps.event.trigger(r,"click",this.cluster),google.maps.event.trigger(r,"clusterclick",this.cluster),r.getZoomOnClick()){var n=r.getMaxZoom(),a=this.cluster.getBounds(),o=r.getMap();o!==null&&"fitBounds"in o&&o.fitBounds(a),this.timeOut=window.setTimeout(function(){var l=r.getMap();if(l!==null){"fitBounds"in l&&l.fitBounds(a);var d=l.getZoom()||0;n!==null&&d>n&&l.setZoom(n+1)}},100)}t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()}},s.prototype.onMouseOver=function(){google.maps.event.trigger(this.cluster.getClusterer(),"mouseover",this.cluster)},s.prototype.onMouseOut=function(){google.maps.event.trigger(this.cluster.getClusterer(),"mouseout",this.cluster)},s.prototype.onAdd=function(){var t;this.div=document.createElement("div"),this.div.className=this.className,this.visible&&this.show(),(t=this.getPanes())===null||t===void 0||t.overlayMouseTarget.appendChild(this.div);var r=this.getMap();r!==null&&(this.boundsChangedListener=google.maps.event.addListener(r,"bounds_changed",this.onBoundsChanged),this.div.addEventListener("mousedown",this.onMouseDown),this.div.addEventListener("click",this.onClick),this.div.addEventListener("mouseover",this.onMouseOver),this.div.addEventListener("mouseout",this.onMouseOut))},s.prototype.onRemove=function(){this.div&&this.div.parentNode&&(this.hide(),this.boundsChangedListener!==null&&google.maps.event.removeListener(this.boundsChangedListener),this.div.removeEventListener("mousedown",this.onMouseDown),this.div.removeEventListener("click",this.onClick),this.div.removeEventListener("mouseover",this.onMouseOver),this.div.removeEventListener("mouseout",this.onMouseOut),this.div.parentNode.removeChild(this.div),this.timeOut!==null&&(window.clearTimeout(this.timeOut),this.timeOut=null),this.div=null)},s.prototype.draw=function(){if(this.visible&&this.div!==null&&this.center){var t=this.getPosFromLatLng(this.center);this.div.style.top=t!==null?"".concat(t.y,"px"):"0",this.div.style.left=t!==null?"".concat(t.x,"px"):"0"}},s.prototype.hide=function(){this.div&&(this.div.style.display="none"),this.visible=!1},s.prototype.show=function(){var t,r,n,a,o,l;if(this.div&&this.center){var d=this.sums===null||typeof this.sums.title>"u"||this.sums.title===""?this.cluster.getClusterer().getTitle():this.sums.title,c=this.backgroundPosition.split(" "),h=parseInt(((t=c[0])===null||t===void 0?void 0:t.replace(/^\s+|\s+$/g,""))||"0",10),f=parseInt(((r=c[1])===null||r===void 0?void 0:r.replace(/^\s+|\s+$/g,""))||"0",10),u=this.getPosFromLatLng(this.center);this.div.className=this.className,this.div.setAttribute("style","cursor: pointer; position: absolute; top: ".concat(u!==null?"".concat(u.y,"px"):"0","; left: ").concat(u!==null?"".concat(u.x,"px"):"0","; width: ").concat(this.width,"px; height: ").concat(this.height,"px; "));var v=document.createElement("img");v.alt=d,v.src=this.url,v.width=this.width,v.height=this.height,v.setAttribute("style","position: absolute; top: ".concat(f,"px; left: ").concat(h,"px")),this.cluster.getClusterer().enableRetinaIcons||(v.style.clip="rect(-".concat(f,"px, -").concat(h+this.width,"px, -").concat(f+this.height,", -").concat(h,")"));var N=document.createElement("div");N.setAttribute("style","position: absolute; top: ".concat(this.anchorText[0],"px; left: ").concat(this.anchorText[1],"px; color: ").concat(this.textColor,"; font-size: ").concat(this.textSize,"px; font-family: ").concat(this.fontFamily,"; font-weight: ").concat(this.fontWeight,"; fontStyle: ").concat(this.fontStyle,"; text-decoration: ").concat(this.textDecoration,"; text-align: center; width: ").concat(this.width,"px; line-height: ").concat(this.height,"px")),!((n=this.sums)===null||n===void 0)&&n.text&&(N.innerText="".concat((a=this.sums)===null||a===void 0?void 0:a.text)),!((o=this.sums)===null||o===void 0)&&o.html&&(N.innerHTML="".concat((l=this.sums)===null||l===void 0?void 0:l.html)),this.div.innerHTML="",this.div.appendChild(v),this.div.appendChild(N),this.div.title=d,this.div.style.display=""}this.visible=!0},s.prototype.useStyle=function(t){this.sums=t;var r=this.cluster.getClusterer().getStyles(),n=r[Math.min(r.length-1,Math.max(0,t.index-1))];n&&(this.url=n.url,this.height=n.height,this.width=n.width,n.className&&(this.className="".concat(this.clusterClassName," ").concat(n.className)),this.anchorText=n.anchorText||[0,0],this.anchorIcon=n.anchorIcon||[this.height/2,this.width/2],this.textColor=n.textColor||"black",this.textSize=n.textSize||11,this.textDecoration=n.textDecoration||"none",this.fontWeight=n.fontWeight||"bold",this.fontStyle=n.fontStyle||"normal",this.fontFamily=n.fontFamily||"Arial,sans-serif",this.backgroundPosition=n.backgroundPosition||"0 0")},s.prototype.setCenter=function(t){this.center=t},s.prototype.getPosFromLatLng=function(t){var r=this.getProjection().fromLatLngToDivPixel(t);return r!==null&&(r.x-=this.anchorIcon[1],r.y-=this.anchorIcon[0]),r},s}(),gi=function(){function s(t){this.markerClusterer=t,this.map=this.markerClusterer.getMap(),this.gridSize=this.markerClusterer.getGridSize(),this.minClusterSize=this.markerClusterer.getMinimumClusterSize(),this.averageCenter=this.markerClusterer.getAverageCenter(),this.markers=[],this.center=void 0,this.bounds=null,this.clusterIcon=new hi(this,this.markerClusterer.getStyles()),this.getSize=this.getSize.bind(this),this.getMarkers=this.getMarkers.bind(this),this.getCenter=this.getCenter.bind(this),this.getMap=this.getMap.bind(this),this.getClusterer=this.getClusterer.bind(this),this.getBounds=this.getBounds.bind(this),this.remove=this.remove.bind(this),this.addMarker=this.addMarker.bind(this),this.isMarkerInClusterBounds=this.isMarkerInClusterBounds.bind(this),this.calculateBounds=this.calculateBounds.bind(this),this.updateIcon=this.updateIcon.bind(this),this.isMarkerAlreadyAdded=this.isMarkerAlreadyAdded.bind(this)}return s.prototype.getSize=function(){return this.markers.length},s.prototype.getMarkers=function(){return this.markers},s.prototype.getCenter=function(){return this.center},s.prototype.getMap=function(){return this.map},s.prototype.getClusterer=function(){return this.markerClusterer},s.prototype.getBounds=function(){for(var t=new google.maps.LatLngBounds(this.center,this.center),r=this.getMarkers(),n=0,a=r;n<a.length;n++){var o=a[n],l=o.getPosition();l&&t.extend(l)}return t},s.prototype.remove=function(){this.clusterIcon.setMap(null),this.markers=[],delete this.markers},s.prototype.addMarker=function(t){var r;if(this.isMarkerAlreadyAdded(t))return!1;if(this.center){if(this.averageCenter){var n=t.getPosition();if(n){var a=this.markers.length+1;this.center=new google.maps.LatLng((this.center.lat()*(a-1)+n.lat())/a,(this.center.lng()*(a-1)+n.lng())/a),this.calculateBounds()}}}else{var n=t.getPosition();n&&(this.center=n,this.calculateBounds())}t.isAdded=!0,this.markers.push(t);var o=this.markers.length,l=this.markerClusterer.getMaxZoom(),d=(r=this.map)===null||r===void 0?void 0:r.getZoom();if(l!==null&&typeof d<"u"&&d>l)t.getMap()!==this.map&&t.setMap(this.map);else if(o<this.minClusterSize)t.getMap()!==this.map&&t.setMap(this.map);else if(o===this.minClusterSize)for(var c=0,h=this.markers;c<h.length;c++){var f=h[c];f.setMap(null)}else t.setMap(null);return!0},s.prototype.isMarkerInClusterBounds=function(t){if(this.bounds!==null){var r=t.getPosition();if(r)return this.bounds.contains(r)}return!1},s.prototype.calculateBounds=function(){this.bounds=this.markerClusterer.getExtendedBounds(new google.maps.LatLngBounds(this.center,this.center))},s.prototype.updateIcon=function(){var t,r=this.markers.length,n=this.markerClusterer.getMaxZoom(),a=(t=this.map)===null||t===void 0?void 0:t.getZoom();if(n!==null&&typeof a<"u"&&a>n){this.clusterIcon.hide();return}if(r<this.minClusterSize){this.clusterIcon.hide();return}this.center&&this.clusterIcon.setCenter(this.center),this.clusterIcon.useStyle(this.markerClusterer.getCalculator()(this.markers,this.markerClusterer.getStyles().length)),this.clusterIcon.show()},s.prototype.isMarkerAlreadyAdded=function(t){if(this.markers.includes)return this.markers.includes(t);for(var r=0;r<this.markers.length;r++)if(t===this.markers[r])return!0;return!1},s}();function fi(s,t){var r=s.length,n=r.toString().length,a=Math.min(n,t);return{text:r.toString(),index:a,title:""}}var pi=2e3,xi=500,vi="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m",yi="png",bi=[53,56,66,78,90],wi="cluster",In=function(){function s(t,r,n){r===void 0&&(r=[]),n===void 0&&(n={}),this.getMinimumClusterSize=this.getMinimumClusterSize.bind(this),this.setMinimumClusterSize=this.setMinimumClusterSize.bind(this),this.getEnableRetinaIcons=this.getEnableRetinaIcons.bind(this),this.setEnableRetinaIcons=this.setEnableRetinaIcons.bind(this),this.addToClosestCluster=this.addToClosestCluster.bind(this),this.getImageExtension=this.getImageExtension.bind(this),this.setImageExtension=this.setImageExtension.bind(this),this.getExtendedBounds=this.getExtendedBounds.bind(this),this.getAverageCenter=this.getAverageCenter.bind(this),this.setAverageCenter=this.setAverageCenter.bind(this),this.getTotalClusters=this.getTotalClusters.bind(this),this.fitMapToMarkers=this.fitMapToMarkers.bind(this),this.getIgnoreHidden=this.getIgnoreHidden.bind(this),this.setIgnoreHidden=this.setIgnoreHidden.bind(this),this.getClusterClass=this.getClusterClass.bind(this),this.setClusterClass=this.setClusterClass.bind(this),this.getTotalMarkers=this.getTotalMarkers.bind(this),this.getZoomOnClick=this.getZoomOnClick.bind(this),this.setZoomOnClick=this.setZoomOnClick.bind(this),this.getBatchSizeIE=this.getBatchSizeIE.bind(this),this.setBatchSizeIE=this.setBatchSizeIE.bind(this),this.createClusters=this.createClusters.bind(this),this.onZoomChanged=this.onZoomChanged.bind(this),this.getImageSizes=this.getImageSizes.bind(this),this.setImageSizes=this.setImageSizes.bind(this),this.getCalculator=this.getCalculator.bind(this),this.setCalculator=this.setCalculator.bind(this),this.removeMarkers=this.removeMarkers.bind(this),this.resetViewport=this.resetViewport.bind(this),this.getImagePath=this.getImagePath.bind(this),this.setImagePath=this.setImagePath.bind(this),this.pushMarkerTo=this.pushMarkerTo.bind(this),this.removeMarker=this.removeMarker.bind(this),this.clearMarkers=this.clearMarkers.bind(this),this.setupStyles=this.setupStyles.bind(this),this.getGridSize=this.getGridSize.bind(this),this.setGridSize=this.setGridSize.bind(this),this.getClusters=this.getClusters.bind(this),this.getMaxZoom=this.getMaxZoom.bind(this),this.setMaxZoom=this.setMaxZoom.bind(this),this.getMarkers=this.getMarkers.bind(this),this.addMarkers=this.addMarkers.bind(this),this.getStyles=this.getStyles.bind(this),this.setStyles=this.setStyles.bind(this),this.addMarker=this.addMarker.bind(this),this.onRemove=this.onRemove.bind(this),this.getTitle=this.getTitle.bind(this),this.setTitle=this.setTitle.bind(this),this.repaint=this.repaint.bind(this),this.onIdle=this.onIdle.bind(this),this.redraw=this.redraw.bind(this),this.onAdd=this.onAdd.bind(this),this.draw=this.draw.bind(this),this.extend=this.extend.bind(this),this.extend(s,google.maps.OverlayView),this.markers=[],this.clusters=[],this.listeners=[],this.activeMap=null,this.ready=!1,this.gridSize=n.gridSize||60,this.minClusterSize=n.minimumClusterSize||2,this.maxZoom=n.maxZoom||null,this.styles=n.styles||[],this.title=n.title||"",this.zoomOnClick=!0,n.zoomOnClick!==void 0&&(this.zoomOnClick=n.zoomOnClick),this.averageCenter=!1,n.averageCenter!==void 0&&(this.averageCenter=n.averageCenter),this.ignoreHidden=!1,n.ignoreHidden!==void 0&&(this.ignoreHidden=n.ignoreHidden),this.enableRetinaIcons=!1,n.enableRetinaIcons!==void 0&&(this.enableRetinaIcons=n.enableRetinaIcons),this.imagePath=n.imagePath||vi,this.imageExtension=n.imageExtension||yi,this.imageSizes=n.imageSizes||bi,this.calculator=n.calculator||fi,this.batchSize=n.batchSize||pi,this.batchSizeIE=n.batchSizeIE||xi,this.clusterClass=n.clusterClass||wi,navigator.userAgent.toLowerCase().indexOf("msie")!==-1&&(this.batchSize=this.batchSizeIE),this.timerRefStatic=null,this.setupStyles(),this.addMarkers(r,!0),this.setMap(t)}return s.prototype.onZoomChanged=function(){var t,r;this.resetViewport(!1),(((t=this.getMap())===null||t===void 0?void 0:t.getZoom())===(this.get("minZoom")||0)||((r=this.getMap())===null||r===void 0?void 0:r.getZoom())===this.get("maxZoom"))&&google.maps.event.trigger(this,"idle")},s.prototype.onIdle=function(){this.redraw()},s.prototype.onAdd=function(){var t=this.getMap();this.activeMap=t,this.ready=!0,this.repaint(),t!==null&&(this.listeners=[google.maps.event.addListener(t,"zoom_changed",this.onZoomChanged),google.maps.event.addListener(t,"idle",this.onIdle)])},s.prototype.onRemove=function(){for(var t=0,r=this.markers;t<r.length;t++){var n=r[t];n.getMap()!==this.activeMap&&n.setMap(this.activeMap)}for(var a=0,o=this.clusters;a<o.length;a++){var l=o[a];l.remove()}this.clusters=[];for(var d=0,c=this.listeners;d<c.length;d++){var h=c[d];google.maps.event.removeListener(h)}this.listeners=[],this.activeMap=null,this.ready=!1},s.prototype.draw=function(){},s.prototype.getMap=function(){return null},s.prototype.getPanes=function(){return null},s.prototype.getProjection=function(){return{fromContainerPixelToLatLng:function(){return null},fromDivPixelToLatLng:function(){return null},fromLatLngToContainerPixel:function(){return null},fromLatLngToDivPixel:function(){return null},getVisibleRegion:function(){return null},getWorldWidth:function(){return 0}}},s.prototype.setMap=function(){},s.prototype.addListener=function(){return{remove:function(){}}},s.prototype.bindTo=function(){},s.prototype.get=function(){},s.prototype.notify=function(){},s.prototype.set=function(){},s.prototype.setValues=function(){},s.prototype.unbind=function(){},s.prototype.unbindAll=function(){},s.prototype.setupStyles=function(){if(!(this.styles.length>0))for(var t=0;t<this.imageSizes.length;t++)this.styles.push({url:"".concat(this.imagePath+(t+1),".").concat(this.imageExtension),height:this.imageSizes[t]||0,width:this.imageSizes[t]||0})},s.prototype.fitMapToMarkers=function(){for(var t=this.getMarkers(),r=new google.maps.LatLngBounds,n=0,a=t;n<a.length;n++){var o=a[n],l=o.getPosition();l&&r.extend(l)}var d=this.getMap();d!==null&&"fitBounds"in d&&d.fitBounds(r)},s.prototype.getGridSize=function(){return this.gridSize},s.prototype.setGridSize=function(t){this.gridSize=t},s.prototype.getMinimumClusterSize=function(){return this.minClusterSize},s.prototype.setMinimumClusterSize=function(t){this.minClusterSize=t},s.prototype.getMaxZoom=function(){return this.maxZoom},s.prototype.setMaxZoom=function(t){this.maxZoom=t},s.prototype.getStyles=function(){return this.styles},s.prototype.setStyles=function(t){this.styles=t},s.prototype.getTitle=function(){return this.title},s.prototype.setTitle=function(t){this.title=t},s.prototype.getZoomOnClick=function(){return this.zoomOnClick},s.prototype.setZoomOnClick=function(t){this.zoomOnClick=t},s.prototype.getAverageCenter=function(){return this.averageCenter},s.prototype.setAverageCenter=function(t){this.averageCenter=t},s.prototype.getIgnoreHidden=function(){return this.ignoreHidden},s.prototype.setIgnoreHidden=function(t){this.ignoreHidden=t},s.prototype.getEnableRetinaIcons=function(){return this.enableRetinaIcons},s.prototype.setEnableRetinaIcons=function(t){this.enableRetinaIcons=t},s.prototype.getImageExtension=function(){return this.imageExtension},s.prototype.setImageExtension=function(t){this.imageExtension=t},s.prototype.getImagePath=function(){return this.imagePath},s.prototype.setImagePath=function(t){this.imagePath=t},s.prototype.getImageSizes=function(){return this.imageSizes},s.prototype.setImageSizes=function(t){this.imageSizes=t},s.prototype.getCalculator=function(){return this.calculator},s.prototype.setCalculator=function(t){this.calculator=t},s.prototype.getBatchSizeIE=function(){return this.batchSizeIE},s.prototype.setBatchSizeIE=function(t){this.batchSizeIE=t},s.prototype.getClusterClass=function(){return this.clusterClass},s.prototype.setClusterClass=function(t){this.clusterClass=t},s.prototype.getMarkers=function(){return this.markers},s.prototype.getTotalMarkers=function(){return this.markers.length},s.prototype.getClusters=function(){return this.clusters},s.prototype.getTotalClusters=function(){return this.clusters.length},s.prototype.addMarker=function(t,r){this.pushMarkerTo(t),r||this.redraw()},s.prototype.addMarkers=function(t,r){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var a=t[n];a&&this.pushMarkerTo(a)}r||this.redraw()},s.prototype.pushMarkerTo=function(t){var r=this;t.getDraggable()&&google.maps.event.addListener(t,"dragend",function(){r.ready&&(t.isAdded=!1,r.repaint())}),t.isAdded=!1,this.markers.push(t)},s.prototype.removeMarker_=function(t){var r=-1;if(this.markers.indexOf)r=this.markers.indexOf(t);else for(var n=0;n<this.markers.length;n++)if(t===this.markers[n]){r=n;break}return r===-1?!1:(t.setMap(null),this.markers.splice(r,1),!0)},s.prototype.removeMarker=function(t,r){var n=this.removeMarker_(t);return!r&&n&&this.repaint(),n},s.prototype.removeMarkers=function(t,r){for(var n=!1,a=0,o=t;a<o.length;a++){var l=o[a];n=n||this.removeMarker_(l)}return!r&&n&&this.repaint(),n},s.prototype.clearMarkers=function(){this.resetViewport(!0),this.markers=[]},s.prototype.repaint=function(){var t=this.clusters.slice();this.clusters=[],this.resetViewport(!1),this.redraw(),setTimeout(function(){for(var n=0,a=t;n<a.length;n++){var o=a[n];o.remove()}},0)},s.prototype.getExtendedBounds=function(t){var r=this.getProjection(),n=r.fromLatLngToDivPixel(new google.maps.LatLng(t.getNorthEast().lat(),t.getNorthEast().lng()));n!==null&&(n.x+=this.gridSize,n.y-=this.gridSize);var a=r.fromLatLngToDivPixel(new google.maps.LatLng(t.getSouthWest().lat(),t.getSouthWest().lng()));if(a!==null&&(a.x-=this.gridSize,a.y+=this.gridSize),n!==null){var o=r.fromDivPixelToLatLng(n);o!==null&&t.extend(o)}if(a!==null){var l=r.fromDivPixelToLatLng(a);l!==null&&t.extend(l)}return t},s.prototype.redraw=function(){this.createClusters(0)},s.prototype.resetViewport=function(t){for(var r=0,n=this.clusters;r<n.length;r++){var a=n[r];a.remove()}this.clusters=[];for(var o=0,l=this.markers;o<l.length;o++){var d=l[o];d.isAdded=!1,t&&d.setMap(null)}},s.prototype.distanceBetweenPoints=function(t,r){var n=6371,a=(r.lat()-t.lat())*Math.PI/180,o=(r.lng()-t.lng())*Math.PI/180,l=Math.sin(a/2)*Math.sin(a/2)+Math.cos(t.lat()*Math.PI/180)*Math.cos(r.lat()*Math.PI/180)*Math.sin(o/2)*Math.sin(o/2);return n*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)))},s.prototype.isMarkerInBounds=function(t,r){var n=t.getPosition();return n?r.contains(n):!1},s.prototype.addToClosestCluster=function(t){for(var r,n=4e4,a=null,o=0,l=this.clusters;o<l.length;o++){var d=l[o];r=d;var c=r.getCenter(),h=t.getPosition();if(c&&h){var f=this.distanceBetweenPoints(c,h);f<n&&(n=f,a=r)}}a&&a.isMarkerInClusterBounds(t)?a.addMarker(t):(r=new gi(this),r.addMarker(t),this.clusters.push(r))},s.prototype.createClusters=function(t){var r=this;if(this.ready){t===0&&(google.maps.event.trigger(this,"clusteringbegin",this),this.timerRefStatic!==null&&(window.clearTimeout(this.timerRefStatic),delete this.timerRefStatic));for(var n=this.getMap(),a=n!==null&&("getBounds"in n)?n.getBounds():null,o=(n==null?void 0:n.getZoom())||0,l=o>3?new google.maps.LatLngBounds(a==null?void 0:a.getSouthWest(),a==null?void 0:a.getNorthEast()):new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472,-178.48388434375),new google.maps.LatLng(-85.08136444384544,178.00048865625)),d=this.getExtendedBounds(l),c=Math.min(t+this.batchSize,this.markers.length),h=t;h<c;h++){var f=this.markers[h];f&&!f.isAdded&&this.isMarkerInBounds(f,d)&&(!this.ignoreHidden||this.ignoreHidden&&f.getVisible())&&this.addToClosestCluster(f)}if(c<this.markers.length)this.timerRefStatic=window.setTimeout(function(){r.createClusters(c)},0);else{this.timerRefStatic=null,google.maps.event.trigger(this,"clusteringend",this);for(var u=0,v=this.clusters;u<v.length;u++){var N=v[u];N.updateIcon()}}}},s.prototype.extend=function(t,r){return(function(a){for(var o in a.prototype){var l=o;this.prototype[l]=a.prototype[l]}return this}).apply(t,[r])},s}();function Qs(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function ji(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Qs(Object(r),!0).forEach(function(n){I(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):Qs(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}var Ne={onClick:"click",onClusteringBegin:"clusteringbegin",onClusteringEnd:"clusteringend",onMouseOut:"mouseout",onMouseOver:"mouseover"},oe={averageCenter(s,t){s.setAverageCenter(t)},batchSizeIE(s,t){s.setBatchSizeIE(t)},calculator(s,t){s.setCalculator(t)},clusterClass(s,t){s.setClusterClass(t)},enableRetinaIcons(s,t){s.setEnableRetinaIcons(t)},gridSize(s,t){s.setGridSize(t)},ignoreHidden(s,t){s.setIgnoreHidden(t)},imageExtension(s,t){s.setImageExtension(t)},imagePath(s,t){s.setImagePath(t)},imageSizes(s,t){s.setImageSizes(t)},maxZoom(s,t){s.setMaxZoom(t)},minimumClusterSize(s,t){s.setMinimumClusterSize(t)},styles(s,t){s.setStyles(t)},title(s,t){s.setTitle(t)},zoomOnClick(s,t){s.setZoomOnClick(t)}},Ni={};function ki(s){var{children:t,options:r,averageCenter:n,batchSizeIE:a,calculator:o,clusterClass:l,enableRetinaIcons:d,gridSize:c,ignoreHidden:h,imageExtension:f,imagePath:u,imageSizes:v,maxZoom:N,minimumClusterSize:b,styles:S,title:E,zoomOnClick:k,onClick:y,onClusteringBegin:m,onClusteringEnd:g,onMouseOver:p,onMouseOut:x,onLoad:C,onUnmount:L}=s,[_,A]=i.useState(null),R=i.useContext(se),[q,z]=i.useState(null),[G,Y]=i.useState(null),[T,V]=i.useState(null),[P,M]=i.useState(null),[D,F]=i.useState(null);return i.useEffect(()=>{_&&x&&(P!==null&&google.maps.event.removeListener(P),M(google.maps.event.addListener(_,Ne.onMouseOut,x)))},[x]),i.useEffect(()=>{_&&p&&(D!==null&&google.maps.event.removeListener(D),F(google.maps.event.addListener(_,Ne.onMouseOver,p)))},[p]),i.useEffect(()=>{_&&y&&(q!==null&&google.maps.event.removeListener(q),z(google.maps.event.addListener(_,Ne.onClick,y)))},[y]),i.useEffect(()=>{_&&m&&(G!==null&&google.maps.event.removeListener(G),Y(google.maps.event.addListener(_,Ne.onClusteringBegin,m)))},[m]),i.useEffect(()=>{_&&g&&(T!==null&&google.maps.event.removeListener(T),Y(google.maps.event.addListener(_,Ne.onClusteringEnd,g)))},[g]),i.useEffect(()=>{typeof n<"u"&&_!==null&&oe.averageCenter(_,n)},[_,n]),i.useEffect(()=>{typeof a<"u"&&_!==null&&oe.batchSizeIE(_,a)},[_,a]),i.useEffect(()=>{typeof o<"u"&&_!==null&&oe.calculator(_,o)},[_,o]),i.useEffect(()=>{typeof l<"u"&&_!==null&&oe.clusterClass(_,l)},[_,l]),i.useEffect(()=>{typeof d<"u"&&_!==null&&oe.enableRetinaIcons(_,d)},[_,d]),i.useEffect(()=>{typeof c<"u"&&_!==null&&oe.gridSize(_,c)},[_,c]),i.useEffect(()=>{typeof h<"u"&&_!==null&&oe.ignoreHidden(_,h)},[_,h]),i.useEffect(()=>{typeof f<"u"&&_!==null&&oe.imageExtension(_,f)},[_,f]),i.useEffect(()=>{typeof u<"u"&&_!==null&&oe.imagePath(_,u)},[_,u]),i.useEffect(()=>{typeof v<"u"&&_!==null&&oe.imageSizes(_,v)},[_,v]),i.useEffect(()=>{typeof N<"u"&&_!==null&&oe.maxZoom(_,N)},[_,N]),i.useEffect(()=>{typeof b<"u"&&_!==null&&oe.minimumClusterSize(_,b)},[_,b]),i.useEffect(()=>{typeof S<"u"&&_!==null&&oe.styles(_,S)},[_,S]),i.useEffect(()=>{typeof E<"u"&&_!==null&&oe.title(_,E)},[_,E]),i.useEffect(()=>{typeof k<"u"&&_!==null&&oe.zoomOnClick(_,k)},[_,k]),i.useEffect(()=>{if(R){var $=ji({},r||Ni),B=new In(R,[],$);return n&&oe.averageCenter(B,n),a&&oe.batchSizeIE(B,a),o&&oe.calculator(B,o),l&&oe.clusterClass(B,l),d&&oe.enableRetinaIcons(B,d),c&&oe.gridSize(B,c),h&&oe.ignoreHidden(B,h),f&&oe.imageExtension(B,f),u&&oe.imagePath(B,u),v&&oe.imageSizes(B,v),N&&oe.maxZoom(B,N),b&&oe.minimumClusterSize(B,b),S&&oe.styles(B,S),E&&oe.title(B,E),k&&oe.zoomOnClick(B,k),x&&M(google.maps.event.addListener(B,Ne.onMouseOut,x)),p&&F(google.maps.event.addListener(B,Ne.onMouseOver,p)),y&&z(google.maps.event.addListener(B,Ne.onClick,y)),m&&Y(google.maps.event.addListener(B,Ne.onClusteringBegin,m)),g&&V(google.maps.event.addListener(B,Ne.onClusteringEnd,g)),A(B),C&&C(B),()=>{P!==null&&google.maps.event.removeListener(P),D!==null&&google.maps.event.removeListener(D),q!==null&&google.maps.event.removeListener(q),G!==null&&google.maps.event.removeListener(G),T!==null&&google.maps.event.removeListener(T),L&&L(B)}}},[]),_!==null&&t(_)||null}i.memo(ki);class Ci extends i.PureComponent{constructor(){super(...arguments),I(this,"registeredEvents",[]),I(this,"state",{markerClusterer:null}),I(this,"setClustererCallback",()=>{this.state.markerClusterer!==null&&this.props.onLoad&&this.props.onLoad(this.state.markerClusterer)})}componentDidMount(){if(this.context){var t=new In(this.context,[],this.props.options);this.registeredEvents=re({updaterMap:oe,eventMap:Ne,prevProps:{},nextProps:this.props,instance:t}),this.setState(()=>({markerClusterer:t}),this.setClustererCallback)}}componentDidUpdate(t){this.state.markerClusterer&&(ae(this.registeredEvents),this.registeredEvents=re({updaterMap:oe,eventMap:Ne,prevProps:t,nextProps:this.props,instance:this.state.markerClusterer}))}componentWillUnmount(){this.state.markerClusterer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.markerClusterer),ae(this.registeredEvents),this.state.markerClusterer.setMap(null))}render(){return this.state.markerClusterer!==null?this.props.children(this.state.markerClusterer):null}}I(Ci,"contextType",se);function Xs(s){s.cancelBubble=!0,s.stopPropagation&&s.stopPropagation()}var Rn=function(){function s(t){t===void 0&&(t={}),this.getCloseClickHandler=this.getCloseClickHandler.bind(this),this.closeClickHandler=this.closeClickHandler.bind(this),this.createInfoBoxDiv=this.createInfoBoxDiv.bind(this),this.addClickHandler=this.addClickHandler.bind(this),this.getCloseBoxImg=this.getCloseBoxImg.bind(this),this.getBoxWidths=this.getBoxWidths.bind(this),this.setBoxStyle=this.setBoxStyle.bind(this),this.setPosition=this.setPosition.bind(this),this.getPosition=this.getPosition.bind(this),this.setOptions=this.setOptions.bind(this),this.setContent=this.setContent.bind(this),this.setVisible=this.setVisible.bind(this),this.getContent=this.getContent.bind(this),this.getVisible=this.getVisible.bind(this),this.setZIndex=this.setZIndex.bind(this),this.getZIndex=this.getZIndex.bind(this),this.onRemove=this.onRemove.bind(this),this.panBox=this.panBox.bind(this),this.extend=this.extend.bind(this),this.close=this.close.bind(this),this.draw=this.draw.bind(this),this.show=this.show.bind(this),this.hide=this.hide.bind(this),this.open=this.open.bind(this),this.extend(s,google.maps.OverlayView),this.content=t.content||"",this.disableAutoPan=t.disableAutoPan||!1,this.maxWidth=t.maxWidth||0,this.pixelOffset=t.pixelOffset||new google.maps.Size(0,0),this.position=t.position||new google.maps.LatLng(0,0),this.zIndex=t.zIndex||null,this.boxClass=t.boxClass||"infoBox",this.boxStyle=t.boxStyle||{},this.closeBoxMargin=t.closeBoxMargin||"2px",this.closeBoxURL=t.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif",t.closeBoxURL===""&&(this.closeBoxURL=""),this.infoBoxClearance=t.infoBoxClearance||new google.maps.Size(1,1),typeof t.visible>"u"&&(typeof t.isHidden>"u"?t.visible=!0:t.visible=!t.isHidden),this.isHidden=!t.visible,this.alignBottom=t.alignBottom||!1,this.pane=t.pane||"floatPane",this.enableEventPropagation=t.enableEventPropagation||!1,this.div=null,this.closeListener=null,this.moveListener=null,this.mapListener=null,this.contextListener=null,this.eventListeners=null,this.fixedWidthSet=null}return s.prototype.createInfoBoxDiv=function(){var t=this,r=function(f){f.returnValue=!1,f.preventDefault&&f.preventDefault(),t.enableEventPropagation||Xs(f)};if(!this.div){this.div=document.createElement("div"),this.setBoxStyle(),typeof this.content=="string"?this.div.innerHTML=this.getCloseBoxImg()+this.content:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(this.content));var n=this.getPanes();if(n!==null&&n[this.pane].appendChild(this.div),this.addClickHandler(),this.div.style.width)this.fixedWidthSet=!0;else if(this.maxWidth!==0&&this.div.offsetWidth>this.maxWidth)this.div.style.width=this.maxWidth+"px",this.fixedWidthSet=!0;else{var a=this.getBoxWidths();this.div.style.width=this.div.offsetWidth-a.left-a.right+"px",this.fixedWidthSet=!1}if(this.panBox(this.disableAutoPan),!this.enableEventPropagation){this.eventListeners=[];for(var o=["mousedown","mouseover","mouseout","mouseup","click","dblclick","touchstart","touchend","touchmove"],l=0,d=o;l<d.length;l++){var c=d[l];this.eventListeners.push(google.maps.event.addListener(this.div,c,Xs))}this.eventListeners.push(google.maps.event.addListener(this.div,"mouseover",function(){t.div&&(t.div.style.cursor="default")}))}this.contextListener=google.maps.event.addListener(this.div,"contextmenu",r),google.maps.event.trigger(this,"domready")}},s.prototype.getCloseBoxImg=function(){var t="";return this.closeBoxURL!==""&&(t='<img alt=""',t+=' aria-hidden="true"',t+=" src='"+this.closeBoxURL+"'",t+=" align=right",t+=" style='",t+=" position: relative;",t+=" cursor: pointer;",t+=" margin: "+this.closeBoxMargin+";",t+="'>"),t},s.prototype.addClickHandler=function(){this.closeListener=this.div&&this.div.firstChild&&this.closeBoxURL!==""?google.maps.event.addListener(this.div.firstChild,"click",this.getCloseClickHandler()):null},s.prototype.closeClickHandler=function(t){t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation(),google.maps.event.trigger(this,"closeclick"),this.close()},s.prototype.getCloseClickHandler=function(){return this.closeClickHandler},s.prototype.panBox=function(t){if(this.div&&!t){var r=this.getMap();if(r instanceof google.maps.Map){var n=0,a=0,o=r.getBounds();o&&!o.contains(this.position)&&r.setCenter(this.position);var l=r.getDiv(),d=l.offsetWidth,c=l.offsetHeight,h=this.pixelOffset.width,f=this.pixelOffset.height,u=this.div.offsetWidth,v=this.div.offsetHeight,N=this.infoBoxClearance.width,b=this.infoBoxClearance.height,S=this.getProjection(),E=S.fromLatLngToContainerPixel(this.position);E!==null&&(E.x<-h+N?n=E.x+h-N:E.x+u+h+N>d&&(n=E.x+u+h+N-d),this.alignBottom?E.y<-f+b+v?a=E.y+f-b-v:E.y+f+b>c&&(a=E.y+f+b-c):E.y<-f+b?a=E.y+f-b:E.y+v+f+b>c&&(a=E.y+v+f+b-c)),n===0&&a===0||r.panBy(n,a)}}},s.prototype.setBoxStyle=function(){if(this.div){this.div.className=this.boxClass,this.div.style.cssText="";var t=this.boxStyle;for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(this.div.style[r]=t[r]);if(this.div.style.webkitTransform="translateZ(0)",typeof this.div.style.opacity<"u"&&this.div.style.opacity!==""){var n=parseFloat(this.div.style.opacity||"");this.div.style.msFilter='"progid:DXImageTransform.Microsoft.Alpha(Opacity='+n*100+')"',this.div.style.filter="alpha(opacity="+n*100+")"}this.div.style.position="absolute",this.div.style.visibility="hidden",this.zIndex!==null&&(this.div.style.zIndex=this.zIndex+""),this.div.style.overflow||(this.div.style.overflow="auto")}},s.prototype.getBoxWidths=function(){var t={top:0,bottom:0,left:0,right:0};if(!this.div)return t;if(document.defaultView){var r=this.div.ownerDocument,n=r&&r.defaultView?r.defaultView.getComputedStyle(this.div,""):null;n&&(t.top=parseInt(n.borderTopWidth||"",10)||0,t.bottom=parseInt(n.borderBottomWidth||"",10)||0,t.left=parseInt(n.borderLeftWidth||"",10)||0,t.right=parseInt(n.borderRightWidth||"",10)||0)}else if(document.documentElement.currentStyle){var a=this.div.currentStyle;a&&(t.top=parseInt(a.borderTopWidth||"",10)||0,t.bottom=parseInt(a.borderBottomWidth||"",10)||0,t.left=parseInt(a.borderLeftWidth||"",10)||0,t.right=parseInt(a.borderRightWidth||"",10)||0)}return t},s.prototype.onRemove=function(){this.div&&this.div.parentNode&&(this.div.parentNode.removeChild(this.div),this.div=null)},s.prototype.draw=function(){if(this.createInfoBoxDiv(),this.div){var t=this.getProjection(),r=t.fromLatLngToDivPixel(this.position);r!==null&&(this.div.style.left=r.x+this.pixelOffset.width+"px",this.alignBottom?this.div.style.bottom=-(r.y+this.pixelOffset.height)+"px":this.div.style.top=r.y+this.pixelOffset.height+"px"),this.isHidden?this.div.style.visibility="hidden":this.div.style.visibility="visible"}},s.prototype.setOptions=function(t){t===void 0&&(t={}),typeof t.boxClass<"u"&&(this.boxClass=t.boxClass,this.setBoxStyle()),typeof t.boxStyle<"u"&&(this.boxStyle=t.boxStyle,this.setBoxStyle()),typeof t.content<"u"&&this.setContent(t.content),typeof t.disableAutoPan<"u"&&(this.disableAutoPan=t.disableAutoPan),typeof t.maxWidth<"u"&&(this.maxWidth=t.maxWidth),typeof t.pixelOffset<"u"&&(this.pixelOffset=t.pixelOffset),typeof t.alignBottom<"u"&&(this.alignBottom=t.alignBottom),typeof t.position<"u"&&this.setPosition(t.position),typeof t.zIndex<"u"&&this.setZIndex(t.zIndex),typeof t.closeBoxMargin<"u"&&(this.closeBoxMargin=t.closeBoxMargin),typeof t.closeBoxURL<"u"&&(this.closeBoxURL=t.closeBoxURL),typeof t.infoBoxClearance<"u"&&(this.infoBoxClearance=t.infoBoxClearance),typeof t.isHidden<"u"&&(this.isHidden=t.isHidden),typeof t.visible<"u"&&(this.isHidden=!t.visible),typeof t.enableEventPropagation<"u"&&(this.enableEventPropagation=t.enableEventPropagation),this.div&&this.draw()},s.prototype.setContent=function(t){this.content=t,this.div&&(this.closeListener&&(google.maps.event.removeListener(this.closeListener),this.closeListener=null),this.fixedWidthSet||(this.div.style.width=""),typeof t=="string"?this.div.innerHTML=this.getCloseBoxImg()+t:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(t)),this.fixedWidthSet||(this.div.style.width=this.div.offsetWidth+"px",typeof t=="string"?this.div.innerHTML=this.getCloseBoxImg()+t:(this.div.innerHTML=this.getCloseBoxImg(),this.div.appendChild(t))),this.addClickHandler()),google.maps.event.trigger(this,"content_changed")},s.prototype.setPosition=function(t){this.position=t,this.div&&this.draw(),google.maps.event.trigger(this,"position_changed")},s.prototype.setVisible=function(t){this.isHidden=!t,this.div&&(this.div.style.visibility=this.isHidden?"hidden":"visible")},s.prototype.setZIndex=function(t){this.zIndex=t,this.div&&(this.div.style.zIndex=t+""),google.maps.event.trigger(this,"zindex_changed")},s.prototype.getContent=function(){return this.content},s.prototype.getPosition=function(){return this.position},s.prototype.getZIndex=function(){return this.zIndex},s.prototype.getVisible=function(){var t=this.getMap();return typeof t>"u"||t===null?!1:!this.isHidden},s.prototype.show=function(){this.isHidden=!1,this.div&&(this.div.style.visibility="visible")},s.prototype.hide=function(){this.isHidden=!0,this.div&&(this.div.style.visibility="hidden")},s.prototype.open=function(t,r){var n=this;r&&(this.position=r.getPosition(),this.moveListener=google.maps.event.addListener(r,"position_changed",function(){var a=r.getPosition();n.setPosition(a)}),this.mapListener=google.maps.event.addListener(r,"map_changed",function(){n.setMap(r.map)})),this.setMap(t),this.div&&this.panBox()},s.prototype.close=function(){if(this.closeListener&&(google.maps.event.removeListener(this.closeListener),this.closeListener=null),this.eventListeners){for(var t=0,r=this.eventListeners;t<r.length;t++){var n=r[t];google.maps.event.removeListener(n)}this.eventListeners=null}this.moveListener&&(google.maps.event.removeListener(this.moveListener),this.moveListener=null),this.mapListener&&(google.maps.event.removeListener(this.mapListener),this.mapListener=null),this.contextListener&&(google.maps.event.removeListener(this.contextListener),this.contextListener=null),this.setMap(null)},s.prototype.extend=function(t,r){return(function(a){for(var o in a.prototype)Object.prototype.hasOwnProperty.call(this,o)||(this.prototype[o]=a.prototype[o]);return this}).apply(t,[r])},s}(),Li=["position"],Ei=["position"];function er(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function Lt(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?er(Object(r),!0).forEach(function(n){I(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):er(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}var tr={onCloseClick:"closeclick",onContentChanged:"content_changed",onDomReady:"domready",onPositionChanged:"position_changed",onZindexChanged:"zindex_changed"},sr={options(s,t){s.setOptions(t)},position(s,t){t instanceof google.maps.LatLng?s.setPosition(t):s.setPosition(new google.maps.LatLng(t.lat,t.lng))},visible(s,t){s.setVisible(t)},zIndex(s,t){s.setZIndex(t)}},Si={};function _i(s){var{children:t,anchor:r,options:n,position:a,zIndex:o,onCloseClick:l,onDomReady:d,onContentChanged:c,onPositionChanged:h,onZindexChanged:f,onLoad:u,onUnmount:v}=s,N=i.useContext(se),[b,S]=i.useState(null),[E,k]=i.useState(null),[y,m]=i.useState(null),[g,p]=i.useState(null),[x,C]=i.useState(null),[L,_]=i.useState(null),A=i.useRef(null);return i.useEffect(()=>{N&&b!==null&&(b.close(),r?b.open(N,r):b.getPosition()&&b.open(N))},[N,b,r]),i.useEffect(()=>{n&&b!==null&&b.setOptions(n)},[b,n]),i.useEffect(()=>{if(a&&b!==null){var R=a instanceof google.maps.LatLng?a:new google.maps.LatLng(a.lat,a.lng);b.setPosition(R)}},[a]),i.useEffect(()=>{typeof o=="number"&&b!==null&&b.setZIndex(o)},[o]),i.useEffect(()=>{b&&l&&(E!==null&&google.maps.event.removeListener(E),k(google.maps.event.addListener(b,"closeclick",l)))},[l]),i.useEffect(()=>{b&&d&&(y!==null&&google.maps.event.removeListener(y),m(google.maps.event.addListener(b,"domready",d)))},[d]),i.useEffect(()=>{b&&c&&(g!==null&&google.maps.event.removeListener(g),p(google.maps.event.addListener(b,"content_changed",c)))},[c]),i.useEffect(()=>{b&&h&&(x!==null&&google.maps.event.removeListener(x),C(google.maps.event.addListener(b,"position_changed",h)))},[h]),i.useEffect(()=>{b&&f&&(L!==null&&google.maps.event.removeListener(L),_(google.maps.event.addListener(b,"zindex_changed",f)))},[f]),i.useEffect(()=>{if(N){var R=n||Si,{position:q}=R,z=ds(R,Li),G;q&&!(q instanceof google.maps.LatLng)&&(G=new google.maps.LatLng(q.lat,q.lng));var Y=new Rn(Lt(Lt({},z),G?{position:G}:{}));A.current=document.createElement("div"),S(Y),l&&k(google.maps.event.addListener(Y,"closeclick",l)),d&&m(google.maps.event.addListener(Y,"domready",d)),c&&p(google.maps.event.addListener(Y,"content_changed",c)),h&&C(google.maps.event.addListener(Y,"position_changed",h)),f&&_(google.maps.event.addListener(Y,"zindex_changed",f)),Y.setContent(A.current),r?Y.open(N,r):Y.getPosition()?Y.open(N):pe(!1,"You must provide either an anchor or a position prop for <InfoBox>."),u&&u(Y)}return()=>{b!==null&&(E&&google.maps.event.removeListener(E),g&&google.maps.event.removeListener(g),y&&google.maps.event.removeListener(y),x&&google.maps.event.removeListener(x),L&&google.maps.event.removeListener(L),v&&v(b),b.close())}},[]),A.current?Re.createPortal(i.Children.only(t),A.current):null}i.memo(_i);class Mi extends i.PureComponent{constructor(){super(...arguments),I(this,"registeredEvents",[]),I(this,"containerElement",null),I(this,"state",{infoBox:null}),I(this,"open",(t,r)=>{r?this.context!==null&&t.open(this.context,r):t.getPosition()?this.context!==null&&t.open(this.context):pe(!1,"You must provide either an anchor or a position prop for <InfoBox>.")}),I(this,"setInfoBoxCallback",()=>{this.state.infoBox!==null&&this.containerElement!==null&&(this.state.infoBox.setContent(this.containerElement),this.open(this.state.infoBox,this.props.anchor),this.props.onLoad&&this.props.onLoad(this.state.infoBox))})}componentDidMount(){var t=this.props.options||{},{position:r}=t,n=ds(t,Ei),a;r&&!(r instanceof google.maps.LatLng)&&(a=new google.maps.LatLng(r.lat,r.lng));var o=new Rn(Lt(Lt({},n),a?{position:a}:{}));this.containerElement=document.createElement("div"),this.registeredEvents=re({updaterMap:sr,eventMap:tr,prevProps:{},nextProps:this.props,instance:o}),this.setState({infoBox:o},this.setInfoBoxCallback)}componentDidUpdate(t){var{infoBox:r}=this.state;r!==null&&(ae(this.registeredEvents),this.registeredEvents=re({updaterMap:sr,eventMap:tr,prevProps:t,nextProps:this.props,instance:r}))}componentWillUnmount(){var{onUnmount:t}=this.props,{infoBox:r}=this.state;r!==null&&(t&&t(r),ae(this.registeredEvents),r.close())}render(){return this.containerElement?Re.createPortal(i.Children.only(this.props.children),this.containerElement):null}}I(Mi,"contextType",se);var qt,rr;function Pi(){return rr||(rr=1,qt=function s(t,r){if(t===r)return!0;if(t&&r&&typeof t=="object"&&typeof r=="object"){if(t.constructor!==r.constructor)return!1;var n,a,o;if(Array.isArray(t)){if(n=t.length,n!=r.length)return!1;for(a=n;a--!==0;)if(!s(t[a],r[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if(o=Object.keys(t),n=o.length,n!==Object.keys(r).length)return!1;for(a=n;a--!==0;)if(!Object.prototype.hasOwnProperty.call(r,o[a]))return!1;for(a=n;a--!==0;){var l=o[a];if(!s(t[l],r[l]))return!1}return!0}return t!==t&&r!==r}),qt}var Oi=Pi(),nr=_n(Oi),ar=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],zt=1,Qe=8;class ms{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");var[r,n]=new Uint8Array(t,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");var a=n>>4;if(a!==zt)throw new Error("Got v".concat(a," data when expected v").concat(zt,"."));var o=ar[n&15];if(!o)throw new Error("Unrecognized array type.");var[l]=new Uint16Array(t,2,1),[d]=new Uint32Array(t,4,1);return new ms(d,l,o,t)}constructor(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:64,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Float64Array,a=arguments.length>3?arguments[3]:void 0;if(isNaN(t)||t<0)throw new Error("Unpexpected numItems value: ".concat(t,"."));this.numItems=+t,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=n,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;var o=ar.indexOf(this.ArrayType),l=t*2*this.ArrayType.BYTES_PER_ELEMENT,d=t*this.IndexArrayType.BYTES_PER_ELEMENT,c=(8-d%8)%8;if(o<0)throw new Error("Unexpected typed array class: ".concat(n,"."));a&&a instanceof ArrayBuffer?(this.data=a,this.ids=new this.IndexArrayType(this.data,Qe,t),this.coords=new this.ArrayType(this.data,Qe+d+c,t*2),this._pos=t*2,this._finished=!0):(this.data=new ArrayBuffer(Qe+l+d+c),this.ids=new this.IndexArrayType(this.data,Qe,t),this.coords=new this.ArrayType(this.data,Qe+d+c,t*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(zt<<4)+o]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=t)}add(t,r){var n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=t,this.coords[this._pos++]=r,n}finish(){var t=this._pos>>1;if(t!==this.numItems)throw new Error("Added ".concat(t," items when expected ").concat(this.numItems,"."));return Xt(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,r,n,a){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:o,coords:l,nodeSize:d}=this,c=[0,o.length-1,0],h=[];c.length;){var f=c.pop()||0,u=c.pop()||0,v=c.pop()||0;if(u-v<=d){for(var N=v;N<=u;N++){var b=l[2*N],S=l[2*N+1];b>=t&&b<=n&&S>=r&&S<=a&&h.push(o[N])}continue}var E=v+u>>1,k=l[2*E],y=l[2*E+1];k>=t&&k<=n&&y>=r&&y<=a&&h.push(o[E]),(f===0?t<=k:r<=y)&&(c.push(v),c.push(E-1),c.push(1-f)),(f===0?n>=k:a>=y)&&(c.push(E+1),c.push(u),c.push(1-f))}return h}within(t,r,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:a,coords:o,nodeSize:l}=this,d=[0,a.length-1,0],c=[],h=n*n;d.length;){var f=d.pop()||0,u=d.pop()||0,v=d.pop()||0;if(u-v<=l){for(var N=v;N<=u;N++)ir(o[2*N],o[2*N+1],t,r)<=h&&c.push(a[N]);continue}var b=v+u>>1,S=o[2*b],E=o[2*b+1];ir(S,E,t,r)<=h&&c.push(a[b]),(f===0?t-n<=S:r-n<=E)&&(d.push(v),d.push(b-1),d.push(1-f)),(f===0?t+n>=S:r+n>=E)&&(d.push(b+1),d.push(u),d.push(1-f))}return c}}function Xt(s,t,r,n,a,o){if(!(a-n<=r)){var l=n+a>>1;Fn(s,t,l,n,a,o),Xt(s,t,r,n,l-1,1-o),Xt(s,t,r,l+1,a,1-o)}}function Fn(s,t,r,n,a,o){for(;a>n;){if(a-n>600){var l=a-n+1,d=r-n+1,c=Math.log(l),h=.5*Math.exp(2*c/3),f=.5*Math.sqrt(c*h*(l-h)/l)*(d-l/2<0?-1:1),u=Math.max(n,Math.floor(r-d*h/l+f)),v=Math.min(a,Math.floor(r+(l-d)*h/l+f));Fn(s,t,r,u,v,o)}var N=t[2*r+o],b=n,S=a;for(Xe(s,t,n,r),t[2*a+o]>N&&Xe(s,t,n,a);b<S;){for(Xe(s,t,b,S),b++,S--;t[2*b+o]<N;)b++;for(;t[2*S+o]>N;)S--}t[2*n+o]===N?Xe(s,t,n,S):(S++,Xe(s,t,S,a)),S<=r&&(n=S+1),r<=S&&(a=S-1)}}function Xe(s,t,r,n){Ht(s,r,n),Ht(t,2*r,2*n),Ht(t,2*r+1,2*n+1)}function Ht(s,t,r){var n=s[t];s[t]=s[r],s[r]=n}function ir(s,t,r,n){var a=s-r,o=t-n;return a*a+o*o}var Di={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:s=>s},or=Math.fround||(s=>t=>(s[0]=+t,s[0]))(new Float32Array(1)),De=2,_e=3,Vt=4,Se=5,Un=6;class Ti{constructor(t){this.options=Object.assign(Object.create(Di),t),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(t){var{log:r,minZoom:n,maxZoom:a}=this.options;r&&console.time("total time");var o="prepare ".concat(t.length," points");r&&console.time(o),this.points=t;for(var l=[],d=0;d<t.length;d++){var c=t[d];if(c.geometry){var[h,f]=c.geometry.coordinates,u=or(pt(h)),v=or(xt(f));l.push(u,v,1/0,d,-1,1),this.options.reduce&&l.push(0)}}var N=this.trees[a+1]=this._createTree(l);r&&console.timeEnd(o);for(var b=a;b>=n;b--){var S=+Date.now();N=this.trees[b]=this._createTree(this._cluster(N,b)),r&&console.log("z%d: %d clusters in %dms",b,N.numItems,+Date.now()-S)}return r&&console.timeEnd("total time"),this}getClusters(t,r){var n=((t[0]+180)%360+360)%360-180,a=Math.max(-90,Math.min(90,t[1])),o=t[2]===180?180:((t[2]+180)%360+360)%360-180,l=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)n=-180,o=180;else if(n>o){var d=this.getClusters([n,a,180,l],r),c=this.getClusters([-180,a,o,l],r);return d.concat(c)}var h=this.trees[this._limitZoom(r)],f=h.range(pt(n),xt(l),pt(o),xt(a)),u=h.data,v=[];for(var N of f){var b=this.stride*N;v.push(u[b+Se]>1?lr(u,b,this.clusterProps):this.points[u[b+_e]])}return v}getChildren(t){var r=this._getOriginId(t),n=this._getOriginZoom(t),a="No cluster with the specified id.",o=this.trees[n];if(!o)throw new Error(a);var l=o.data;if(r*this.stride>=l.length)throw new Error(a);var d=this.options.radius/(this.options.extent*Math.pow(2,n-1)),c=l[r*this.stride],h=l[r*this.stride+1],f=o.within(c,h,d),u=[];for(var v of f){var N=v*this.stride;l[N+Vt]===t&&u.push(l[N+Se]>1?lr(l,N,this.clusterProps):this.points[l[N+_e]])}if(u.length===0)throw new Error(a);return u}getLeaves(t,r,n){r=r||10,n=n||0;var a=[];return this._appendLeaves(a,t,r,n,0),a}getTile(t,r,n){var a=this.trees[this._limitZoom(t)],o=Math.pow(2,t),{extent:l,radius:d}=this.options,c=d/l,h=(n-c)/o,f=(n+1+c)/o,u={features:[]};return this._addTileFeatures(a.range((r-c)/o,h,(r+1+c)/o,f),a.data,r,n,o,u),r===0&&this._addTileFeatures(a.range(1-c/o,h,1,f),a.data,o,n,o,u),r===o-1&&this._addTileFeatures(a.range(0,h,c/o,f),a.data,-1,n,o,u),u.features.length?u:null}getClusterExpansionZoom(t){for(var r=this._getOriginZoom(t)-1;r<=this.options.maxZoom;){var n=this.getChildren(t);if(r++,n.length!==1)break;t=n[0].properties.cluster_id}return r}_appendLeaves(t,r,n,a,o){var l=this.getChildren(r);for(var d of l){var c=d.properties;if(c&&c.cluster?o+c.point_count<=a?o+=c.point_count:o=this._appendLeaves(t,c.cluster_id,n,a,o):o<a?o++:t.push(d),t.length===n)break}return o}_createTree(t){for(var r=new ms(t.length/this.stride|0,this.options.nodeSize,Float32Array),n=0;n<t.length;n+=this.stride)r.add(t[n],t[n+1]);return r.finish(),r.data=t,r}_addTileFeatures(t,r,n,a,o,l){for(var d of t){var c=d*this.stride,h=r[c+Se]>1,f=void 0,u=void 0,v=void 0;if(h)f=Bn(r,c,this.clusterProps),u=r[c],v=r[c+1];else{var N=this.points[r[c+_e]];f=N.properties;var[b,S]=N.geometry.coordinates;u=pt(b),v=xt(S)}var E={type:1,geometry:[[Math.round(this.options.extent*(u*o-n)),Math.round(this.options.extent*(v*o-a))]],tags:f},k=void 0;h||this.options.generateId?k=r[c+_e]:k=this.points[r[c+_e]].id,k!==void 0&&(E.id=k),l.features.push(E)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(Math.floor(+t),this.options.maxZoom+1))}_cluster(t,r){for(var{radius:n,extent:a,reduce:o,minPoints:l}=this.options,d=n/(a*Math.pow(2,r)),c=t.data,h=[],f=this.stride,u=0;u<c.length;u+=f)if(!(c[u+De]<=r)){c[u+De]=r;var v=c[u],N=c[u+1],b=t.within(c[u],c[u+1],d),S=c[u+Se],E=S;for(var k of b){var y=k*f;c[y+De]>r&&(E+=c[y+Se])}if(E>S&&E>=l){var m=v*S,g=N*S,p=void 0,x=-1,C=((u/f|0)<<5)+(r+1)+this.points.length;for(var L of b){var _=L*f;if(!(c[_+De]<=r)){c[_+De]=r;var A=c[_+Se];m+=c[_]*A,g+=c[_+1]*A,c[_+Vt]=C,o&&(p||(p=this._map(c,u,!0),x=this.clusterProps.length,this.clusterProps.push(p)),o(p,this._map(c,_)))}}c[u+Vt]=C,h.push(m/E,g/E,1/0,C,-1,E),o&&h.push(x)}else{for(var R=0;R<f;R++)h.push(c[u+R]);if(E>1)for(var q of b){var z=q*f;if(!(c[z+De]<=r)){c[z+De]=r;for(var G=0;G<f;G++)h.push(c[z+G])}}}}return h}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,r,n){if(t[r+Se]>1){var a=this.clusterProps[t[r+Un]];return n?Object.assign({},a):a}var o=this.points[t[r+_e]].properties,l=this.options.map(o);return n&&l===o?Object.assign({},l):l}}function lr(s,t,r){return{type:"Feature",id:s[t+_e],properties:Bn(s,t,r),geometry:{type:"Point",coordinates:[Ai(s[t]),Ii(s[t+1])]}}}function Bn(s,t,r){var n=s[t+Se],a=n>=1e4?"".concat(Math.round(n/1e3),"k"):n>=1e3?"".concat(Math.round(n/100)/10,"k"):n,o=s[t+Un],l=o===-1?{}:Object.assign({},r[o]);return Object.assign(l,{cluster:!0,cluster_id:s[t+_e],point_count:n,point_count_abbreviated:a})}function pt(s){return s/360+.5}function xt(s){var t=Math.sin(s*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function Ai(s){return(s-.5)*360}function Ii(s){var t=(180-s*360)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function Ri(s,t){var r={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&t.indexOf(n)<0&&(r[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(s);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(s,n[a])&&(r[n[a]]=s[n[a]]);return r}class we{static isAdvancedMarkerAvailable(t){return google.maps.marker&&t.getMapCapabilities().isAdvancedMarkersAvailable===!0}static isAdvancedMarker(t){return google.maps.marker&&t instanceof google.maps.marker.AdvancedMarkerElement}static setMap(t,r){this.isAdvancedMarker(t)?t.map=r:t.setMap(r)}static getPosition(t){if(this.isAdvancedMarker(t)){if(t.position){if(t.position instanceof google.maps.LatLng)return t.position;if(t.position.lat&&t.position.lng)return new google.maps.LatLng(t.position.lat,t.position.lng)}return new google.maps.LatLng(null)}return t.getPosition()}static getVisible(t){return this.isAdvancedMarker(t)?!0:t.getVisible()}}class es{constructor(t){var{markers:r,position:n}=t;this.markers=r,n&&(n instanceof google.maps.LatLng?this._position=n:this._position=new google.maps.LatLng(n))}get bounds(){if(!(this.markers.length===0&&!this._position)){var t=new google.maps.LatLngBounds(this._position,this._position);for(var r of this.markers)t.extend(we.getPosition(r));return t}}get position(){return this._position||this.bounds.getCenter()}get count(){return this.markers.filter(t=>we.getVisible(t)).length}push(t){this.markers.push(t)}delete(){this.marker&&(we.setMap(this.marker,null),this.marker=void 0),this.markers.length=0}}class Fi{constructor(t){var{maxZoom:r=16}=t;this.maxZoom=r}noop(t){var{markers:r}=t;return Ui(r)}}var Ui=s=>{var t=s.map(r=>new es({position:we.getPosition(r),markers:[r]}));return t};class Bi extends Fi{constructor(t){var{maxZoom:r,radius:n=60}=t,a=Ri(t,["maxZoom","radius"]);super({maxZoom:r}),this.state={zoom:-1},this.superCluster=new Ti(Object.assign({maxZoom:this.maxZoom,radius:n},a))}calculate(t){var r=!1,n={zoom:t.map.getZoom()};if(!nr(t.markers,this.markers)){r=!0,this.markers=[...t.markers];var a=this.markers.map(o=>{var l=we.getPosition(o),d=[l.lng(),l.lat()];return{type:"Feature",geometry:{type:"Point",coordinates:d},properties:{marker:o}}});this.superCluster.load(a)}return r||(this.state.zoom<=this.maxZoom||n.zoom<=this.maxZoom)&&(r=!nr(this.state,n)),this.state=n,r&&(this.clusters=this.cluster(t)),{clusters:this.clusters,changed:r}}cluster(t){var{map:r}=t;return this.superCluster.getClusters([-180,-90,180,90],Math.round(r.getZoom())).map(n=>this.transformCluster(n))}transformCluster(t){var{geometry:{coordinates:[r,n]},properties:a}=t;if(a.cluster)return new es({markers:this.superCluster.getLeaves(a.cluster_id,1/0).map(l=>l.properties.marker),position:{lat:n,lng:r}});var o=a.marker;return new es({markers:[o],position:we.getPosition(o)})}}class $i{constructor(t,r){this.markers={sum:t.length};var n=r.map(o=>o.count),a=n.reduce((o,l)=>o+l,0);this.clusters={count:r.length,markers:{mean:a/r.length,sum:a,min:Math.min(...n),max:Math.max(...n)}}}}class qi{render(t,r,n){var{count:a,position:o}=t,l=a>Math.max(10,r.clusters.markers.mean)?"#ff0000":"#0000ff",d='<svg fill="'.concat(l,`" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240" width="50" height="50">
<circle cx="120" cy="120" opacity=".6" r="70" />
<circle cx="120" cy="120" opacity=".3" r="90" />
<circle cx="120" cy="120" opacity=".2" r="110" />
<text x="50%" y="50%" style="fill:#fff" text-anchor="middle" font-size="50" dominant-baseline="middle" font-family="roboto,arial,sans-serif">`).concat(a,`</text>
</svg>`),c="Cluster of ".concat(a," markers"),h=Number(google.maps.Marker.MAX_ZINDEX)+a;if(we.isAdvancedMarkerAvailable(n)){var f=new DOMParser,u=f.parseFromString(d,"image/svg+xml").documentElement;u.setAttribute("transform","translate(0 25)");var v={map:n,position:o,zIndex:h,title:c,content:u};return new google.maps.marker.AdvancedMarkerElement(v)}var N={position:o,zIndex:h,title:c,icon:{url:"data:image/svg+xml;base64,".concat(btoa(d)),anchor:new google.maps.Point(25,25)}};return new google.maps.Marker(N)}}function zi(s,t){for(var r in t.prototype)s.prototype[r]=t.prototype[r]}class hs{constructor(){zi(hs,google.maps.OverlayView)}}var st;(function(s){s.CLUSTERING_BEGIN="clusteringbegin",s.CLUSTERING_END="clusteringend",s.CLUSTER_CLICK="click"})(st||(st={}));var Hi=(s,t,r)=>{r.fitBounds(t.bounds)};class Vi extends hs{constructor(t){var{map:r,markers:n=[],algorithmOptions:a={},algorithm:o=new Bi(a),renderer:l=new qi,onClusterClick:d=Hi}=t;super(),this.markers=[...n],this.clusters=[],this.algorithm=o,this.renderer=l,this.onClusterClick=d,r&&this.setMap(r)}addMarker(t,r){this.markers.includes(t)||(this.markers.push(t),r||this.render())}addMarkers(t,r){t.forEach(n=>{this.addMarker(n,!0)}),r||this.render()}removeMarker(t,r){var n=this.markers.indexOf(t);return n===-1?!1:(we.setMap(t,null),this.markers.splice(n,1),r||this.render(),!0)}removeMarkers(t,r){var n=!1;return t.forEach(a=>{n=this.removeMarker(a,!0)||n}),n&&!r&&this.render(),n}clearMarkers(t){this.markers.length=0,t||this.render()}render(){var t=this.getMap();if(t instanceof google.maps.Map&&t.getProjection()){google.maps.event.trigger(this,st.CLUSTERING_BEGIN,this);var{clusters:r,changed:n}=this.algorithm.calculate({markers:this.markers,map:t,mapCanvasProjection:this.getProjection()});if(n||n==null){var a=new Set;for(var o of r)o.markers.length==1&&a.add(o.markers[0]);var l=[];for(var d of this.clusters)d.marker!=null&&(d.markers.length==1?a.has(d.marker)||we.setMap(d.marker,null):l.push(d.marker));this.clusters=r,this.renderClusters(),requestAnimationFrame(()=>l.forEach(c=>we.setMap(c,null)))}google.maps.event.trigger(this,st.CLUSTERING_END,this)}}onAdd(){this.idleListener=this.getMap().addListener("idle",this.render.bind(this)),this.render()}onRemove(){google.maps.event.removeListener(this.idleListener),this.reset()}reset(){this.markers.forEach(t=>we.setMap(t,null)),this.clusters.forEach(t=>t.delete()),this.clusters=[]}renderClusters(){var t=new $i(this.markers,this.clusters),r=this.getMap();this.clusters.forEach(n=>{n.markers.length===1?n.marker=n.markers[0]:(n.marker=this.renderer.render(n,t,r),n.markers.forEach(a=>we.setMap(a,null)),this.onClusterClick&&n.marker.addListener("click",a=>{google.maps.event.trigger(this,st.CLUSTER_CLICK,n),this.onClusterClick(a,n,r)})),we.setMap(n.marker,r)})}}function cr(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function dr(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cr(Object(r),!0).forEach(function(n){I(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):cr(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function Wi(s){var t=Va(),[r,n]=i.useState(null);return i.useEffect(()=>{if(t&&r===null){var a=new Vi(dr(dr({},s),{},{map:t}));n(a)}},[t]),r}function Gi(s){var{children:t,options:r}=s,n=Wi(r);return n!==null?t(n):null}i.memo(Gi);var ur={onCloseClick:"closeclick",onContentChanged:"content_changed",onDomReady:"domready",onPositionChanged:"position_changed",onZindexChanged:"zindex_changed"},mr={options(s,t){s.setOptions(t)},position(s,t){s.setPosition(t)},zIndex(s,t){s.setZIndex(t)}};function Zi(s){var{children:t,anchor:r,options:n,position:a,zIndex:o,onCloseClick:l,onDomReady:d,onContentChanged:c,onPositionChanged:h,onZindexChanged:f,onLoad:u,onUnmount:v}=s,N=i.useContext(se),[b,S]=i.useState(null),[E,k]=i.useState(null),[y,m]=i.useState(null),[g,p]=i.useState(null),[x,C]=i.useState(null),[L,_]=i.useState(null),A=i.useRef(null);return i.useEffect(()=>{b!==null&&(b.close(),r?b.open(N,r):b.getPosition()&&b.open(N))},[N,b,r]),i.useEffect(()=>{n&&b!==null&&b.setOptions(n)},[b,n]),i.useEffect(()=>{a&&b!==null&&b.setPosition(a)},[a]),i.useEffect(()=>{typeof o=="number"&&b!==null&&b.setZIndex(o)},[o]),i.useEffect(()=>{b&&l&&(E!==null&&google.maps.event.removeListener(E),k(google.maps.event.addListener(b,"closeclick",l)))},[l]),i.useEffect(()=>{b&&d&&(y!==null&&google.maps.event.removeListener(y),m(google.maps.event.addListener(b,"domready",d)))},[d]),i.useEffect(()=>{b&&c&&(g!==null&&google.maps.event.removeListener(g),p(google.maps.event.addListener(b,"content_changed",c)))},[c]),i.useEffect(()=>{b&&h&&(x!==null&&google.maps.event.removeListener(x),C(google.maps.event.addListener(b,"position_changed",h)))},[h]),i.useEffect(()=>{b&&f&&(L!==null&&google.maps.event.removeListener(L),_(google.maps.event.addListener(b,"zindex_changed",f)))},[f]),i.useEffect(()=>{var R=new google.maps.InfoWindow(n);return S(R),A.current=document.createElement("div"),l&&k(google.maps.event.addListener(R,"closeclick",l)),d&&m(google.maps.event.addListener(R,"domready",d)),c&&p(google.maps.event.addListener(R,"content_changed",c)),h&&C(google.maps.event.addListener(R,"position_changed",h)),f&&_(google.maps.event.addListener(R,"zindex_changed",f)),R.setContent(A.current),a&&R.setPosition(a),o&&R.setZIndex(o),r?R.open(N,r):R.getPosition()?R.open(N):pe(!1,"You must provide either an anchor (typically render it inside a <Marker>) or a position props for <InfoWindow>."),u&&u(R),()=>{E&&google.maps.event.removeListener(E),g&&google.maps.event.removeListener(g),y&&google.maps.event.removeListener(y),x&&google.maps.event.removeListener(x),L&&google.maps.event.removeListener(L),v&&v(R),R.close()}},[]),A.current?Re.createPortal(i.Children.only(t),A.current):null}i.memo(Zi);class Ki extends i.PureComponent{constructor(){super(...arguments),I(this,"registeredEvents",[]),I(this,"containerElement",null),I(this,"state",{infoWindow:null}),I(this,"open",(t,r)=>{r?t.open(this.context,r):t.getPosition()?t.open(this.context):pe(!1,"You must provide either an anchor (typically render it inside a <Marker>) or a position props for <InfoWindow>.")}),I(this,"setInfoWindowCallback",()=>{this.state.infoWindow!==null&&this.containerElement!==null&&(this.state.infoWindow.setContent(this.containerElement),this.open(this.state.infoWindow,this.props.anchor),this.props.onLoad&&this.props.onLoad(this.state.infoWindow))})}componentDidMount(){var t=new google.maps.InfoWindow(this.props.options);this.containerElement=document.createElement("div"),this.registeredEvents=re({updaterMap:mr,eventMap:ur,prevProps:{},nextProps:this.props,instance:t}),this.setState(()=>({infoWindow:t}),this.setInfoWindowCallback)}componentDidUpdate(t){this.state.infoWindow!==null&&(ae(this.registeredEvents),this.registeredEvents=re({updaterMap:mr,eventMap:ur,prevProps:t,nextProps:this.props,instance:this.state.infoWindow}))}componentWillUnmount(){this.state.infoWindow!==null&&(ae(this.registeredEvents),this.props.onUnmount&&this.props.onUnmount(this.state.infoWindow),this.state.infoWindow.close())}render(){return this.containerElement?Re.createPortal(i.Children.only(this.props.children),this.containerElement):null}}I(Ki,"contextType",se);function hr(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function Et(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hr(Object(r),!0).forEach(function(n){I(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):hr(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}var gr={onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},fr={draggable(s,t){s.setDraggable(t)},editable(s,t){s.setEditable(t)},map(s,t){s.setMap(t)},options(s,t){s.setOptions(t)},path(s,t){s.setPath(t)},visible(s,t){s.setVisible(t)}},Yi={};function Ji(s){var{options:t,draggable:r,editable:n,visible:a,path:o,onDblClick:l,onDragEnd:d,onDragStart:c,onMouseDown:h,onMouseMove:f,onMouseOut:u,onMouseOver:v,onMouseUp:N,onRightClick:b,onClick:S,onDrag:E,onLoad:k,onUnmount:y}=s,m=i.useContext(se),[g,p]=i.useState(null),[x,C]=i.useState(null),[L,_]=i.useState(null),[A,R]=i.useState(null),[q,z]=i.useState(null),[G,Y]=i.useState(null),[T,V]=i.useState(null),[P,M]=i.useState(null),[D,F]=i.useState(null),[$,B]=i.useState(null),[j,w]=i.useState(null),[U,H]=i.useState(null);return i.useEffect(()=>{g!==null&&g.setMap(m)},[m]),i.useEffect(()=>{typeof t<"u"&&g!==null&&g.setOptions(t)},[g,t]),i.useEffect(()=>{typeof r<"u"&&g!==null&&g.setDraggable(r)},[g,r]),i.useEffect(()=>{typeof n<"u"&&g!==null&&g.setEditable(n)},[g,n]),i.useEffect(()=>{typeof a<"u"&&g!==null&&g.setVisible(a)},[g,a]),i.useEffect(()=>{typeof o<"u"&&g!==null&&g.setPath(o)},[g,o]),i.useEffect(()=>{g&&l&&(x!==null&&google.maps.event.removeListener(x),C(google.maps.event.addListener(g,"dblclick",l)))},[l]),i.useEffect(()=>{g&&d&&(L!==null&&google.maps.event.removeListener(L),_(google.maps.event.addListener(g,"dragend",d)))},[d]),i.useEffect(()=>{g&&c&&(A!==null&&google.maps.event.removeListener(A),R(google.maps.event.addListener(g,"dragstart",c)))},[c]),i.useEffect(()=>{g&&h&&(q!==null&&google.maps.event.removeListener(q),z(google.maps.event.addListener(g,"mousedown",h)))},[h]),i.useEffect(()=>{g&&f&&(G!==null&&google.maps.event.removeListener(G),Y(google.maps.event.addListener(g,"mousemove",f)))},[f]),i.useEffect(()=>{g&&u&&(T!==null&&google.maps.event.removeListener(T),V(google.maps.event.addListener(g,"mouseout",u)))},[u]),i.useEffect(()=>{g&&v&&(P!==null&&google.maps.event.removeListener(P),M(google.maps.event.addListener(g,"mouseover",v)))},[v]),i.useEffect(()=>{g&&N&&(D!==null&&google.maps.event.removeListener(D),F(google.maps.event.addListener(g,"mouseup",N)))},[N]),i.useEffect(()=>{g&&b&&($!==null&&google.maps.event.removeListener($),B(google.maps.event.addListener(g,"rightclick",b)))},[b]),i.useEffect(()=>{g&&S&&(j!==null&&google.maps.event.removeListener(j),w(google.maps.event.addListener(g,"click",S)))},[S]),i.useEffect(()=>{g&&E&&(U!==null&&google.maps.event.removeListener(U),H(google.maps.event.addListener(g,"drag",E)))},[E]),i.useEffect(()=>{var W=new google.maps.Polyline(Et(Et({},t||Yi),{},{map:m}));return o&&W.setPath(o),typeof a<"u"&&W.setVisible(a),typeof n<"u"&&W.setEditable(n),typeof r<"u"&&W.setDraggable(r),l&&C(google.maps.event.addListener(W,"dblclick",l)),d&&_(google.maps.event.addListener(W,"dragend",d)),c&&R(google.maps.event.addListener(W,"dragstart",c)),h&&z(google.maps.event.addListener(W,"mousedown",h)),f&&Y(google.maps.event.addListener(W,"mousemove",f)),u&&V(google.maps.event.addListener(W,"mouseout",u)),v&&M(google.maps.event.addListener(W,"mouseover",v)),N&&F(google.maps.event.addListener(W,"mouseup",N)),b&&B(google.maps.event.addListener(W,"rightclick",b)),S&&w(google.maps.event.addListener(W,"click",S)),E&&H(google.maps.event.addListener(W,"drag",E)),p(W),k&&k(W),()=>{x!==null&&google.maps.event.removeListener(x),L!==null&&google.maps.event.removeListener(L),A!==null&&google.maps.event.removeListener(A),q!==null&&google.maps.event.removeListener(q),G!==null&&google.maps.event.removeListener(G),T!==null&&google.maps.event.removeListener(T),P!==null&&google.maps.event.removeListener(P),D!==null&&google.maps.event.removeListener(D),$!==null&&google.maps.event.removeListener($),j!==null&&google.maps.event.removeListener(j),y&&y(W),W.setMap(null)}},[]),null}i.memo(Ji);class Qi extends i.PureComponent{constructor(){super(...arguments),I(this,"registeredEvents",[]),I(this,"state",{polyline:null}),I(this,"setPolylineCallback",()=>{this.state.polyline!==null&&this.props.onLoad&&this.props.onLoad(this.state.polyline)})}componentDidMount(){var t=new google.maps.Polyline(Et(Et({},this.props.options),{},{map:this.context}));this.registeredEvents=re({updaterMap:fr,eventMap:gr,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{polyline:t}},this.setPolylineCallback)}componentDidUpdate(t){this.state.polyline!==null&&(ae(this.registeredEvents),this.registeredEvents=re({updaterMap:fr,eventMap:gr,prevProps:t,nextProps:this.props,instance:this.state.polyline}))}componentWillUnmount(){this.state.polyline!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.polyline),ae(this.registeredEvents),this.state.polyline.setMap(null))}render(){return null}}I(Qi,"contextType",se);function pr(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function xr(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pr(Object(r),!0).forEach(function(n){I(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):pr(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}var vr={onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},yr={draggable(s,t){s.setDraggable(t)},editable(s,t){s.setEditable(t)},map(s,t){s.setMap(t)},options(s,t){s.setOptions(t)},path(s,t){s.setPath(t)},paths(s,t){s.setPaths(t)},visible(s,t){s.setVisible(t)}};function Xi(s){var{options:t,draggable:r,editable:n,visible:a,path:o,paths:l,onDblClick:d,onDragEnd:c,onDragStart:h,onMouseDown:f,onMouseMove:u,onMouseOut:v,onMouseOver:N,onMouseUp:b,onRightClick:S,onClick:E,onDrag:k,onLoad:y,onUnmount:m,onEdit:g}=s,p=i.useContext(se),[x,C]=i.useState(null),[L,_]=i.useState(null),[A,R]=i.useState(null),[q,z]=i.useState(null),[G,Y]=i.useState(null),[T,V]=i.useState(null),[P,M]=i.useState(null),[D,F]=i.useState(null),[$,B]=i.useState(null),[j,w]=i.useState(null),[U,H]=i.useState(null),[W,X]=i.useState(null);return i.useEffect(()=>{x!==null&&x.setMap(p)},[p]),i.useEffect(()=>{typeof t<"u"&&x!==null&&x.setOptions(t)},[x,t]),i.useEffect(()=>{typeof r<"u"&&x!==null&&x.setDraggable(r)},[x,r]),i.useEffect(()=>{typeof n<"u"&&x!==null&&x.setEditable(n)},[x,n]),i.useEffect(()=>{typeof a<"u"&&x!==null&&x.setVisible(a)},[x,a]),i.useEffect(()=>{typeof o<"u"&&x!==null&&x.setPath(o)},[x,o]),i.useEffect(()=>{typeof l<"u"&&x!==null&&x.setPaths(l)},[x,l]),i.useEffect(()=>{x&&typeof d=="function"&&(L!==null&&google.maps.event.removeListener(L),_(google.maps.event.addListener(x,"dblclick",d)))},[d]),i.useEffect(()=>{x&&(google.maps.event.addListener(x.getPath(),"insert_at",()=>{g==null||g(x)}),google.maps.event.addListener(x.getPath(),"set_at",()=>{g==null||g(x)}),google.maps.event.addListener(x.getPath(),"remove_at",()=>{g==null||g(x)}))},[x,g]),i.useEffect(()=>{x&&typeof c=="function"&&(A!==null&&google.maps.event.removeListener(A),R(google.maps.event.addListener(x,"dragend",c)))},[c]),i.useEffect(()=>{x&&typeof h=="function"&&(q!==null&&google.maps.event.removeListener(q),z(google.maps.event.addListener(x,"dragstart",h)))},[h]),i.useEffect(()=>{x&&typeof f=="function"&&(G!==null&&google.maps.event.removeListener(G),Y(google.maps.event.addListener(x,"mousedown",f)))},[f]),i.useEffect(()=>{x&&typeof u=="function"&&(T!==null&&google.maps.event.removeListener(T),V(google.maps.event.addListener(x,"mousemove",u)))},[u]),i.useEffect(()=>{x&&typeof v=="function"&&(P!==null&&google.maps.event.removeListener(P),M(google.maps.event.addListener(x,"mouseout",v)))},[v]),i.useEffect(()=>{x&&typeof N=="function"&&(D!==null&&google.maps.event.removeListener(D),F(google.maps.event.addListener(x,"mouseover",N)))},[N]),i.useEffect(()=>{x&&typeof b=="function"&&($!==null&&google.maps.event.removeListener($),B(google.maps.event.addListener(x,"mouseup",b)))},[b]),i.useEffect(()=>{x&&typeof S=="function"&&(j!==null&&google.maps.event.removeListener(j),w(google.maps.event.addListener(x,"rightclick",S)))},[S]),i.useEffect(()=>{x&&typeof E=="function"&&(U!==null&&google.maps.event.removeListener(U),H(google.maps.event.addListener(x,"click",E)))},[E]),i.useEffect(()=>{x&&typeof k=="function"&&(W!==null&&google.maps.event.removeListener(W),X(google.maps.event.addListener(x,"drag",k)))},[k]),i.useEffect(()=>{var J=new google.maps.Polygon(xr(xr({},t),{},{map:p}));return o&&J.setPath(o),l&&J.setPaths(l),typeof a<"u"&&J.setVisible(a),typeof n<"u"&&J.setEditable(n),typeof r<"u"&&J.setDraggable(r),d&&_(google.maps.event.addListener(J,"dblclick",d)),c&&R(google.maps.event.addListener(J,"dragend",c)),h&&z(google.maps.event.addListener(J,"dragstart",h)),f&&Y(google.maps.event.addListener(J,"mousedown",f)),u&&V(google.maps.event.addListener(J,"mousemove",u)),v&&M(google.maps.event.addListener(J,"mouseout",v)),N&&F(google.maps.event.addListener(J,"mouseover",N)),b&&B(google.maps.event.addListener(J,"mouseup",b)),S&&w(google.maps.event.addListener(J,"rightclick",S)),E&&H(google.maps.event.addListener(J,"click",E)),k&&X(google.maps.event.addListener(J,"drag",k)),C(J),y&&y(J),()=>{L!==null&&google.maps.event.removeListener(L),A!==null&&google.maps.event.removeListener(A),q!==null&&google.maps.event.removeListener(q),G!==null&&google.maps.event.removeListener(G),T!==null&&google.maps.event.removeListener(T),P!==null&&google.maps.event.removeListener(P),D!==null&&google.maps.event.removeListener(D),$!==null&&google.maps.event.removeListener($),j!==null&&google.maps.event.removeListener(j),U!==null&&google.maps.event.removeListener(U),m&&m(J),J.setMap(null)}},[]),null}i.memo(Xi);class eo extends i.PureComponent{constructor(){super(...arguments),I(this,"registeredEvents",[])}componentDidMount(){var t=this.props.options||{};this.polygon=new google.maps.Polygon(t),this.polygon.setMap(this.context),this.registeredEvents=re({updaterMap:yr,eventMap:vr,prevProps:{},nextProps:this.props,instance:this.polygon}),this.props.onLoad&&this.props.onLoad(this.polygon)}componentDidUpdate(t){this.polygon&&(ae(this.registeredEvents),this.registeredEvents=re({updaterMap:yr,eventMap:vr,prevProps:t,nextProps:this.props,instance:this.polygon}))}componentWillUnmount(){this.polygon&&(this.props.onUnmount&&this.props.onUnmount(this.polygon),ae(this.registeredEvents),this.polygon&&this.polygon.setMap(null))}render(){return null}}I(eo,"contextType",se);function br(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function St(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?br(Object(r),!0).forEach(function(n){I(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):br(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}var wr={onBoundsChanged:"bounds_changed",onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},jr={bounds(s,t){s.setBounds(t)},draggable(s,t){s.setDraggable(t)},editable(s,t){s.setEditable(t)},map(s,t){s.setMap(t)},options(s,t){s.setOptions(t)},visible(s,t){s.setVisible(t)}};function to(s){var{options:t,bounds:r,draggable:n,editable:a,visible:o,onDblClick:l,onDragEnd:d,onDragStart:c,onMouseDown:h,onMouseMove:f,onMouseOut:u,onMouseOver:v,onMouseUp:N,onRightClick:b,onClick:S,onDrag:E,onBoundsChanged:k,onLoad:y,onUnmount:m}=s,g=i.useContext(se),[p,x]=i.useState(null),[C,L]=i.useState(null),[_,A]=i.useState(null),[R,q]=i.useState(null),[z,G]=i.useState(null),[Y,T]=i.useState(null),[V,P]=i.useState(null),[M,D]=i.useState(null),[F,$]=i.useState(null),[B,j]=i.useState(null),[w,U]=i.useState(null),[H,W]=i.useState(null),[X,J]=i.useState(null);return i.useEffect(()=>{p!==null&&p.setMap(g)},[g]),i.useEffect(()=>{typeof t<"u"&&p!==null&&p.setOptions(t)},[p,t]),i.useEffect(()=>{typeof n<"u"&&p!==null&&p.setDraggable(n)},[p,n]),i.useEffect(()=>{typeof a<"u"&&p!==null&&p.setEditable(a)},[p,a]),i.useEffect(()=>{typeof o<"u"&&p!==null&&p.setVisible(o)},[p,o]),i.useEffect(()=>{typeof r<"u"&&p!==null&&p.setBounds(r)},[p,r]),i.useEffect(()=>{p&&l&&(C!==null&&google.maps.event.removeListener(C),L(google.maps.event.addListener(p,"dblclick",l)))},[l]),i.useEffect(()=>{p&&d&&(_!==null&&google.maps.event.removeListener(_),A(google.maps.event.addListener(p,"dragend",d)))},[d]),i.useEffect(()=>{p&&c&&(R!==null&&google.maps.event.removeListener(R),q(google.maps.event.addListener(p,"dragstart",c)))},[c]),i.useEffect(()=>{p&&h&&(z!==null&&google.maps.event.removeListener(z),G(google.maps.event.addListener(p,"mousedown",h)))},[h]),i.useEffect(()=>{p&&f&&(Y!==null&&google.maps.event.removeListener(Y),T(google.maps.event.addListener(p,"mousemove",f)))},[f]),i.useEffect(()=>{p&&u&&(V!==null&&google.maps.event.removeListener(V),P(google.maps.event.addListener(p,"mouseout",u)))},[u]),i.useEffect(()=>{p&&v&&(M!==null&&google.maps.event.removeListener(M),D(google.maps.event.addListener(p,"mouseover",v)))},[v]),i.useEffect(()=>{p&&N&&(F!==null&&google.maps.event.removeListener(F),$(google.maps.event.addListener(p,"mouseup",N)))},[N]),i.useEffect(()=>{p&&b&&(B!==null&&google.maps.event.removeListener(B),j(google.maps.event.addListener(p,"rightclick",b)))},[b]),i.useEffect(()=>{p&&S&&(w!==null&&google.maps.event.removeListener(w),U(google.maps.event.addListener(p,"click",S)))},[S]),i.useEffect(()=>{p&&E&&(H!==null&&google.maps.event.removeListener(H),W(google.maps.event.addListener(p,"drag",E)))},[E]),i.useEffect(()=>{p&&k&&(X!==null&&google.maps.event.removeListener(X),J(google.maps.event.addListener(p,"bounds_changed",k)))},[k]),i.useEffect(()=>{var ee=new google.maps.Rectangle(St(St({},t),{},{map:g}));return typeof o<"u"&&ee.setVisible(o),typeof a<"u"&&ee.setEditable(a),typeof n<"u"&&ee.setDraggable(n),typeof r<"u"&&ee.setBounds(r),l&&L(google.maps.event.addListener(ee,"dblclick",l)),d&&A(google.maps.event.addListener(ee,"dragend",d)),c&&q(google.maps.event.addListener(ee,"dragstart",c)),h&&G(google.maps.event.addListener(ee,"mousedown",h)),f&&T(google.maps.event.addListener(ee,"mousemove",f)),u&&P(google.maps.event.addListener(ee,"mouseout",u)),v&&D(google.maps.event.addListener(ee,"mouseover",v)),N&&$(google.maps.event.addListener(ee,"mouseup",N)),b&&j(google.maps.event.addListener(ee,"rightclick",b)),S&&U(google.maps.event.addListener(ee,"click",S)),E&&W(google.maps.event.addListener(ee,"drag",E)),k&&J(google.maps.event.addListener(ee,"bounds_changed",k)),x(ee),y&&y(ee),()=>{C!==null&&google.maps.event.removeListener(C),_!==null&&google.maps.event.removeListener(_),R!==null&&google.maps.event.removeListener(R),z!==null&&google.maps.event.removeListener(z),Y!==null&&google.maps.event.removeListener(Y),V!==null&&google.maps.event.removeListener(V),M!==null&&google.maps.event.removeListener(M),F!==null&&google.maps.event.removeListener(F),B!==null&&google.maps.event.removeListener(B),w!==null&&google.maps.event.removeListener(w),H!==null&&google.maps.event.removeListener(H),X!==null&&google.maps.event.removeListener(X),m&&m(ee),ee.setMap(null)}},[]),null}i.memo(to);class so extends i.PureComponent{constructor(){super(...arguments),I(this,"registeredEvents",[]),I(this,"state",{rectangle:null}),I(this,"setRectangleCallback",()=>{this.state.rectangle!==null&&this.props.onLoad&&this.props.onLoad(this.state.rectangle)})}componentDidMount(){var t=new google.maps.Rectangle(St(St({},this.props.options),{},{map:this.context}));this.registeredEvents=re({updaterMap:jr,eventMap:wr,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{rectangle:t}},this.setRectangleCallback)}componentDidUpdate(t){this.state.rectangle!==null&&(ae(this.registeredEvents),this.registeredEvents=re({updaterMap:jr,eventMap:wr,prevProps:t,nextProps:this.props,instance:this.state.rectangle}))}componentWillUnmount(){this.state.rectangle!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.rectangle),ae(this.registeredEvents),this.state.rectangle.setMap(null))}render(){return null}}I(so,"contextType",se);function Nr(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function _t(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Nr(Object(r),!0).forEach(function(n){I(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):Nr(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}var kr={onCenterChanged:"center_changed",onRadiusChanged:"radius_changed",onClick:"click",onDblClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragStart:"dragstart",onMouseDown:"mousedown",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick"},Cr={center(s,t){s.setCenter(t)},draggable(s,t){s.setDraggable(t)},editable(s,t){s.setEditable(t)},map(s,t){s.setMap(t)},options(s,t){s.setOptions(t)},radius(s,t){s.setRadius(t)},visible(s,t){s.setVisible(t)}},ro={};function no(s){var{options:t,center:r,radius:n,draggable:a,editable:o,visible:l,onDblClick:d,onDragEnd:c,onDragStart:h,onMouseDown:f,onMouseMove:u,onMouseOut:v,onMouseOver:N,onMouseUp:b,onRightClick:S,onClick:E,onDrag:k,onCenterChanged:y,onRadiusChanged:m,onLoad:g,onUnmount:p}=s,x=i.useContext(se),[C,L]=i.useState(null),[_,A]=i.useState(null),[R,q]=i.useState(null),[z,G]=i.useState(null),[Y,T]=i.useState(null),[V,P]=i.useState(null),[M,D]=i.useState(null),[F,$]=i.useState(null),[B,j]=i.useState(null),[w,U]=i.useState(null),[H,W]=i.useState(null),[X,J]=i.useState(null),[ee,ne]=i.useState(null),[ce,Z]=i.useState(null);return i.useEffect(()=>{C!==null&&C.setMap(x)},[x]),i.useEffect(()=>{typeof t<"u"&&C!==null&&C.setOptions(t)},[C,t]),i.useEffect(()=>{typeof a<"u"&&C!==null&&C.setDraggable(a)},[C,a]),i.useEffect(()=>{typeof o<"u"&&C!==null&&C.setEditable(o)},[C,o]),i.useEffect(()=>{typeof l<"u"&&C!==null&&C.setVisible(l)},[C,l]),i.useEffect(()=>{typeof n=="number"&&C!==null&&C.setRadius(n)},[C,n]),i.useEffect(()=>{typeof r<"u"&&C!==null&&C.setCenter(r)},[C,r]),i.useEffect(()=>{C&&d&&(_!==null&&google.maps.event.removeListener(_),A(google.maps.event.addListener(C,"dblclick",d)))},[d]),i.useEffect(()=>{C&&c&&(R!==null&&google.maps.event.removeListener(R),q(google.maps.event.addListener(C,"dragend",c)))},[c]),i.useEffect(()=>{C&&h&&(z!==null&&google.maps.event.removeListener(z),G(google.maps.event.addListener(C,"dragstart",h)))},[h]),i.useEffect(()=>{C&&f&&(Y!==null&&google.maps.event.removeListener(Y),T(google.maps.event.addListener(C,"mousedown",f)))},[f]),i.useEffect(()=>{C&&u&&(V!==null&&google.maps.event.removeListener(V),P(google.maps.event.addListener(C,"mousemove",u)))},[u]),i.useEffect(()=>{C&&v&&(M!==null&&google.maps.event.removeListener(M),D(google.maps.event.addListener(C,"mouseout",v)))},[v]),i.useEffect(()=>{C&&N&&(F!==null&&google.maps.event.removeListener(F),$(google.maps.event.addListener(C,"mouseover",N)))},[N]),i.useEffect(()=>{C&&b&&(B!==null&&google.maps.event.removeListener(B),j(google.maps.event.addListener(C,"mouseup",b)))},[b]),i.useEffect(()=>{C&&S&&(w!==null&&google.maps.event.removeListener(w),U(google.maps.event.addListener(C,"rightclick",S)))},[S]),i.useEffect(()=>{C&&E&&(H!==null&&google.maps.event.removeListener(H),W(google.maps.event.addListener(C,"click",E)))},[E]),i.useEffect(()=>{C&&k&&(X!==null&&google.maps.event.removeListener(X),J(google.maps.event.addListener(C,"drag",k)))},[k]),i.useEffect(()=>{C&&y&&(ee!==null&&google.maps.event.removeListener(ee),ne(google.maps.event.addListener(C,"center_changed",y)))},[E]),i.useEffect(()=>{C&&m&&(ce!==null&&google.maps.event.removeListener(ce),Z(google.maps.event.addListener(C,"radius_changed",m)))},[m]),i.useEffect(()=>{var K=new google.maps.Circle(_t(_t({},t||ro),{},{map:x}));return typeof n=="number"&&K.setRadius(n),typeof r<"u"&&K.setCenter(r),typeof n=="number"&&K.setRadius(n),typeof l<"u"&&K.setVisible(l),typeof o<"u"&&K.setEditable(o),typeof a<"u"&&K.setDraggable(a),d&&A(google.maps.event.addListener(K,"dblclick",d)),c&&q(google.maps.event.addListener(K,"dragend",c)),h&&G(google.maps.event.addListener(K,"dragstart",h)),f&&T(google.maps.event.addListener(K,"mousedown",f)),u&&P(google.maps.event.addListener(K,"mousemove",u)),v&&D(google.maps.event.addListener(K,"mouseout",v)),N&&$(google.maps.event.addListener(K,"mouseover",N)),b&&j(google.maps.event.addListener(K,"mouseup",b)),S&&U(google.maps.event.addListener(K,"rightclick",S)),E&&W(google.maps.event.addListener(K,"click",E)),k&&J(google.maps.event.addListener(K,"drag",k)),y&&ne(google.maps.event.addListener(K,"center_changed",y)),m&&Z(google.maps.event.addListener(K,"radius_changed",m)),L(K),g&&g(K),()=>{_!==null&&google.maps.event.removeListener(_),R!==null&&google.maps.event.removeListener(R),z!==null&&google.maps.event.removeListener(z),Y!==null&&google.maps.event.removeListener(Y),V!==null&&google.maps.event.removeListener(V),M!==null&&google.maps.event.removeListener(M),F!==null&&google.maps.event.removeListener(F),B!==null&&google.maps.event.removeListener(B),w!==null&&google.maps.event.removeListener(w),H!==null&&google.maps.event.removeListener(H),ee!==null&&google.maps.event.removeListener(ee),ce!==null&&google.maps.event.removeListener(ce),p&&p(K),K.setMap(null)}},[]),null}i.memo(no);class ao extends i.PureComponent{constructor(){super(...arguments),I(this,"registeredEvents",[]),I(this,"state",{circle:null}),I(this,"setCircleCallback",()=>{this.state.circle!==null&&this.props.onLoad&&this.props.onLoad(this.state.circle)})}componentDidMount(){var t=new google.maps.Circle(_t(_t({},this.props.options),{},{map:this.context}));this.registeredEvents=re({updaterMap:Cr,eventMap:kr,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{circle:t}},this.setCircleCallback)}componentDidUpdate(t){this.state.circle!==null&&(ae(this.registeredEvents),this.registeredEvents=re({updaterMap:Cr,eventMap:kr,prevProps:t,nextProps:this.props,instance:this.state.circle}))}componentWillUnmount(){if(this.state.circle!==null){var t;this.props.onUnmount&&this.props.onUnmount(this.state.circle),ae(this.registeredEvents),(t=this.state.circle)===null||t===void 0||t.setMap(null)}}render(){return null}}I(ao,"contextType",se);function Lr(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function Mt(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Lr(Object(r),!0).forEach(function(n){I(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):Lr(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}var Er={onClick:"click",onDblClick:"dblclick",onMouseDown:"mousedown",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onRightClick:"rightclick",onAddFeature:"addfeature",onRemoveFeature:"removefeature",onRemoveProperty:"removeproperty",onSetGeometry:"setgeometry",onSetProperty:"setproperty"},Sr={add(s,t){s.add(t)},addgeojson(s,t,r){s.addGeoJson(t,r)},contains(s,t){s.contains(t)},foreach(s,t){s.forEach(t)},loadgeojson(s,t,r,n){s.loadGeoJson(t,r,n)},overridestyle(s,t,r){s.overrideStyle(t,r)},remove(s,t){s.remove(t)},revertstyle(s,t){s.revertStyle(t)},controlposition(s,t){s.setControlPosition(t)},controls(s,t){s.setControls(t)},drawingmode(s,t){s.setDrawingMode(t)},map(s,t){s.setMap(t)},style(s,t){s.setStyle(t)},togeojson(s,t){s.toGeoJson(t)}};function io(s){var{options:t,onClick:r,onDblClick:n,onMouseDown:a,onMouseMove:o,onMouseOut:l,onMouseOver:d,onMouseUp:c,onRightClick:h,onAddFeature:f,onRemoveFeature:u,onRemoveProperty:v,onSetGeometry:N,onSetProperty:b,onLoad:S,onUnmount:E}=s,k=i.useContext(se),[y,m]=i.useState(null),[g,p]=i.useState(null),[x,C]=i.useState(null),[L,_]=i.useState(null),[A,R]=i.useState(null),[q,z]=i.useState(null),[G,Y]=i.useState(null),[T,V]=i.useState(null),[P,M]=i.useState(null),[D,F]=i.useState(null),[$,B]=i.useState(null),[j,w]=i.useState(null),[U,H]=i.useState(null),[W,X]=i.useState(null);return i.useEffect(()=>{y!==null&&y.setMap(k)},[k]),i.useEffect(()=>{y&&n&&(g!==null&&google.maps.event.removeListener(g),p(google.maps.event.addListener(y,"dblclick",n)))},[n]),i.useEffect(()=>{y&&a&&(x!==null&&google.maps.event.removeListener(x),C(google.maps.event.addListener(y,"mousedown",a)))},[a]),i.useEffect(()=>{y&&o&&(L!==null&&google.maps.event.removeListener(L),_(google.maps.event.addListener(y,"mousemove",o)))},[o]),i.useEffect(()=>{y&&l&&(A!==null&&google.maps.event.removeListener(A),R(google.maps.event.addListener(y,"mouseout",l)))},[l]),i.useEffect(()=>{y&&d&&(q!==null&&google.maps.event.removeListener(q),z(google.maps.event.addListener(y,"mouseover",d)))},[d]),i.useEffect(()=>{y&&c&&(G!==null&&google.maps.event.removeListener(G),Y(google.maps.event.addListener(y,"mouseup",c)))},[c]),i.useEffect(()=>{y&&h&&(T!==null&&google.maps.event.removeListener(T),V(google.maps.event.addListener(y,"rightclick",h)))},[h]),i.useEffect(()=>{y&&r&&(P!==null&&google.maps.event.removeListener(P),M(google.maps.event.addListener(y,"click",r)))},[r]),i.useEffect(()=>{y&&f&&(D!==null&&google.maps.event.removeListener(D),F(google.maps.event.addListener(y,"addfeature",f)))},[f]),i.useEffect(()=>{y&&u&&($!==null&&google.maps.event.removeListener($),B(google.maps.event.addListener(y,"removefeature",u)))},[u]),i.useEffect(()=>{y&&v&&(j!==null&&google.maps.event.removeListener(j),w(google.maps.event.addListener(y,"removeproperty",v)))},[v]),i.useEffect(()=>{y&&N&&(U!==null&&google.maps.event.removeListener(U),H(google.maps.event.addListener(y,"setgeometry",N)))},[N]),i.useEffect(()=>{y&&b&&(W!==null&&google.maps.event.removeListener(W),X(google.maps.event.addListener(y,"setproperty",b)))},[b]),i.useEffect(()=>{if(k!==null){var J=new google.maps.Data(Mt(Mt({},t),{},{map:k}));n&&p(google.maps.event.addListener(J,"dblclick",n)),a&&C(google.maps.event.addListener(J,"mousedown",a)),o&&_(google.maps.event.addListener(J,"mousemove",o)),l&&R(google.maps.event.addListener(J,"mouseout",l)),d&&z(google.maps.event.addListener(J,"mouseover",d)),c&&Y(google.maps.event.addListener(J,"mouseup",c)),h&&V(google.maps.event.addListener(J,"rightclick",h)),r&&M(google.maps.event.addListener(J,"click",r)),f&&F(google.maps.event.addListener(J,"addfeature",f)),u&&B(google.maps.event.addListener(J,"removefeature",u)),v&&w(google.maps.event.addListener(J,"removeproperty",v)),N&&H(google.maps.event.addListener(J,"setgeometry",N)),b&&X(google.maps.event.addListener(J,"setproperty",b)),m(J),S&&S(J)}return()=>{y&&(g!==null&&google.maps.event.removeListener(g),x!==null&&google.maps.event.removeListener(x),L!==null&&google.maps.event.removeListener(L),A!==null&&google.maps.event.removeListener(A),q!==null&&google.maps.event.removeListener(q),G!==null&&google.maps.event.removeListener(G),T!==null&&google.maps.event.removeListener(T),P!==null&&google.maps.event.removeListener(P),D!==null&&google.maps.event.removeListener(D),$!==null&&google.maps.event.removeListener($),j!==null&&google.maps.event.removeListener(j),U!==null&&google.maps.event.removeListener(U),W!==null&&google.maps.event.removeListener(W),E&&E(y),y.setMap(null))}},[]),null}i.memo(io);class oo extends i.PureComponent{constructor(){super(...arguments),I(this,"registeredEvents",[]),I(this,"state",{data:null}),I(this,"setDataCallback",()=>{this.state.data!==null&&this.props.onLoad&&this.props.onLoad(this.state.data)})}componentDidMount(){if(this.context!==null){var t=new google.maps.Data(Mt(Mt({},this.props.options),{},{map:this.context}));this.registeredEvents=re({updaterMap:Sr,eventMap:Er,prevProps:{},nextProps:this.props,instance:t}),this.setState(()=>({data:t}),this.setDataCallback)}}componentDidUpdate(t){this.state.data!==null&&(ae(this.registeredEvents),this.registeredEvents=re({updaterMap:Sr,eventMap:Er,prevProps:t,nextProps:this.props,instance:this.state.data}))}componentWillUnmount(){this.state.data!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.data),ae(this.registeredEvents),this.state.data&&this.state.data.setMap(null))}render(){return null}}I(oo,"contextType",se);function _r(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function Mr(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_r(Object(r),!0).forEach(function(n){I(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):_r(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}var Pr={onClick:"click",onDefaultViewportChanged:"defaultviewport_changed",onStatusChanged:"status_changed"},Or={options(s,t){s.setOptions(t)},url(s,t){s.setUrl(t)},zIndex(s,t){s.setZIndex(t)}};class lo extends i.PureComponent{constructor(){super(...arguments),I(this,"registeredEvents",[]),I(this,"state",{kmlLayer:null}),I(this,"setKmlLayerCallback",()=>{this.state.kmlLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.kmlLayer)})}componentDidMount(){var t=new google.maps.KmlLayer(Mr(Mr({},this.props.options),{},{map:this.context}));this.registeredEvents=re({updaterMap:Or,eventMap:Pr,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{kmlLayer:t}},this.setKmlLayerCallback)}componentDidUpdate(t){this.state.kmlLayer!==null&&(ae(this.registeredEvents),this.registeredEvents=re({updaterMap:Or,eventMap:Pr,prevProps:t,nextProps:this.props,instance:this.state.kmlLayer}))}componentWillUnmount(){this.state.kmlLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.kmlLayer),ae(this.registeredEvents),this.state.kmlLayer.setMap(null))}render(){return null}}I(lo,"contextType",se);function $n(s,t){return typeof t=="function"?t(s.offsetWidth,s.offsetHeight):{x:0,y:0}}function co(s,t){return new t(s.lat,s.lng)}function uo(s,t){return new t(new google.maps.LatLng(s.ne.lat,s.ne.lng),new google.maps.LatLng(s.sw.lat,s.sw.lng))}function mo(s,t,r){return s instanceof t?s:r(s,t)}function ho(s,t,r){return s instanceof t?s:r(s,t)}function go(s,t,r){var n=s&&s.fromLatLngToDivPixel(r.getNorthEast()),a=s&&s.fromLatLngToDivPixel(r.getSouthWest());return n&&a?{left:"".concat(a.x+t.x,"px"),top:"".concat(n.y+t.y,"px"),width:"".concat(n.x-a.x-t.x,"px"),height:"".concat(a.y-n.y-t.y,"px")}:{left:"-9999px",top:"-9999px"}}function fo(s,t,r){var n=s&&s.fromLatLngToDivPixel(r);if(n){var{x:a,y:o}=n;return{left:"".concat(a+t.x,"px"),top:"".concat(o+t.y,"px")}}return{left:"-9999px",top:"-9999px"}}function qn(s,t,r,n){return r!==void 0?go(s,t,ho(r,google.maps.LatLngBounds,uo)):fo(s,t,mo(n,google.maps.LatLng,co))}function po(s,t){return s.left===t.left&&s.top===t.top&&s.width===t.height&&s.height===t.height}function Dr(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function xo(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Dr(Object(r),!0).forEach(function(n){I(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):Dr(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function vo(s,t,r,n,a){class o extends google.maps.OverlayView{constructor(d,c,h,f){super(),this.container=d,this.pane=c,this.position=h,this.bounds=f}onAdd(){var d,c=(d=this.getPanes())===null||d===void 0?void 0:d[this.pane];c==null||c.appendChild(this.container)}draw(){var d=this.getProjection(),c=xo({},this.container?$n(this.container,a):{x:0,y:0}),h=qn(d,c,this.bounds,this.position);for(var[f,u]of Object.entries(h))this.container.style[f]=u}onRemove(){this.container.parentNode!==null&&this.container.parentNode.removeChild(this.container)}}return new o(s,t,r,n)}function Tr(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function yo(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Tr(Object(r),!0).forEach(function(n){I(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):Tr(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function Ar(s){if(!s)return"";var t=s instanceof google.maps.LatLng?s:new google.maps.LatLng(s.lat,s.lng);return t+""}function Ir(s){if(!s)return"";var t=s instanceof google.maps.LatLngBounds?s:new google.maps.LatLngBounds(new google.maps.LatLng(s.south,s.east),new google.maps.LatLng(s.north,s.west));return t+""}function bo(s){var{position:t,bounds:r,mapPaneName:n,zIndex:a,onLoad:o,onUnmount:l,getPixelPositionOffset:d,children:c}=s,h=i.useContext(se),f=i.useMemo(()=>{var v=document.createElement("div");return v.style.position="absolute",v},[]),u=i.useMemo(()=>vo(f,n,t,r,d),[f,n,t,r]);return i.useEffect(()=>(o==null||o(u),u==null||u.setMap(h),()=>{l==null||l(u),u==null||u.setMap(null)}),[h,u]),i.useEffect(()=>{f.style.zIndex="".concat(a)},[a,f]),Re.createPortal(c,f)}i.memo(bo);class Ge extends i.PureComponent{constructor(t){super(t),I(this,"state",{paneEl:null,containerStyle:{position:"absolute"}}),I(this,"updatePane",()=>{var n=this.props.mapPaneName,a=this.overlayView.getPanes();pe(!!n,"OverlayView requires props.mapPaneName but got %s",n),a?this.setState({paneEl:a[n]}):this.setState({paneEl:null})}),I(this,"onAdd",()=>{var n,a;this.updatePane(),(n=(a=this.props).onLoad)===null||n===void 0||n.call(a,this.overlayView)}),I(this,"onPositionElement",()=>{var n=this.overlayView.getProjection(),a=yo({x:0,y:0},this.containerRef.current?$n(this.containerRef.current,this.props.getPixelPositionOffset):{}),o=qn(n,a,this.props.bounds,this.props.position);if(!po(o,{left:this.state.containerStyle.left,top:this.state.containerStyle.top,width:this.state.containerStyle.width,height:this.state.containerStyle.height})){var l,d,c,h;this.setState({containerStyle:{top:(l=o.top)!==null&&l!==void 0?l:0,left:(d=o.left)!==null&&d!==void 0?d:0,width:(c=o.width)!==null&&c!==void 0?c:0,height:(h=o.height)!==null&&h!==void 0?h:0,position:"absolute"}})}}),I(this,"draw",()=>{this.onPositionElement()}),I(this,"onRemove",()=>{var n,a;this.setState(()=>({paneEl:null})),(n=(a=this.props).onUnmount)===null||n===void 0||n.call(a,this.overlayView)}),this.containerRef=i.createRef();var r=new google.maps.OverlayView;r.onAdd=this.onAdd,r.draw=this.draw,r.onRemove=this.onRemove,this.overlayView=r}componentDidMount(){this.overlayView.setMap(this.context)}componentDidUpdate(t){var r=Ar(t.position),n=Ar(this.props.position),a=Ir(t.bounds),o=Ir(this.props.bounds);(r!==n||a!==o)&&this.overlayView.draw(),t.mapPaneName!==this.props.mapPaneName&&this.updatePane()}componentWillUnmount(){this.overlayView.setMap(null)}render(){var t=this.state.paneEl;return t?Re.createPortal(e.jsx("div",{ref:this.containerRef,style:this.state.containerStyle,children:i.Children.only(this.props.children)}),t):null}}I(Ge,"FLOAT_PANE","floatPane");I(Ge,"MAP_PANE","mapPane");I(Ge,"MARKER_LAYER","markerLayer");I(Ge,"OVERLAY_LAYER","overlayLayer");I(Ge,"OVERLAY_MOUSE_TARGET","overlayMouseTarget");I(Ge,"contextType",se);function wo(){}function Rr(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function Fr(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Rr(Object(r),!0).forEach(function(n){I(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):Rr(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}var Ur={onDblClick:"dblclick",onClick:"click"},Br={opacity(s,t){s.setOpacity(t)}};function jo(s){var{url:t,bounds:r,options:n,visible:a}=s,o=i.useContext(se),l=new google.maps.LatLngBounds(new google.maps.LatLng(r.south,r.west),new google.maps.LatLng(r.north,r.east)),d=i.useMemo(()=>new google.maps.GroundOverlay(t,l,n),[]);return i.useEffect(()=>{d!==null&&d.setMap(o)},[o]),i.useEffect(()=>{typeof t<"u"&&d!==null&&(d.set("url",t),d.setMap(o))},[d,t]),i.useEffect(()=>{typeof a<"u"&&d!==null&&d.setOpacity(a?1:0)},[d,a]),i.useEffect(()=>{var c=new google.maps.LatLngBounds(new google.maps.LatLng(r.south,r.west),new google.maps.LatLng(r.north,r.east));typeof r<"u"&&d!==null&&(d.set("bounds",c),d.setMap(o))},[d,r]),null}i.memo(jo);class zn extends i.PureComponent{constructor(){super(...arguments),I(this,"registeredEvents",[]),I(this,"state",{groundOverlay:null}),I(this,"setGroundOverlayCallback",()=>{this.state.groundOverlay!==null&&this.props.onLoad&&this.props.onLoad(this.state.groundOverlay)})}componentDidMount(){pe(!!this.props.url||!!this.props.bounds,"For GroundOverlay, url and bounds are passed in to constructor and are immutable after instantiated. This is the behavior of Google Maps JavaScript API v3 ( See https://developers.google.com/maps/documentation/javascript/reference#GroundOverlay) Hence, use the corresponding two props provided by `react-google-maps-api`, url and bounds. In some cases, you'll need the GroundOverlay component to reflect the changes of url and bounds. You can leverage the React's key property to remount the component. Typically, just `key={url}` would serve your need. See https://github.com/tomchentw/react-google-maps/issues/655");var t=new google.maps.GroundOverlay(this.props.url,this.props.bounds,Fr(Fr({},this.props.options),{},{map:this.context}));this.registeredEvents=re({updaterMap:Br,eventMap:Ur,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{groundOverlay:t}},this.setGroundOverlayCallback)}componentDidUpdate(t){this.state.groundOverlay!==null&&(ae(this.registeredEvents),this.registeredEvents=re({updaterMap:Br,eventMap:Ur,prevProps:t,nextProps:this.props,instance:this.state.groundOverlay}))}componentWillUnmount(){this.state.groundOverlay&&(this.props.onUnmount&&this.props.onUnmount(this.state.groundOverlay),this.state.groundOverlay.setMap(null))}render(){return null}}I(zn,"defaultProps",{onLoad:wo});I(zn,"contextType",se);function $r(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function Pt(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$r(Object(r),!0).forEach(function(n){I(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):$r(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}var qr={},zr={data(s,t){s.setData(t)},map(s,t){s.setMap(t)},options(s,t){s.setOptions(t)}};function No(s){var{data:t,onLoad:r,onUnmount:n,options:a}=s,o=i.useContext(se),[l,d]=i.useState(null);return i.useEffect(()=>{google.maps.visualization||pe(!!google.maps.visualization,'Did you include prop libraries={["visualization"]} in useJsApiScript? %s',google.maps.visualization)},[]),i.useEffect(()=>{pe(!!t,"data property is required in HeatmapLayer %s",t)},[t]),i.useEffect(()=>{l!==null&&l.setMap(o)},[o]),i.useEffect(()=>{a&&l!==null&&l.setOptions(a)},[l,a]),i.useEffect(()=>{var c=new google.maps.visualization.HeatmapLayer(Pt(Pt({},a),{},{data:t,map:o}));return d(c),r&&r(c),()=>{l!==null&&(n&&n(l),l.setMap(null))}},[]),null}i.memo(No);class ko extends i.PureComponent{constructor(){super(...arguments),I(this,"registeredEvents",[]),I(this,"state",{heatmapLayer:null}),I(this,"setHeatmapLayerCallback",()=>{this.state.heatmapLayer!==null&&this.props.onLoad&&this.props.onLoad(this.state.heatmapLayer)})}componentDidMount(){pe(!!google.maps.visualization,'Did you include prop libraries={["visualization"]} to <LoadScript />? %s',google.maps.visualization),pe(!!this.props.data,"data property is required in HeatmapLayer %s",this.props.data);var t=new google.maps.visualization.HeatmapLayer(Pt(Pt({},this.props.options),{},{data:this.props.data,map:this.context}));this.registeredEvents=re({updaterMap:zr,eventMap:qr,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{heatmapLayer:t}},this.setHeatmapLayerCallback)}componentDidUpdate(t){ae(this.registeredEvents),this.registeredEvents=re({updaterMap:zr,eventMap:qr,prevProps:t,nextProps:this.props,instance:this.state.heatmapLayer})}componentWillUnmount(){this.state.heatmapLayer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.heatmapLayer),ae(this.registeredEvents),this.state.heatmapLayer.setMap(null))}render(){return null}}I(ko,"contextType",se);var Hr={onCloseClick:"closeclick",onPanoChanged:"pano_changed",onPositionChanged:"position_changed",onPovChanged:"pov_changed",onResize:"resize",onStatusChanged:"status_changed",onVisibleChanged:"visible_changed",onZoomChanged:"zoom_changed"},Vr={register(s,t,r){s.registerPanoProvider(t,r)},links(s,t){s.setLinks(t)},motionTracking(s,t){s.setMotionTracking(t)},options(s,t){s.setOptions(t)},pano(s,t){s.setPano(t)},position(s,t){s.setPosition(t)},pov(s,t){s.setPov(t)},visible(s,t){s.setVisible(t)},zoom(s,t){s.setZoom(t)}};class Co extends i.PureComponent{constructor(){super(...arguments),I(this,"registeredEvents",[]),I(this,"state",{streetViewPanorama:null}),I(this,"setStreetViewPanoramaCallback",()=>{this.state.streetViewPanorama!==null&&this.props.onLoad&&this.props.onLoad(this.state.streetViewPanorama)})}componentDidMount(){var t,r,n=(t=(r=this.context)===null||r===void 0?void 0:r.getStreetView())!==null&&t!==void 0?t:null;this.registeredEvents=re({updaterMap:Vr,eventMap:Hr,prevProps:{},nextProps:this.props,instance:n}),this.setState(()=>({streetViewPanorama:n}),this.setStreetViewPanoramaCallback)}componentDidUpdate(t){this.state.streetViewPanorama!==null&&(ae(this.registeredEvents),this.registeredEvents=re({updaterMap:Vr,eventMap:Hr,prevProps:t,nextProps:this.props,instance:this.state.streetViewPanorama}))}componentWillUnmount(){this.state.streetViewPanorama!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.streetViewPanorama),ae(this.registeredEvents),this.state.streetViewPanorama.setVisible(!1))}render(){return null}}I(Co,"contextType",se);class Lo extends i.PureComponent{constructor(){super(...arguments),I(this,"state",{streetViewService:null}),I(this,"setStreetViewServiceCallback",()=>{this.state.streetViewService!==null&&this.props.onLoad&&this.props.onLoad(this.state.streetViewService)})}componentDidMount(){var t=new google.maps.StreetViewService;this.setState(function(){return{streetViewService:t}},this.setStreetViewServiceCallback)}componentWillUnmount(){this.state.streetViewService!==null&&this.props.onUnmount&&this.props.onUnmount(this.state.streetViewService)}render(){return null}}I(Lo,"contextType",se);var Wr={onDirectionsChanged:"directions_changed"},Gr={directions(s,t){s.setDirections(t)},map(s,t){s.setMap(t)},options(s,t){s.setOptions(t)},panel(s,t){s.setPanel(t)},routeIndex(s,t){s.setRouteIndex(t)}};class Eo extends i.PureComponent{constructor(){super(...arguments),I(this,"registeredEvents",[]),I(this,"state",{directionsRenderer:null}),I(this,"setDirectionsRendererCallback",()=>{this.state.directionsRenderer!==null&&(this.state.directionsRenderer.setMap(this.context),this.props.onLoad&&this.props.onLoad(this.state.directionsRenderer))})}componentDidMount(){var t=new google.maps.DirectionsRenderer(this.props.options);this.registeredEvents=re({updaterMap:Gr,eventMap:Wr,prevProps:{},nextProps:this.props,instance:t}),this.setState(function(){return{directionsRenderer:t}},this.setDirectionsRendererCallback)}componentDidUpdate(t){this.state.directionsRenderer!==null&&(ae(this.registeredEvents),this.registeredEvents=re({updaterMap:Gr,eventMap:Wr,prevProps:t,nextProps:this.props,instance:this.state.directionsRenderer}))}componentWillUnmount(){this.state.directionsRenderer!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.directionsRenderer),ae(this.registeredEvents),this.state.directionsRenderer&&this.state.directionsRenderer.setMap(null))}render(){return null}}I(Eo,"contextType",se);var Zr={onPlacesChanged:"places_changed"},Kr={bounds(s,t){s.setBounds(t)}};class So extends i.PureComponent{constructor(){super(...arguments),I(this,"registeredEvents",[]),I(this,"containerElement",i.createRef()),I(this,"state",{searchBox:null}),I(this,"setSearchBoxCallback",()=>{this.state.searchBox!==null&&this.props.onLoad&&this.props.onLoad(this.state.searchBox)})}componentDidMount(){if(pe(!!google.maps.places,'You need to provide libraries={["places"]} prop to <LoadScript /> component %s',google.maps.places),this.containerElement!==null&&this.containerElement.current!==null){var t=this.containerElement.current.querySelector("input");if(t!==null){var r=new google.maps.places.SearchBox(t,this.props.options);this.registeredEvents=re({updaterMap:Kr,eventMap:Zr,prevProps:{},nextProps:this.props,instance:r}),this.setState(function(){return{searchBox:r}},this.setSearchBoxCallback)}}}componentDidUpdate(t){this.state.searchBox!==null&&(ae(this.registeredEvents),this.registeredEvents=re({updaterMap:Kr,eventMap:Zr,prevProps:t,nextProps:this.props,instance:this.state.searchBox}))}componentWillUnmount(){this.state.searchBox!==null&&(this.props.onUnmount&&this.props.onUnmount(this.state.searchBox),ae(this.registeredEvents))}render(){return e.jsx("div",{ref:this.containerElement,children:i.Children.only(this.props.children)})}}I(So,"contextType",se);var Yr={onPlaceChanged:"place_changed"},Jr={bounds(s,t){s.setBounds(t)},restrictions(s,t){s.setComponentRestrictions(t)},fields(s,t){s.setFields(t)},options(s,t){s.setOptions(t)},types(s,t){s.setTypes(t)}};class gs extends i.PureComponent{constructor(){super(...arguments),I(this,"registeredEvents",[]),I(this,"containerElement",i.createRef()),I(this,"state",{autocomplete:null}),I(this,"setAutocompleteCallback",()=>{this.state.autocomplete!==null&&this.props.onLoad&&this.props.onLoad(this.state.autocomplete)})}componentDidMount(){var t;pe(!!google.maps.places,'You need to provide libraries={["places"]} prop to <LoadScript /> component %s',google.maps.places);var r=(t=this.containerElement.current)===null||t===void 0?void 0:t.querySelector("input");if(r){var n=new google.maps.places.Autocomplete(r,this.props.options);this.registeredEvents=re({updaterMap:Jr,eventMap:Yr,prevProps:{},nextProps:this.props,instance:n}),this.setState(()=>({autocomplete:n}),this.setAutocompleteCallback)}}componentDidUpdate(t){ae(this.registeredEvents),this.registeredEvents=re({updaterMap:Jr,eventMap:Yr,prevProps:t,nextProps:this.props,instance:this.state.autocomplete})}componentWillUnmount(){this.state.autocomplete!==null&&ae(this.registeredEvents)}render(){return e.jsx("div",{ref:this.containerElement,className:this.props.className,children:i.Children.only(this.props.children)})}}I(gs,"defaultProps",{className:""});I(gs,"contextType",se);const Ze=({event:s,onClose:t})=>{const[r,n]=i.useState(!1),[a,o]=i.useState(""),[l,d]=i.useState(!1),[c,h]=i.useState(null),[f,u]=i.useState(null),{isLoaded:v,loadError:N}=us({googleMapsApiKey:"AIzaSyBX5zRALfwGxan0wA6EGtcQuBbLqB2gj_E",libraries:["places"]});Me.useEffect(()=>{v&&s.location&&!f&&new google.maps.Geocoder().geocode({address:s.location},(k,y)=>{if(y==="OK"&&(k!=null&&k[0])){const{lat:m,lng:g}=k[0].geometry.location;u({lat:m(),lng:g()})}})},[v,s.location,f]);const b=async E=>{var k;if(E.preventDefault(),!!a){d(!0),h(null);try{const{data:{user:y}}=await O.auth.getUser();if(!y)throw new Error("Not authenticated");if(!(await fetch("/api/share-event",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${(k=(await O.auth.getSession()).data.session)==null?void 0:k.access_token}`},body:JSON.stringify({event:s,recipientEmail:a,senderEmail:y.email})})).ok)throw new Error("Failed to share event");n(!1),o("")}catch{h("Failed to share event. Please try again.")}finally{d(!1)}}},S=()=>e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",onClick:E=>E.stopPropagation(),children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Share Event"}),e.jsx("button",{onClick:()=>n(!1),className:"text-gray-400 hover:text-gray-500 dark:text-gray-300 dark:hover:text-gray-200",children:e.jsx(he,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Recipient Email"}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(os,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"email",id:"email",value:a,onChange:E=>o(E.target.value),className:"block w-full pl-10 pr-12 sm:text-sm border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter email address",autoComplete:"off"})]})]}),c&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:c}),e.jsx("button",{type:"submit",disabled:l||!a,className:"w-full flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:l?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"}),"Sharing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(jn,{className:"h-4 w-4 mr-2"}),"Share Event"]})})]})]})});return e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:t,children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-auto",onClick:E=>E.stopPropagation(),children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:s.child.color}}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:s.title})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>n(!0),className:"p-2 text-gray-400 hover:text-gray-500 dark:text-gray-300 dark:hover:text-gray-200 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",children:e.jsx(Nn,{className:"h-5 w-5"})}),e.jsx("button",{onClick:t,className:"p-2 text-gray-400 hover:text-gray-500 dark:text-gray-300 dark:hover:text-gray-200 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",children:e.jsx(he,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx(le,{className:"h-5 w-5 mr-3"}),e.jsx("span",{children:s.startTime.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),e.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx(Fe,{className:"h-5 w-5 mr-3"}),e.jsxs("span",{children:[s.startTime.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})," -",s.endTime.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})]})]}),e.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx(cs,{className:"h-5 w-5 mr-3"}),e.jsx("span",{children:s.child.name})]}),s.location&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[e.jsx(at,{className:"h-5 w-5 mr-3"}),e.jsx("span",{children:s.location})]}),v&&!N&&e.jsx("div",{className:"h-64 w-full rounded-lg overflow-hidden",children:f&&e.jsx(Qa,{mapContainerStyle:{width:"100%",height:"100%"},center:f,zoom:15,children:e.jsx(An,{position:f})})})]}),s.description&&e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:s.description})})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm",style:{color:s.platformColor},children:[e.jsx(s.platformIcon,{className:"h-4 w-4"}),e.jsxs("span",{children:["Synced from ",s.platform]})]})]})]}),r&&e.jsx(S,{})]})},Qr=({event:s})=>{const[t,r]=i.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors cursor-pointer",onClick:()=>r(!0),children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsxs("div",{className:"w-12 h-12 rounded-lg flex flex-col items-center justify-center",style:{backgroundColor:s.color+"20",color:s.color},children:[e.jsx("div",{className:"text-xs font-medium",children:s.startTime.toLocaleString("default",{month:"short"})}),e.jsx("div",{className:"text-lg font-bold",children:s.startTime.getDate()})]})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"inline-block h-2 w-2 rounded-full",style:{backgroundColor:s.child.color}}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:s.child.name}),e.jsx("span",{className:"text-xs bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300 px-2 py-0.5 rounded-full",children:s.sport})]}),e.jsx("h3",{className:"text-base font-medium text-gray-900 dark:text-white mt-1",children:s.title}),e.jsxs("div",{className:"mt-2 flex items-center text-sm text-gray-500 dark:text-gray-400 space-x-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Fe,{className:"h-4 w-4 mr-1"}),s.startTime.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})," -",s.endTime.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})]}),s.location&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(at,{className:"h-4 w-4 mr-1"}),s.location]})]})]}),e.jsx("div",{className:"flex-shrink-0 self-center",children:e.jsx("div",{className:"h-8 w-8 rounded flex items-center justify-center",style:{backgroundColor:s.platformColor+"20",color:s.platformColor},children:e.jsx(s.platformIcon,{className:"h-4 w-4"})})})]})}),t&&e.jsx(Ze,{event:s,onClose:()=>r(!1)})]})},_o=({child:s})=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"h-10 w-10 rounded-full flex items-center justify-center text-white font-bold",style:{backgroundColor:s.color},children:s.name.charAt(0)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white",children:s.name}),e.jsx("div",{className:"flex items-center mt-1",children:s.sports.map((t,r)=>e.jsxs("div",{className:"flex items-center text-xs mr-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full mr-1",style:{backgroundColor:t.color}}),e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:t.name})]},r))})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:s.eventCount}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"This week"})]})]}),Mo=({platform:s})=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg flex items-center justify-center",style:{backgroundColor:s.color+"20",color:s.color},children:e.jsx(s.icon,{className:"h-6 w-6"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white",children:s.name}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:s.connected?"Connected":"Not connected"}),s.connected&&e.jsxs("div",{className:"ml-2 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-300 text-xs px-2 py-0.5 rounded-full flex items-center",children:[e.jsx(bt,{className:"h-3 w-3 mr-1"}),"Synced"]}),s.hasIssue&&e.jsxs("div",{className:"ml-2 bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-300 text-xs px-2 py-0.5 rounded-full flex items-center",children:[e.jsx(Ve,{className:"h-3 w-3 mr-1"}),"Issue"]})]})]}),e.jsx("div",{children:e.jsx("button",{className:"text-xs text-blue-600 dark:text-blue-400 hover:text-blue-500 dark:hover:text-blue-300",children:s.connected?"Refresh":"Connect"})})]}),Po=()=>{const{profiles:s}=Ue(),[t,r]=i.useState([]),[n,a]=i.useState([]),[o,l]=i.useState([]),[d,c]=i.useState(!0),[h]=i.useState([{id:1,name:"SportsEngine",icon:le,color:"#2563EB",connected:!0,hasIssue:!1},{id:2,name:"TeamSnap",icon:ve,color:"#7C3AED",connected:!0,hasIssue:!1}]),f=i.useMemo(()=>s.map(k=>k.id),[s]),u=i.useCallback(async()=>{if(f.length!==0)try{const{data:k,error:y}=await O.from("events").select("*").in("profile_id",f).order("start_time",{ascending:!0});if(y)throw y;const m=k.map(g=>{const p=s.find(x=>x.id===g.profile_id);return{...g,id:g.id,startTime:new Date(g.start_time),endTime:new Date(g.end_time),child:p,platformIcon:le,isToday:new Date(g.start_time).toDateString()===new Date().toDateString(),isOwnEvent:!0}});r(m)}catch(k){console.error("❌ DASHBOARD: Error fetching own events:",k)}},[f,s]),v=i.useCallback(async k=>{try{console.log("🔍 DASHBOARD: Fetching friends events for user:",k);const{data:y,error:m}=await O.from("friendships").select("friend_id, role").eq("user_id",k).in("role",["viewer","administrator"]);if(m){console.error("❌ DASHBOARD: Error fetching friendships:",m);return}if(!y||y.length===0){console.log("❌ DASHBOARD: No friendships with viewer/admin access found"),a([]),l([]);return}const g=y.map(R=>R.friend_id);console.log("👥 DASHBOARD: Friend user IDs:",g);const[p,x]=await Promise.all([O.from("user_settings").select("user_id, full_name, profile_photo_url").in("user_id",g),O.from("profiles").select("id, name, user_id").in("user_id",g)]);if(p.error){console.error("❌ DASHBOARD: Error fetching user settings:",p.error);return}if(x.error){console.error("❌ DASHBOARD: Error fetching friend profiles:",x.error);return}const{data:C}=p,{data:L}=x;if(!L||L.length===0){console.log("❌ DASHBOARD: No friend profiles found"),a([]),l([]);return}const _=L.map(R=>{const q=y.find(G=>G.friend_id===R.user_id),z=C==null?void 0:C.find(G=>G.user_id===R.user_id);return{...R,age:0,color:"#64748B",photo_url:null,sports:[],eventCount:0,ownerName:(z==null?void 0:z.full_name)||"Friend",ownerPhoto:z==null?void 0:z.profile_photo_url,accessRole:q==null?void 0:q.role}});l(_);const A=L.map(R=>R.id);if(A.length>0){const{data:R,error:q}=await O.from("events").select("*").in("profile_id",A).order("start_time",{ascending:!0});if(q){console.error("❌ DASHBOARD: Error fetching friend events:",q);return}const z=R.map(G=>{const Y=_.find(T=>T.id===G.profile_id);return{...G,id:G.id,startTime:new Date(G.start_time),endTime:new Date(G.end_time),child:Y,platformIcon:le,isToday:new Date(G.start_time).toDateString()===new Date().toDateString(),isOwnEvent:!1,ownerName:Y==null?void 0:Y.ownerName}});a(z),console.log("✅ DASHBOARD: Successfully loaded friends events:",z.length)}}catch(y){console.error("💥 DASHBOARD: Error fetching friends events:",y)}},[]);i.useEffect(()=>{let k=!0;return(async()=>{try{const{data:{user:m},error:g}=await O.auth.getUser();if(g)throw g;if(!m||!k)return;await u(),await v(m.id)}catch(m){console.error("❌ DASHBOARD: Error in main fetch:",m)}finally{k&&c(!1)}})(),()=>{k=!1}},[u,v]);const N=[...t,...n],b=N.filter(k=>k.startTime>=new Date).sort((k,y)=>k.startTime.getTime()-y.startTime.getTime()),E=[...s.map(k=>({...k,isOwnProfile:!0})),...o.map(k=>({...k,isOwnProfile:!1}))].map(k=>({...k,eventCount:N.filter(y=>y.child.id===k.id&&y.startTime>=new Date&&y.startTime<=new Date(new Date().setDate(new Date().getDate()+7))).length}));return d?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"}),e.jsx("div",{className:"text-sm text-gray-500",children:new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-5 sm:px-6 flex justify-between items-center bg-gradient-to-r from-blue-500 to-blue-600",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(le,{className:"h-5 w-5 text-white mr-2"}),e.jsx("h2",{className:"text-lg font-medium text-white",children:"Today's Schedule"})]}),e.jsxs("span",{className:"text-white text-sm font-medium",children:[b.filter(k=>k.isToday).length," Events"]})]}),e.jsx("div",{className:"divide-y divide-gray-200",children:b.filter(k=>k.isToday).length>0?b.filter(k=>k.isToday).map(k=>e.jsxs("div",{className:"relative",children:[!k.isOwnEvent&&e.jsxs("div",{className:"absolute top-2 right-2 bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full z-10",children:[k.ownerName,"'s schedule"]}),e.jsx(Qr,{event:k})]},`${k.isOwnEvent?"own":"friend"}-${k.id}`)):e.jsxs("div",{className:"flex flex-col items-center justify-center p-6 text-center",children:[e.jsx(Fe,{className:"h-12 w-12 text-gray-300 mb-2"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No events scheduled for today"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Enjoy your free time!"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsxs("div",{className:"px-4 py-5 sm:px-6 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ve,{className:"h-5 w-5 text-gray-500 mr-2"}),e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Children's Activities"})]}),e.jsxs("a",{href:"/profiles",className:"text-sm font-medium text-blue-600 hover:text-blue-500 flex items-center",children:["View all ",e.jsx(Ft,{className:"ml-1 h-4 w-4"})]})]}),e.jsxs("div",{className:"px-4 py-5 sm:px-6 space-y-4",children:[E.filter(k=>k.isOwnProfile).map(k=>e.jsx(_o,{child:k},k.id)),E.filter(k=>!k.isOwnProfile).length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border-t border-gray-200 pt-4",children:e.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center",children:[e.jsx(ve,{className:"h-4 w-4 mr-1"}),"Friends' Children (",E.filter(k=>!k.isOwnProfile).length,")"]})}),E.filter(k=>!k.isOwnProfile).map(k=>e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex items-center space-x-4 p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"h-10 w-10 rounded-full flex items-center justify-center text-white font-bold",style:{backgroundColor:k.color},children:k.photo_url?e.jsx("img",{src:k.photo_url,alt:k.name,className:"h-full w-full rounded-full object-cover"}):k.name.charAt(0)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:k.name}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("span",{className:"text-xs text-blue-600 bg-blue-100 px-2 py-0.5 rounded-full mr-2",children:k.ownerName}),e.jsxs("span",{className:"text-xs text-gray-500",children:[k.accessRole==="administrator"?"👑 Admin":"👁️ Viewer"," access"]})]}),e.jsx("div",{className:"flex items-center mt-1",children:k.sports.map((y,m)=>e.jsxs("div",{className:"flex items-center text-xs mr-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full mr-1",style:{backgroundColor:y.color}}),e.jsx("span",{className:"text-gray-500",children:y.name})]},m))})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:k.eventCount}),e.jsx("div",{className:"text-xs text-gray-500",children:"This week"})]})]})},k.id))]}),E.length===0&&e.jsx("div",{className:"text-center py-4 text-gray-500",children:"No children profiles found. Add a profile to get started."})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsxs("div",{className:"px-4 py-5 sm:px-6 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(le,{className:"h-5 w-5 text-gray-500 mr-2"}),e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Connected Platforms"})]}),e.jsxs("a",{href:"/connections",className:"text-sm font-medium text-blue-600 hover:text-blue-500 flex items-center",children:["Manage ",e.jsx(Ft,{className:"ml-1 h-4 w-4"})]})]}),e.jsx("div",{className:"px-4 py-5 sm:px-6 space-y-4",children:h.map(k=>e.jsx(Mo,{platform:k},k.id))})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-5 sm:px-6 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(le,{className:"h-5 w-5 text-gray-500 mr-2"}),e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Upcoming Events"})]}),e.jsxs("a",{href:"/calendar",className:"text-sm font-medium text-blue-600 hover:text-blue-500 flex items-center",children:["View calendar ",e.jsx(Ft,{className:"ml-1 h-4 w-4"})]})]}),e.jsxs("div",{className:"divide-y divide-gray-200",children:[b.filter(k=>!k.isToday).slice(0,8).map(k=>e.jsxs("div",{className:"relative",children:[!k.isOwnEvent&&e.jsxs("div",{className:"absolute top-2 right-2 bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full z-10",children:[k.ownerName,"'s schedule"]}),e.jsx(Qr,{event:k})]},`${k.isOwnEvent?"own":"friend"}-${k.id}`)),b.filter(k=>!k.isToday).length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No upcoming events scheduled."})]})]})]})},Oo=({view:s})=>{const t=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"grid grid-cols-7 text-center",children:t.map((r,n)=>e.jsx("div",{className:"py-2 px-1 text-sm font-medium text-gray-500",children:r},n))})})},ts=({currentDate:s,events:t})=>{const[r,n]=i.useState(null),a=(m,g)=>new Date(m,g+1,0).getDate(),o=(m,g)=>new Date(m,g,1).getDay(),l=s.getFullYear(),d=s.getMonth(),c=new Date,h=a(l,d),f=o(l,d),u=d===0?11:d-1,v=d===0?l-1:l,N=a(v,u),b=[];for(let m=0;m<f;m++)b.push({date:new Date(v,u,N-f+m+1),isCurrentMonth:!1});for(let m=1;m<=h;m++)b.push({date:new Date(l,d,m),isCurrentMonth:!0});const S=42-b.length,E=d===11?0:d+1,k=d===11?l+1:l;for(let m=1;m<=S;m++)b.push({date:new Date(k,E,m),isCurrentMonth:!1});const y={};return t.forEach(m=>{const g=m.startTime.toISOString().split("T")[0];y[g]||(y[g]=[]),y[g].push(m)}),e.jsxs("div",{className:"grid grid-cols-7 h-full border-b border-gray-200",children:[b.map((m,g)=>{const p=m.date.toISOString().split("T")[0],x=y[p]||[],C=c.getDate()===m.date.getDate()&&c.getMonth()===m.date.getMonth()&&c.getFullYear()===m.date.getFullYear();return e.jsxs("div",{className:`min-h-[100px] border-r border-t border-gray-200 p-1 ${m.isCurrentMonth?"":"bg-gray-50"}`,children:[e.jsx("div",{className:"flex justify-between items-start",children:e.jsx("span",{className:`text-sm font-medium h-6 w-6 flex items-center justify-center rounded-full ${C?"bg-blue-600 text-white":m.isCurrentMonth?"text-gray-900":"text-gray-400"}`,children:m.date.getDate()})}),e.jsxs("div",{className:"mt-1 max-h-[80px] overflow-y-auto space-y-1",children:[x.slice(0,3).map((L,_)=>e.jsxs("div",{className:"text-xs px-1 py-0.5 rounded truncate flex items-center cursor-pointer relative",style:{backgroundColor:L.color+"20",color:L.color},onClick:()=>n(L),children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full mr-1 flex-shrink-0",style:{backgroundColor:L.child.color}}),e.jsx("span",{className:"truncate flex-1",children:L.title}),!L.isOwnEvent&&e.jsx("span",{className:"ml-1 text-xs opacity-75",children:"👥"})]},`${L.isOwnEvent?"own":"friend"}-${L.id}-${_}`)),x.length>3&&e.jsxs("div",{className:"text-xs text-gray-500 px-1",children:["+",x.length-3," more"]})]})]},g)}),r&&e.jsx(Ze,{event:r,onClose:()=>n(null)})]})},Hn=({currentDate:s,events:t})=>{const[r,n]=i.useState(null),o=(u=>{const v=u.getDay(),N=u.getDate()-v;return new Date(u.setDate(N))})(new Date(s)),l=Array.from({length:7},(u,v)=>{const N=new Date(o);return N.setDate(o.getDate()+v),N}),d=new Date,c=u=>u.getDate()===d.getDate()&&u.getMonth()===d.getMonth()&&u.getFullYear()===d.getFullYear(),h={};t.forEach(u=>{const v=u.startTime.toISOString().split("T")[0];h[v]||(h[v]=[]),h[v].push(u)});const f=Array.from({length:24},(u,v)=>v);return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-20 flex-shrink-0"}),e.jsx("div",{className:"flex-1 grid grid-cols-7",children:l.map((u,v)=>e.jsxs("div",{className:"px-2 py-3 text-center border-r border-gray-200",children:[e.jsx("div",{className:`text-sm font-medium ${c(u)?"text-blue-600":"text-gray-500"}`,children:u.toLocaleDateString("en-US",{weekday:"short"})}),e.jsx("div",{className:`text-lg font-semibold ${c(u)?"text-white bg-blue-600 rounded-full w-8 h-8 flex items-center justify-center mx-auto":"text-gray-900"}`,children:u.getDate()})]},v))})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"flex h-full",children:[e.jsx("div",{className:"w-20 flex-shrink-0 border-r border-gray-200",children:f.map(u=>e.jsx("div",{className:"h-12 text-xs text-gray-500 text-right pr-2",style:{marginTop:u===0?"0":"-8px"},children:u===0?"":`${u%12===0?"12":u%12}${u<12?"am":"pm"}`},u))}),e.jsxs("div",{className:"flex-1 grid grid-cols-7 relative",children:[f.map(u=>e.jsxs(Me.Fragment,{children:[e.jsx("div",{className:"absolute w-full border-t border-gray-200",style:{top:`${u*48}px`}}),e.jsx("div",{className:"absolute w-full border-t border-gray-200 border-dashed opacity-50",style:{top:`${u*48+24}px`}})]},u)),l.map((u,v)=>{const N=u.toISOString().split("T")[0],b=h[N]||[];return e.jsx("div",{className:"h-full border-r border-gray-200 relative",children:b.map((S,E)=>{const k=S.startTime.getHours()+S.startTime.getMinutes()/60,m=S.endTime.getHours()+S.endTime.getMinutes()/60-k;return e.jsx("div",{className:"absolute left-1 right-1 rounded overflow-hidden text-xs shadow-sm cursor-pointer",style:{top:`${k*48}px`,height:`${m*48}px`,backgroundColor:S.color+"20",borderLeft:`3px solid ${S.color}`},onClick:()=>n(S),children:e.jsxs("div",{className:"p-1 h-full overflow-hidden",children:[e.jsxs("div",{className:"font-medium flex items-center",style:{color:S.color},children:[e.jsx("span",{className:"truncate flex-1",children:S.title}),!S.isOwnEvent&&e.jsx("span",{className:"ml-1 text-xs opacity-75",children:"👥"})]}),e.jsxs("div",{className:"text-gray-600 text-xs mt-0.5",children:[S.startTime.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})," -",S.endTime.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})]}),m>.75&&e.jsxs("div",{className:"text-gray-600 text-xs mt-0.5 flex items-center",children:[e.jsx("span",{className:"w-2 h-2 rounded-full mr-1",style:{backgroundColor:S.child.color}}),e.jsxs("span",{className:"truncate",children:[S.child.name,!S.isOwnEvent&&S.ownerName&&e.jsxs("span",{className:"text-blue-600",children:[" (",S.ownerName,")"]})]})]})]})},`${S.isOwnEvent?"own":"friend"}-${S.id}-${E}`)})},v)}),e.jsx("div",{className:"absolute w-full border-t-2 border-red-500 z-10",style:{top:`${(d.getHours()+d.getMinutes()/60)*48}px`,left:0,right:0},children:e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 relative -top-1 -left-1"})})]})]})}),r&&e.jsx(Ze,{event:r,onClose:()=>n(null)})]})},Vn=({currentDate:s,events:t})=>{const[r,n]=i.useState(null),a=new Date,o=s.getDate()===a.getDate()&&s.getMonth()===a.getMonth()&&s.getFullYear()===a.getFullYear(),l=t.filter(c=>{const h=c.startTime;return h.getDate()===s.getDate()&&h.getMonth()===s.getMonth()&&h.getFullYear()===s.getFullYear()});l.sort((c,h)=>c.startTime.getTime()-h.startTime.getTime());const d=Array.from({length:24},(c,h)=>h);return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-20 flex-shrink-0"}),e.jsx("div",{className:"flex-1 px-4 py-3",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-gray-500",children:s.toLocaleDateString("en-US",{weekday:"long"})}),e.jsx("div",{className:`inline-flex items-center justify-center ${o?"text-blue-600":"text-gray-900"}`,children:e.jsx("span",{className:`text-2xl font-bold ${o?"bg-blue-600 text-white w-10 h-10 rounded-full flex items-center justify-center":""}`,children:s.getDate()})})]})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"flex h-full",children:[e.jsx("div",{className:"w-20 flex-shrink-0 border-r border-gray-200",children:d.map(c=>e.jsx("div",{className:"h-12 text-xs text-gray-500 text-right pr-2",style:{marginTop:c===0?"0":"-8px"},children:c===0?"":`${c%12===0?"12":c%12}${c<12?"am":"pm"}`},c))}),e.jsxs("div",{className:"flex-1 relative",children:[d.map(c=>e.jsxs(Me.Fragment,{children:[e.jsx("div",{className:"absolute w-full border-t border-gray-200",style:{top:`${c*48}px`}}),e.jsx("div",{className:"absolute w-full border-t border-gray-200 border-dashed opacity-50",style:{top:`${c*48+24}px`}})]},c)),l.map((c,h)=>{const f=c.startTime.getHours()+c.startTime.getMinutes()/60,v=c.endTime.getHours()+c.endTime.getMinutes()/60-f;return e.jsx("div",{className:"absolute left-2 right-2 rounded overflow-hidden shadow-sm cursor-pointer",style:{top:`${f*48}px`,height:`${v*48}px`,backgroundColor:c.color+"20",borderLeft:`3px solid ${c.color}`},onClick:()=>n(c),children:e.jsxs("div",{className:"p-2 h-full overflow-hidden",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:c.child.color}}),e.jsx("span",{className:"text-sm font-medium flex-1 truncate",style:{color:c.color},children:c.title}),!c.isOwnEvent&&e.jsx("span",{className:"ml-1 text-xs opacity-75",children:"👥"})]}),e.jsxs("div",{className:"text-gray-600 text-xs mt-1",children:[c.startTime.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})," -",c.endTime.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})]}),v>.75&&c.location&&e.jsxs("div",{className:"text-gray-600 text-xs mt-1 flex items-center",children:[e.jsx(at,{className:"h-3 w-3 mr-1"}),e.jsx("span",{className:"truncate",children:c.location})]}),v>1.5&&e.jsxs("div",{className:"mt-1 text-xs text-gray-600",children:[e.jsx("div",{className:"flex items-center",children:e.jsxs("span",{className:"truncate",children:[c.child.name,!c.isOwnEvent&&c.ownerName&&e.jsxs("span",{className:"text-blue-600",children:[" (",c.ownerName,")"]})]})}),c.description&&e.jsx("div",{className:"mt-1 truncate",children:c.description})]})]})},`${c.isOwnEvent?"own":"friend"}-${c.id}-${h}`)}),o&&e.jsx("div",{className:"absolute w-full border-t-2 border-red-500 z-10",style:{top:`${(a.getHours()+a.getMinutes()/60)*48}px`,left:0,right:0},children:e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 relative -top-1 -left-1"})})]})]})}),r&&e.jsx(Ze,{event:r,onClose:()=>n(null)})]})},Wn=({currentDate:s,events:t})=>{const[r,n]=i.useState(null),a=new Date(s.getFullYear(),s.getMonth(),1),o=new Date(s.getFullYear(),s.getMonth()+1,0),l=t.filter(f=>{const u=f.startTime;return u>=a&&u<=o});l.sort((f,u)=>f.startTime.getTime()-u.startTime.getTime());const d={};l.forEach(f=>{const u=f.startTime.toISOString().split("T")[0];d[u]||(d[u]=[]),d[u].push(f)});const c=Object.keys(d).sort(),h=new Date().toISOString().split("T")[0];return e.jsxs("div",{className:"divide-y divide-gray-200",children:[c.length>0?c.map(f=>{const u=new Date(f),v=f===h;return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx(le,{className:"h-5 w-5 text-gray-400 mr-2"}),e.jsxs("h3",{className:`text-base font-medium ${v?"text-blue-600":"text-gray-900"}`,children:[u.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"}),v&&e.jsx("span",{className:"ml-2 text-xs bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full",children:"Today"})]})]}),e.jsx("div",{className:"space-y-3",children:d[f].map((N,b)=>e.jsx("div",{className:"bg-white border rounded-lg overflow-hidden hover:shadow-md transition-shadow cursor-pointer",onClick:()=>n(N),children:e.jsx("div",{className:"flex border-l-4 h-full",style:{borderColor:N.color},children:e.jsxs("div",{className:"p-3 flex-1",children:[e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx("span",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:N.child.color}}),e.jsxs("span",{className:"text-sm text-gray-500",children:[N.child.name,!N.isOwnEvent&&N.ownerName&&e.jsxs("span",{className:"text-blue-600",children:[" (",N.ownerName,")"]})]}),e.jsx("span",{className:"ml-2 text-xs px-2 py-0.5 rounded-full",style:{backgroundColor:N.platformColor+"20",color:N.platformColor},children:N.platform}),!N.isOwnEvent&&e.jsx("span",{className:"ml-2 text-xs bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full",children:"👥 Friend's Event"})]}),e.jsx("h4",{className:"text-base font-medium text-gray-900",children:N.title}),e.jsxs("div",{className:"mt-2 flex flex-col sm:flex-row sm:space-x-4",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(Fe,{className:"h-4 w-4 mr-1"}),N.startTime.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})," -",N.endTime.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})]}),N.location&&e.jsxs("div",{className:"flex items-center text-sm text-gray-500 mt-1 sm:mt-0",children:[e.jsx(at,{className:"h-4 w-4 mr-1"}),N.location]})]}),N.description&&e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:N.description})]})})},`${N.isOwnEvent?"own":"friend"}-${N.id}-${b}`))})]},f)}):e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(le,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No events this month"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Try changing your filters or adding new connections"})]}),r&&e.jsx(Ze,{event:r,onClose:()=>n(null)})]})},Do=()=>{const{profiles:s}=Ue(),[t,r]=i.useState([]),[n,a]=i.useState([]),[o,l]=i.useState([]),[d,c]=i.useState(!0),[h,f]=i.useState(new Date),[u,v]=i.useState("month"),[N,b]=i.useState(!1),[S,E]=i.useState([]),[k,y]=i.useState([]),[m,g]=i.useState(["game","practice","tournament","other"]),[p,x]=i.useState(!0),C=i.useMemo(()=>s.map(T=>T.id),[s]),L=i.useCallback(async()=>{if(C.length!==0)try{const{data:T,error:V}=await O.from("events").select("*").in("profile_id",C).order("start_time",{ascending:!0});if(V)throw V;const P=T.map(M=>{const D=s.find(F=>F.id===M.profile_id);return{...M,id:M.id,startTime:new Date(M.start_time),endTime:new Date(M.end_time),child:D,platformIcon:le,isToday:new Date(M.start_time).toDateString()===new Date().toDateString(),isOwnEvent:!0}});r(P)}catch(T){console.error("❌ CALENDAR: Error fetching own events:",T)}},[C,s]),_=i.useCallback(async T=>{if(!p){a([]),l([]);return}try{console.log("🔍 CALENDAR: Fetching friends events for user:",T);const{data:V,error:P}=await O.from("friendships").select("friend_id, role").eq("user_id",T).in("role",["viewer","administrator"]);if(P){console.error("❌ CALENDAR: Error fetching friendships:",P);return}if(!V||V.length===0){console.log("❌ CALENDAR: No friendships with viewer/admin access found"),a([]),l([]);return}const M=V.map(U=>U.friend_id);console.log("👥 CALENDAR: Friend user IDs:",M);const[D,F]=await Promise.all([O.from("user_settings").select("user_id, full_name, profile_photo_url").in("user_id",M),O.from("profiles").select("id, name, user_id").in("user_id",M)]);if(D.error){console.error("❌ CALENDAR: Error fetching user settings:",D.error);return}if(F.error){console.error("❌ CALENDAR: Error fetching friend profiles:",F.error);return}const{data:$}=D,{data:B}=F;if(!B||B.length===0){console.log("❌ CALENDAR: No friend profiles found"),a([]),l([]);return}const j=B.map(U=>{const H=V.find(X=>X.friend_id===U.user_id),W=$==null?void 0:$.find(X=>X.user_id===U.user_id);return{...U,age:0,color:"#64748B",photo_url:null,sports:[],eventCount:0,ownerName:(W==null?void 0:W.full_name)||"Friend",ownerPhoto:W==null?void 0:W.profile_photo_url,accessRole:H==null?void 0:H.role}});l(j);const w=B.map(U=>U.id);if(w.length>0){const{data:U,error:H}=await O.from("events").select("*").in("profile_id",w).order("start_time",{ascending:!0});if(H){console.error("❌ CALENDAR: Error fetching friend events:",H);return}const W=U.map(X=>{const J=j.find(ee=>ee.id===X.profile_id);return{...X,id:X.id,startTime:new Date(X.start_time),endTime:new Date(X.end_time),child:J,platformIcon:le,isToday:new Date(X.start_time).toDateString()===new Date().toDateString(),isOwnEvent:!1,ownerName:J==null?void 0:J.ownerName}});a(W),console.log("✅ CALENDAR: Successfully loaded friends events:",W.length)}}catch(V){console.error("💥 CALENDAR: Error fetching friends events:",V)}},[p]);i.useEffect(()=>{let T=!0;return(async()=>{try{const{data:{user:P},error:M}=await O.auth.getUser();if(M)throw M;if(!P||!T)return;await L(),await _(P.id)}catch(P){console.error("❌ CALENDAR: Error in main fetch:",P)}finally{T&&c(!1)}})(),()=>{T=!1}},[L,_]),i.useEffect(()=>{const T=[...s.map(V=>V.id),...o.map(V=>V.id)];E(T)},[s,o]);const A=()=>{const T=new Date(h);switch(u){case"month":T.setMonth(T.getMonth()-1);break;case"week":T.setDate(T.getDate()-7);break;case"day":T.setDate(T.getDate()-1);break}f(T)},R=()=>{const T=new Date(h);switch(u){case"month":T.setMonth(T.getMonth()+1);break;case"week":T.setDate(T.getDate()+7);break;case"day":T.setDate(T.getDate()+1);break}f(T)},q=()=>{f(new Date)},z=()=>{const T={year:"numeric"};switch(u){case"month":T.month="long";break;case"week":T.month="short",T.day="numeric";const V=new Date(h);return V.setDate(h.getDate()+6),`${h.toLocaleDateString("en-US",{month:"short",day:"numeric"})} - ${V.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`;case"day":T.weekday="long",T.month="long",T.day="numeric";break}return h.toLocaleDateString("en-US",T)},G=()=>{const V=[...t,...n].filter(P=>!(k.length>0&&!k.includes(P.platform)));switch(u){case"month":return e.jsx(ts,{currentDate:h,events:V});case"week":return e.jsx(Hn,{currentDate:h,events:V});case"day":return e.jsx(Vn,{currentDate:h,events:V});case"agenda":return e.jsx(Wn,{currentDate:h,events:V})}},Y=[...s.map(T=>({...T,isOwnProfile:!0})),...o.map(T=>({...T,isOwnProfile:!1}))];return d?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mr-4",children:"Calendar"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:A,className:"p-1 rounded-full hover:bg-gray-100",children:e.jsx(pn,{className:"h-5 w-5 text-gray-500"})}),e.jsx("button",{onClick:q,className:"px-3 py-1 text-sm bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Today"}),e.jsx("button",{onClick:R,className:"p-1 rounded-full hover:bg-gray-100",children:e.jsx(xn,{className:"h-5 w-5 text-gray-500"})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-700 ml-2",children:z()})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"bg-white border border-gray-300 rounded-md p-1 flex",children:[e.jsx("button",{onClick:()=>v("month"),className:`p-1 rounded ${u==="month"?"bg-blue-100 text-blue-600":"text-gray-500 hover:bg-gray-100"}`,title:"Month view",children:e.jsx(le,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>v("week"),className:`p-1 rounded ${u==="week"?"bg-blue-100 text-blue-600":"text-gray-500 hover:bg-gray-100"}`,title:"Week view",children:e.jsx(ja,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>v("day"),className:`p-1 rounded ${u==="day"?"bg-blue-100 text-blue-600":"text-gray-500 hover:bg-gray-100"}`,title:"Day view",children:e.jsxs("div",{className:"w-5 h-5 flex flex-col justify-center items-center",children:[e.jsx("div",{className:"w-4 h-0.5 bg-current mb-0.5"}),e.jsx("div",{className:"w-4 h-0.5 bg-current mb-0.5"}),e.jsx("div",{className:"w-4 h-0.5 bg-current"})]})}),e.jsx("button",{onClick:()=>v("agenda"),className:`p-1 rounded ${u==="agenda"?"bg-blue-100 text-blue-600":"text-gray-500 hover:bg-gray-100"}`,title:"List view",children:e.jsx(bn,{className:"h-5 w-5"})})]}),e.jsxs("button",{onClick:()=>b(!N),className:"flex items-center px-3 py-1.5 bg-white border border-gray-300 rounded-md hover:bg-gray-50 text-sm",children:[e.jsx(vn,{className:"h-4 w-4 mr-1"}),"Filter"]})]})]}),N&&e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md mb-4 grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Your Children"}),e.jsx("div",{className:"space-y-2",children:Y.filter(T=>T.isOwnProfile).map(T=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:`child-${T.id}`,type:"checkbox",checked:S.includes(T.id),onChange:V=>{V.target.checked?E([...S,T.id]):E(S.filter(P=>P!==T.id))},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsxs("label",{htmlFor:`child-${T.id}`,className:"ml-2 text-sm text-gray-700 flex items-center",children:[e.jsx("span",{className:"w-3 h-3 rounded-full mr-1.5",style:{backgroundColor:T.color}}),T.name]})]},T.id))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Friends' Children"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("input",{id:"show-friends-events",type:"checkbox",checked:p,onChange:T=>x(T.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"show-friends-events",className:"ml-2 text-sm font-medium text-gray-700",children:"Show friends' events"})]}),p&&Y.filter(T=>!T.isOwnProfile).map(T=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:`friend-child-${T.id}`,type:"checkbox",checked:S.includes(T.id),onChange:V=>{V.target.checked?E([...S,T.id]):E(S.filter(P=>P!==T.id))},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsxs("label",{htmlFor:`friend-child-${T.id}`,className:"ml-2 text-sm text-gray-700 flex items-center",children:[e.jsx("span",{className:"w-3 h-3 rounded-full mr-1.5",style:{backgroundColor:T.color}}),T.name,e.jsxs("span",{className:"ml-1 text-xs text-blue-600",children:["(",T.ownerName,")"]})]})]},T.id)),!p&&e.jsx("p",{className:"text-xs text-gray-500",children:"Enable to see friends' children"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Platforms"}),e.jsx("div",{className:"space-y-2",children:["SportsEngine","TeamSnap","Playmetrics","Manual"].map(T=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:`platform-${T}`,type:"checkbox",checked:k.length===0||k.includes(T),onChange:V=>{V.target.checked?y([...k,T]):y(k.filter(P=>P!==T))},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:`platform-${T}`,className:"ml-2 text-sm text-gray-700",children:T})]},T))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Activity Types"}),e.jsx("div",{className:"space-y-2",children:[{id:"game",label:"Games"},{id:"practice",label:"Practices"},{id:"tournament",label:"Tournaments"},{id:"other",label:"Other events"}].map(T=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:`type-${T.id}`,type:"checkbox",checked:m.includes(T.id),onChange:V=>{V.target.checked?g([...m,T.id]):g(m.filter(P=>P!==T.id))},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:`type-${T.id}`,className:"ml-2 text-sm text-gray-700",children:T.label})]},T.id))})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow flex-1 overflow-hidden",children:[u!=="agenda"&&e.jsx(Oo,{view:u}),e.jsx("div",{className:"flex-1 overflow-auto",children:G()})]})]})},To=()=>{const s=rs();je();const[t,r]=i.useState([]),[n,a]=i.useState(null),[o,l]=i.useState(1),[d,c]=i.useState(!0),[h,f]=i.useState(!1),u=[{id:1,name:"SportsEngine",icon:le,color:"#2563EB",connected:!1,hasIssue:!1},{id:2,name:"TeamSnap",icon:ve,color:"#7C3AED",connected:!1,hasIssue:!1},{id:3,name:"PlayMetrics",icon:is,color:"#10B981",connected:!1,hasIssue:!1},{id:4,name:"GameChanger",icon:wt,color:"#F97316",connected:!1,hasIssue:!1}];i.useEffect(()=>{var g;(async()=>{try{const{data:p,error:x}=await O.from("platform_teams").select("platform").limit(1e3);if(x)throw x;const C=[...new Set(p.map(_=>_.platform))],L=u.map(_=>({..._,connected:C.includes(_.name)}));r(L)}catch(p){console.error("Error fetching connected platforms:",p)}finally{c(!1)}})(),(g=s.state)!=null&&g.teamSnapConnected&&(f(!0),window.history.replaceState({},document.title),setTimeout(()=>f(!1),5e3))},[s]);const v=m=>{a(m),l(1)},N=async m=>{try{const g=t.find(p=>p.id===m);if(!g)return;await O.from("platform_teams").delete().eq("platform",g.name),r(p=>p.map(x=>x.id===m?{...x,connected:!1}:x)),a(null)}catch(g){console.error("Error disconnecting platform:",g)}},b=async m=>{console.log(`Refreshing platform ${m}`)},S=()=>{o<3?l(o+1):(a(null),l(1))},E=m=>{switch(m){case"SportsEngine":return["Access to team schedules and game information","Import practice times and locations","Get real-time updates for schedule changes","View coach announcements and team messages"];case"TeamSnap":return["Sync team availability and roster information","Import game and practice schedules","Receive automated notifications for changes","Access team photos and media"];case"PlayMetrics":return["Import practice plans and development goals","Track player performance and statistics","Access coach feedback and evaluations","Monitor skill development progress"];case"GameChanger":return["Sync game schedules and tournament information","Import statistics and game results","Access video highlights and replays","Receive live game updates"];default:return["Sync schedules and events automatically","Receive real-time updates for changes","Import all team information","Streamline your sports management"]}},k=m=>m.connected?m.hasIssue?e.jsxs("div",{className:"flex items-center text-yellow-600",children:[e.jsx(yt,{className:"h-5 w-5 mr-1"}),e.jsx("span",{children:"Connection issue"})]}):e.jsxs("div",{className:"flex items-center text-green-600",children:[e.jsx(fe,{className:"h-5 w-5 mr-1"}),e.jsx("span",{children:"Connected"})]}):e.jsxs("div",{className:"flex items-center text-gray-500",children:[e.jsx(Bt,{className:"h-5 w-5 mr-1"}),e.jsx("span",{children:"Not connected"})]}),y=()=>{if(n===null)return null;const m=t.find(g=>g.id===n);return m?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-auto",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg flex items-center justify-center mr-3",style:{backgroundColor:m.color+"20",color:m.color},children:e.jsx(m.icon,{className:"h-6 w-6"})}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[m.connected?"Manage":"Connect to"," ",m.name]})]}),e.jsx("button",{className:"text-gray-500 hover:text-gray-700",onClick:()=>a(null),children:e.jsx(Bt,{className:"h-5 w-5"})})]}),m.connected?e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center text-green-600 mb-2",children:[e.jsx(fe,{className:"h-5 w-5 mr-2"}),e.jsxs("span",{className:"font-medium",children:["Connected to ",m.name]})]}),e.jsxs("p",{className:"text-gray-600",children:["Your ",m.name," account is currently connected and syncing data to TeamSync."]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Connection Details"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Connected on"}),e.jsx("span",{className:"text-gray-900",children:"June 15, 2025"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Last synced"}),e.jsx("span",{className:"text-gray-900",children:"Today at 10:23 AM"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Status"}),e.jsx("span",{className:m.hasIssue?"text-yellow-600":"text-green-600",children:m.hasIssue?"Connection issue":"Active"})]})]})]}),e.jsxs("div",{className:"flex flex-col space-y-3",children:[e.jsxs("button",{className:"w-full py-2 px-4 rounded-md border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 flex items-center justify-center",onClick:()=>b(m.id),children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),"Refresh Connection"]}),e.jsxs("button",{className:"w-full py-2 px-4 rounded-md border border-red-300 bg-white text-red-600 hover:bg-red-50 flex items-center justify-center",onClick:()=>N(m.id),children:[e.jsx(Bt,{className:"h-4 w-4 mr-2"}),"Disconnect"]})]})]}):e.jsxs("div",{className:"p-6",children:[o===1&&e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-2",children:["Connect to ",m.name]}),e.jsxs("p",{className:"text-gray-600",children:["Connecting to ",m.name," allows TeamSync to automatically import all your schedules, events, and team information."]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mb-6",children:[e.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Benefits"}),e.jsx("ul",{className:"space-y-2 text-sm text-blue-700",children:E(m.name).map((g,p)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx(fe,{className:"h-4 w-4 mr-2 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:g})]},p))})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"What you'll need"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"flex h-5 w-5 items-center justify-center rounded-full bg-blue-100 text-blue-600 text-xs mr-2 flex-shrink-0",children:"1"}),e.jsxs("span",{children:["An active ",m.name," account"]})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"flex h-5 w-5 items-center justify-center rounded-full bg-blue-100 text-blue-600 text-xs mr-2 flex-shrink-0",children:"2"}),e.jsx("span",{children:"Your login credentials"})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"flex h-5 w-5 items-center justify-center rounded-full bg-blue-100 text-blue-600 text-xs mr-2 flex-shrink-0",children:"3"}),e.jsx("span",{children:"Permission to access your team data"})]})]})]}),e.jsx("button",{className:"w-full py-2 px-4 rounded-md bg-blue-600 text-white hover:bg-blue-700 flex items-center justify-center",onClick:S,children:"Continue"})]}),o===2&&e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-2",children:["Sign in to ",m.name]}),e.jsxs("p",{className:"text-gray-600",children:["You'll be redirected to ",m.name," to authorize TeamSync to access your account."]})]}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",id:"email",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your email"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),e.jsx("input",{type:"password",id:"password",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your password"})]})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-500 mb-6",children:[e.jsx(jt,{className:"h-4 w-4 mr-2"}),e.jsxs("span",{children:["Your credentials are securely transmitted to ",m.name]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{className:"flex-1 py-2 px-4 rounded-md border border-gray-300 bg-white text-gray-700 hover:bg-gray-50",onClick:()=>l(1),children:"Back"}),e.jsx("button",{className:"flex-1 py-2 px-4 rounded-md bg-blue-600 text-white hover:bg-blue-700",onClick:S,children:"Authorize"})]})]}),o===3&&e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-6",children:[e.jsx("div",{className:"h-16 w-16 rounded-full flex items-center justify-center mb-4",style:{backgroundColor:m.color+"20",color:m.color},children:e.jsx(fe,{className:"h-10 w-10"})}),e.jsx("h4",{className:"text-xl font-medium text-gray-900 mb-2",children:"Connection Successful!"}),e.jsxs("p",{className:"text-gray-600 text-center mb-6",children:["Your ",m.name," account has been successfully connected to TeamSync."]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg w-full mb-6",children:[e.jsx("h5",{className:"font-medium text-green-800 mb-2",children:"What's Next"}),e.jsxs("ul",{className:"space-y-2 text-sm text-green-700",children:[e.jsxs("li",{className:"flex items-start",children:[e.jsx(fe,{className:"h-4 w-4 mr-2 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:"Your events are being imported (this may take a few minutes)"})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx(fe,{className:"h-4 w-4 mr-2 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:"You'll receive notifications for any scheduling conflicts"})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx(fe,{className:"h-4 w-4 mr-2 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:"All future updates will sync automatically"})]})]})]}),e.jsx("button",{className:"w-full py-2 px-4 rounded-md bg-blue-600 text-white hover:bg-blue-700",onClick:S,children:"Done"})]})})]})]})}):null};return d?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{children:[h&&e.jsx("div",{className:"fixed top-4 right-4 bg-green-50 border border-green-200 text-green-800 rounded-lg p-4 shadow-lg z-50 animate-fade-in",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(fe,{className:"h-5 w-5 text-green-400 mr-2"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:"TeamSnap Connected Successfully!"}),e.jsx("p",{className:"text-sm",children:"Your teams have been synchronized."})]}),e.jsx("button",{onClick:()=>f(!1),className:"ml-4 text-green-400 hover:text-green-500",children:e.jsx(he,{className:"h-5 w-5"})})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2 sm:mb-0",children:"Connections"}),e.jsxs("button",{className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"}),"Add New Connection"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden mb-8",children:[e.jsxs("div",{className:"px-4 py-5 sm:px-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Connected Platforms"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Manage your connections to sports platforms and services"})]}),e.jsxs("div",{className:"divide-y divide-gray-200",children:[t.filter(m=>m.connected).map(m=>e.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start",children:[e.jsx("div",{className:"h-12 w-12 rounded-lg flex items-center justify-center mb-4 sm:mb-0 sm:mr-4",style:{backgroundColor:m.color+"20",color:m.color},children:e.jsx(m.icon,{className:"h-6 w-6"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-2",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:m.name}),k(m)]}),e.jsx("p",{className:"text-gray-600 mb-4",children:m.hasIssue?`There is an issue with your ${m.name} connection. Please refresh or reconnect.`:`Your ${m.name} account is connected and syncing data to TeamSync.`}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx("button",{className:"inline-flex items-center px-3 py-1.5 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",onClick:()=>v(m.id),children:"Manage"}),e.jsxs("button",{className:"inline-flex items-center px-3 py-1.5 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",onClick:()=>b(m.id),children:[e.jsx(Ce,{className:"h-4 w-4 mr-1.5"}),"Refresh"]}),m.hasIssue&&e.jsxs("div",{className:"bg-yellow-100 text-yellow-800 text-xs px-2.5 py-1.5 rounded-full flex items-center",children:[e.jsx(yt,{className:"h-3.5 w-3.5 mr-1"}),"Connection issue"]})]})]})]})},m.id)),t.filter(m=>m.connected).length===0&&e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"mx-auto h-12 w-12 rounded-full bg-blue-100 flex items-center justify-center mb-4",children:e.jsx(wt,{className:"h-6 w-6 text-blue-600"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No platforms connected"}),e.jsx("p",{className:"mt-1 text-gray-500",children:"Connect to your sports platforms to start syncing data"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-5 sm:px-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Available Platforms"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Connect to additional sports platforms to import your schedules and events"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 p-6",children:[t.filter(m=>!m.connected).map(m=>e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"p-4 border-b",style:{backgroundColor:m.color+"10"},children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg flex items-center justify-center mr-3",style:{backgroundColor:m.color+"20",color:m.color},children:e.jsx(m.icon,{className:"h-5 w-5"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:m.name})]})})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Connect to ",m.name," to import your schedules, events, and team information."]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("a",{href:"#",className:"text-sm text-blue-600 hover:text-blue-700 flex items-center",onClick:g=>g.preventDefault(),children:["Learn more",e.jsx(ya,{className:"h-3.5 w-3.5 ml-1"})]}),e.jsx("button",{className:"inline-flex items-center px-3 py-1.5 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",onClick:()=>v(m.id),children:"Connect"})]})]})]},m.id)),t.filter(m=>!m.connected).length===0&&e.jsxs("div",{className:"col-span-full p-8 text-center",children:[e.jsx("div",{className:"mx-auto h-12 w-12 rounded-full bg-green-100 flex items-center justify-center mb-4",children:e.jsx(fe,{className:"h-6 w-6 text-green-600"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"All platforms connected!"}),e.jsx("p",{className:"mt-1 text-gray-500",children:"You've connected all available platforms"})]})]})]}),y()]})};var Gn={exports:{}};function Ao(s){throw new Error('Could not dynamically require "'+s+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Wt={exports:{}};const Io={},Ro=Object.freeze(Object.defineProperty({__proto__:null,default:Io},Symbol.toStringTag,{value:"Module"})),Fo=na(Ro);var Xr;function fs(){return Xr||(Xr=1,function(s,t){(function(r,n){s.exports=n()})(Ae,function(){var r=r||function(n,a){var o;if(typeof window<"u"&&window.crypto&&(o=window.crypto),typeof self<"u"&&self.crypto&&(o=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(o=globalThis.crypto),!o&&typeof window<"u"&&window.msCrypto&&(o=window.msCrypto),!o&&typeof Ae<"u"&&Ae.crypto&&(o=Ae.crypto),!o&&typeof Ao=="function")try{o=Fo}catch{}var l=function(){if(o){if(typeof o.getRandomValues=="function")try{return o.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof o.randomBytes=="function")try{return o.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},d=Object.create||function(){function y(){}return function(m){var g;return y.prototype=m,g=new y,y.prototype=null,g}}(),c={},h=c.lib={},f=h.Base=function(){return{extend:function(y){var m=d(this);return y&&m.mixIn(y),(!m.hasOwnProperty("init")||this.init===m.init)&&(m.init=function(){m.$super.init.apply(this,arguments)}),m.init.prototype=m,m.$super=this,m},create:function(){var y=this.extend();return y.init.apply(y,arguments),y},init:function(){},mixIn:function(y){for(var m in y)y.hasOwnProperty(m)&&(this[m]=y[m]);y.hasOwnProperty("toString")&&(this.toString=y.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),u=h.WordArray=f.extend({init:function(y,m){y=this.words=y||[],m!=a?this.sigBytes=m:this.sigBytes=y.length*4},toString:function(y){return(y||N).stringify(this)},concat:function(y){var m=this.words,g=y.words,p=this.sigBytes,x=y.sigBytes;if(this.clamp(),p%4)for(var C=0;C<x;C++){var L=g[C>>>2]>>>24-C%4*8&255;m[p+C>>>2]|=L<<24-(p+C)%4*8}else for(var _=0;_<x;_+=4)m[p+_>>>2]=g[_>>>2];return this.sigBytes+=x,this},clamp:function(){var y=this.words,m=this.sigBytes;y[m>>>2]&=4294967295<<32-m%4*8,y.length=n.ceil(m/4)},clone:function(){var y=f.clone.call(this);return y.words=this.words.slice(0),y},random:function(y){for(var m=[],g=0;g<y;g+=4)m.push(l());return new u.init(m,y)}}),v=c.enc={},N=v.Hex={stringify:function(y){for(var m=y.words,g=y.sigBytes,p=[],x=0;x<g;x++){var C=m[x>>>2]>>>24-x%4*8&255;p.push((C>>>4).toString(16)),p.push((C&15).toString(16))}return p.join("")},parse:function(y){for(var m=y.length,g=[],p=0;p<m;p+=2)g[p>>>3]|=parseInt(y.substr(p,2),16)<<24-p%8*4;return new u.init(g,m/2)}},b=v.Latin1={stringify:function(y){for(var m=y.words,g=y.sigBytes,p=[],x=0;x<g;x++){var C=m[x>>>2]>>>24-x%4*8&255;p.push(String.fromCharCode(C))}return p.join("")},parse:function(y){for(var m=y.length,g=[],p=0;p<m;p++)g[p>>>2]|=(y.charCodeAt(p)&255)<<24-p%4*8;return new u.init(g,m)}},S=v.Utf8={stringify:function(y){try{return decodeURIComponent(escape(b.stringify(y)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(y){return b.parse(unescape(encodeURIComponent(y)))}},E=h.BufferedBlockAlgorithm=f.extend({reset:function(){this._data=new u.init,this._nDataBytes=0},_append:function(y){typeof y=="string"&&(y=S.parse(y)),this._data.concat(y),this._nDataBytes+=y.sigBytes},_process:function(y){var m,g=this._data,p=g.words,x=g.sigBytes,C=this.blockSize,L=C*4,_=x/L;y?_=n.ceil(_):_=n.max((_|0)-this._minBufferSize,0);var A=_*C,R=n.min(A*4,x);if(A){for(var q=0;q<A;q+=C)this._doProcessBlock(p,q);m=p.splice(0,A),g.sigBytes-=R}return new u.init(m,R)},clone:function(){var y=f.clone.call(this);return y._data=this._data.clone(),y},_minBufferSize:0});h.Hasher=E.extend({cfg:f.extend(),init:function(y){this.cfg=this.cfg.extend(y),this.reset()},reset:function(){E.reset.call(this),this._doReset()},update:function(y){return this._append(y),this._process(),this},finalize:function(y){y&&this._append(y);var m=this._doFinalize();return m},blockSize:16,_createHelper:function(y){return function(m,g){return new y.init(g).finalize(m)}},_createHmacHelper:function(y){return function(m,g){return new k.HMAC.init(y,g).finalize(m)}}});var k=c.algo={};return c}(Math);return r})}(Wt)),Wt.exports}(function(s,t){(function(r,n){s.exports=n(fs())})(Ae,function(r){return function(){if(typeof ArrayBuffer=="function"){var n=r,a=n.lib,o=a.WordArray,l=o.init,d=o.init=function(c){if(c instanceof ArrayBuffer&&(c=new Uint8Array(c)),(c instanceof Int8Array||typeof Uint8ClampedArray<"u"&&c instanceof Uint8ClampedArray||c instanceof Int16Array||c instanceof Uint16Array||c instanceof Int32Array||c instanceof Uint32Array||c instanceof Float32Array||c instanceof Float64Array)&&(c=new Uint8Array(c.buffer,c.byteOffset,c.byteLength)),c instanceof Uint8Array){for(var h=c.byteLength,f=[],u=0;u<h;u++)f[u>>>2]|=c[u]<<24-u%4*8;l.call(this,f,h)}else l.apply(this,arguments)};d.prototype=o}}(),r.lib.WordArray})})(Gn);var Uo=Gn.exports;const Bo=ns(Uo);var Zn={exports:{}};(function(s,t){(function(r,n){s.exports=n(fs())})(Ae,function(r){return function(n){var a=r,o=a.lib,l=o.WordArray,d=o.Hasher,c=a.algo,h=[],f=[];(function(){function N(k){for(var y=n.sqrt(k),m=2;m<=y;m++)if(!(k%m))return!1;return!0}function b(k){return(k-(k|0))*4294967296|0}for(var S=2,E=0;E<64;)N(S)&&(E<8&&(h[E]=b(n.pow(S,1/2))),f[E]=b(n.pow(S,1/3)),E++),S++})();var u=[],v=c.SHA256=d.extend({_doReset:function(){this._hash=new l.init(h.slice(0))},_doProcessBlock:function(N,b){for(var S=this._hash.words,E=S[0],k=S[1],y=S[2],m=S[3],g=S[4],p=S[5],x=S[6],C=S[7],L=0;L<64;L++){if(L<16)u[L]=N[b+L]|0;else{var _=u[L-15],A=(_<<25|_>>>7)^(_<<14|_>>>18)^_>>>3,R=u[L-2],q=(R<<15|R>>>17)^(R<<13|R>>>19)^R>>>10;u[L]=A+u[L-7]+q+u[L-16]}var z=g&p^~g&x,G=E&k^E&y^k&y,Y=(E<<30|E>>>2)^(E<<19|E>>>13)^(E<<10|E>>>22),T=(g<<26|g>>>6)^(g<<21|g>>>11)^(g<<7|g>>>25),V=C+T+z+f[L]+u[L],P=Y+G;C=x,x=p,p=g,g=m+V|0,m=y,y=k,k=E,E=V+P|0}S[0]=S[0]+E|0,S[1]=S[1]+k|0,S[2]=S[2]+y|0,S[3]=S[3]+m|0,S[4]=S[4]+g|0,S[5]=S[5]+p|0,S[6]=S[6]+x|0,S[7]=S[7]+C|0},_doFinalize:function(){var N=this._data,b=N.words,S=this._nDataBytes*8,E=N.sigBytes*8;return b[E>>>5]|=128<<24-E%32,b[(E+64>>>9<<4)+14]=n.floor(S/4294967296),b[(E+64>>>9<<4)+15]=S,N.sigBytes=b.length*4,this._process(),this._hash},clone:function(){var N=d.clone.call(this);return N._hash=this._hash.clone(),N}});a.SHA256=d._createHelper(v),a.HmacSHA256=d._createHmacHelper(v)}(Math),r.SHA256})})(Zn);var $o=Zn.exports;const qo=ns($o);var Kn={exports:{}};(function(s,t){(function(r,n){s.exports=n(fs())})(Ae,function(r){return function(){var n=r,a=n.lib,o=a.WordArray,l=n.enc;l.Base64url={stringify:function(c,h){h===void 0&&(h=!0);var f=c.words,u=c.sigBytes,v=h?this._safe_map:this._map;c.clamp();for(var N=[],b=0;b<u;b+=3)for(var S=f[b>>>2]>>>24-b%4*8&255,E=f[b+1>>>2]>>>24-(b+1)%4*8&255,k=f[b+2>>>2]>>>24-(b+2)%4*8&255,y=S<<16|E<<8|k,m=0;m<4&&b+m*.75<u;m++)N.push(v.charAt(y>>>6*(3-m)&63));var g=v.charAt(64);if(g)for(;N.length%4;)N.push(g);return N.join("")},parse:function(c,h){h===void 0&&(h=!0);var f=c.length,u=h?this._safe_map:this._map,v=this._reverseMap;if(!v){v=this._reverseMap=[];for(var N=0;N<u.length;N++)v[u.charCodeAt(N)]=N}var b=u.charAt(64);if(b){var S=c.indexOf(b);S!==-1&&(f=S)}return d(c,f,v)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function d(c,h,f){for(var u=[],v=0,N=0;N<h;N++)if(N%4){var b=f[c.charCodeAt(N-1)]<<N%4*2,S=f[c.charCodeAt(N)]>>>6-N%4*2,E=b|S;u[v>>>2]|=E<<24-v%4*8,v++}return o.create(u,v)}}(),r.enc.Base64url})})(Kn);var zo=Kn.exports;const Ho=ns(zo);function Vo(s){const t=new ArrayBuffer(4);return new DataView(t).setUint32(0,s,!1),t}function Wo(s){const t=Bo.random(s),r=[];return t.words.forEach(n=>{const a=Vo(n),o=new Uint8Array(a);for(let l=0;l<4;l++)r.push(o[l])}),r}function Go(s){const t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-._~";let r="";const n=Wo(s);for(let a=0;a<s;a++){const o=n[a]%t.length;r+=t[o]}return r}function Zo(s){return Go(s)}function Ko(s){return qo(s).toString(Ho)}function Yo(s){if(s||(s=43),s<43||s>128)throw`Expected a length between 43 and 128. Received ${s}.`;const t=Zo(s),r=Ko(t);return{code_verifier:t,code_challenge:r}}const Jo="https://auth.teamsnap.com/oauth/authorize",en="https://auth.teamsnap.com/oauth/token",Qo="https://api.teamsnap.com/v3";class Yn{constructor(t){Ye(this,"clientId");Ye(this,"redirectUri");Ye(this,"accessToken",null);Ye(this,"clientSecret","osTEt8nG9LVNoqEHX5GBw2FwxjBCYUijCLfo-H-ihaA");this.clientId=t.clientId,this.redirectUri=t.redirectUri}async initiateOAuth(){try{const t=Yo();localStorage.setItem("teamsnap_code_verifier",t.code_verifier);const r=new URLSearchParams({client_id:this.clientId,redirect_uri:this.redirectUri,response_type:"code",code_challenge:t.code_challenge,code_challenge_method:"S256",scope:"read write"}),n=`${Jo}?${r.toString()}`;return console.log("Authorization URL:",n),n}catch(t){throw console.error("Error initiating OAuth:",t),new Error("Failed to initiate OAuth flow")}}async handleCallback(t){try{if(!localStorage.getItem("teamsnap_code_verifier"))throw new Error("Code verifier not found");const n=new URLSearchParams({grant_type:"authorization_code",code:t,client_id:this.clientId,client_secret:this.clientSecret,redirect_uri:this.redirectUri}).toString();console.log("Token exchange request to:",en);const a=await fetch(en,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json","Content-Length":n.length.toString()},body:n});if(!a.ok){const l=await a.json();throw console.error("Token exchange error:",{status:a.status,statusText:a.statusText,error:l}),new Error(`Token exchange failed: ${l.error_description||l.error||"Unknown error"}`)}const o=await a.json();this.accessToken=o.access_token,console.log("Token exchange successful"),await this.storeAccessToken(o.access_token,o.refresh_token),localStorage.removeItem("teamsnap_code_verifier"),await this.syncTeamsAndEvents()}catch(r){throw console.error("Error in handleCallback:",r),r}}async storeAccessToken(t,r){try{const{data:{user:n},error:a}=await O.auth.getUser();if(a)throw a;if(!n)throw new Error("No authenticated user");const{error:o}=await O.from("user_settings").upsert({user_id:n.id,teamsnap_access_token:t,teamsnap_refresh_token:r,updated_at:new Date().toISOString()},{onConflict:"user_id"});o&&console.error("Error storing access token:",o)}catch(n){console.error("Error storing access token:",n)}}async getStoredAccessToken(){try{const{data:{user:t},error:r}=await O.auth.getUser();if(r)throw r;if(!t)throw new Error("No authenticated user");const{data:n,error:a}=await O.from("user_settings").select("teamsnap_access_token").eq("user_id",t.id).single();return a||!(n!=null&&n.teamsnap_access_token)?null:n.teamsnap_access_token}catch(t){return console.error("Error retrieving access token:",t),null}}async request(t,r={}){if(this.accessToken||(this.accessToken=await this.getStoredAccessToken()),!this.accessToken)throw new Error("Not authenticated - please reconnect to TeamSnap");const n=t.startsWith("http")?t:`${Qo}${t}`;console.log("Making API request to:",n);const a=await fetch(n,{...r,headers:{Authorization:`Bearer ${this.accessToken}`,Accept:"application/json","Content-Type":"application/json",...r.headers}});if(!a.ok){const l=await a.text();throw console.error("API request failed:",{url:n,status:a.status,statusText:a.statusText,response:l}),a.status===401?(this.accessToken=null,await this.clearStoredTokens(),new Error("Authentication expired - please reconnect to TeamSnap")):new Error(`API request failed: ${a.status} ${a.statusText}`)}const o=await a.json();return console.log(`API response from ${n}:`,o),o}async clearStoredTokens(){try{const{data:{user:t},error:r}=await O.auth.getUser();if(r)throw r;if(!t)return;await O.from("user_settings").update({teamsnap_access_token:null,teamsnap_refresh_token:null,updated_at:new Date().toISOString()}).eq("user_id",t.id)}catch(t){console.error("Error clearing stored tokens:",t)}}async getUserId(){try{console.log("Step 1: Fetching user ID from /me endpoint");const t=await this.request("/me");console.log("The meResponse is: ",t);let r=null;if(t.id)r=t.id.toString();else if(t.data&&Array.isArray(t.data)){const n=t.data.find(a=>a.name==="id");n&&n.value&&(r=n.value.toString())}else if(t.collection&&t.collection.items&&Array.isArray(t.collection.items)){const n=t.collection.items[0];if(n&&n.data){const a=n.data.find(o=>o.name==="id");a&&a.value&&(r=a.value.toString())}}else if(Array.isArray(t)){const n=t.find(a=>a.name==="id");n&&n.value&&(r=n.value.toString())}if(!r)throw console.error("Could not extract user ID from response:",t),new Error("User ID not found in /me response. Response structure may have changed.");return console.log("User ID obtained:",r),r}catch(t){throw console.error("Error fetching user ID:",t),t}}async getActiveTeams(t){try{console.log(`Step 2: Fetching active teams for user ID: ${t}`);const r=await this.request(`/teams/active?user_id=${t}`);let n=[];return Array.isArray(r)?n=r:r.collection&&Array.isArray(r.collection.items)?n=r.collection.items.map(a=>{if(a.data&&Array.isArray(a.data)){const o={};return a.data.forEach(l=>{l.name&&l.value!==void 0&&(o[l.name]=l.value)}),o}return a}):r.data&&Array.isArray(r.data)&&(n=r.data),console.log(`Found ${n.length} active teams`),n}catch(r){throw console.error("Error fetching active teams:",r),r}}async getTeamEvents(t){try{console.log(`Step 3: Fetching events for team ID: ${t}`);const r=await this.request(`/events/search?team_id=${t}`);let n=[];return Array.isArray(r)?n=r:r.collection&&Array.isArray(r.collection.items)?n=r.collection.items.map(a=>{if(a.data&&Array.isArray(a.data)){const o={};return a.data.forEach(l=>{l.name&&l.value!==void 0&&(o[l.name]=l.value)}),o}return a}):r.data&&Array.isArray(r.data)&&(n=r.data),console.log(`Found ${n.length} events for team ${t}`),n}catch(r){throw console.error("Error fetching team events:",r),r}}async syncTeamsAndEvents(){try{console.log("Starting TeamSnap sync process...");const{data:{user:t},error:r}=await O.auth.getUser();if(r)throw r;if(!t)throw new Error("No authenticated user");const n=await this.getUserId(),a=await this.getActiveTeams(n);if(a.length===0){console.log("No active teams found for user");return}for(const o of a){console.log(`Processing team: ${o.name} (ID: ${o.id})`);const{data:l,error:d}=await O.from("platform_teams").upsert({platform:"TeamSnap",team_id:o.id.toString(),team_name:o.name,sport:o.sport||"Unknown",sync_status:"success",last_synced:new Date().toISOString(),user_id:t.id},{onConflict:"platform,team_id"}).select().single();if(d){console.error("Error storing team:",d);continue}console.log(`Successfully stored team: ${o.name}`)}console.log("TeamSnap team sync process completed successfully"),console.log("Note: Events will be synced when teams are mapped to profiles")}catch(t){throw console.error("Error in syncTeamsAndEvents:",t),t}}async syncEventsForTeamAndProfile(t,r){try{console.log(`Syncing events for team ${t} and profile ${r}`);const{data:n,error:a}=await O.from("platform_teams").select("*").eq("id",t).eq("platform","TeamSnap").single();if(a||!n)throw new Error("Platform team not found");const o=await this.getTeamEvents(n.team_id);if(o.length===0)return console.log("No events found for this team"),0;const l=o.map(c=>({title:c.name||"TeamSnap Event",description:c.notes||"",start_time:c.start_date,end_time:c.end_date||c.start_date,location:c.location_name||"",sport:n.sport||"Unknown",color:"#7C3AED",platform:"TeamSnap",platform_color:"#7C3AED",platform_team_id:t,profile_id:r})).filter(c=>c.start_time);if(l.length===0)return console.log("No valid events to insert"),0;await O.from("events").delete().eq("platform_team_id",t).eq("profile_id",r).eq("platform","TeamSnap");const{error:d}=await O.from("events").insert(l);if(d)throw console.error("Error storing events:",d),d;return console.log(`Successfully stored ${l.length} events for profile ${r}`),l.length}catch(n){throw console.error("Error syncing events for team and profile:",n),n}}async syncEventsForTeam(t){try{console.log(`Syncing events for team ${t}`);const{data:r,error:n}=await O.from("profile_teams").select("profile_id").eq("platform_team_id",t);if(n)throw n;if(!r||r.length===0)throw new Error("No profiles mapped to this team");let a=0;for(const o of r){const l=await this.syncEventsForTeamAndProfile(t,o.profile_id);a+=l}return await O.from("platform_teams").update({sync_status:"success",last_synced:new Date().toISOString()}).eq("id",t),a}catch(r){throw console.error("Error syncing events for team:",r),await O.from("platform_teams").update({sync_status:"error",last_synced:new Date().toISOString()}).eq("id",t),r}}async getTeams(){const t=await this.getUserId();return{collection:{items:(await this.getActiveTeams(t)).map(n=>({data:{id:n.id,name:n.name,sport_name:n.sport,active:!0}}))}}}}const Xo=()=>{const[s,t]=i.useState(!1),[r,n]=i.useState(!1),[a,o]=i.useState([]),[l,d]=i.useState(!0),[c,h]=i.useState(null),[f,u]=i.useState(null),[v,N]=i.useState(null),[b,S]=i.useState(""),[E,k]=i.useState(null),[y,m]=i.useState([]),[g,p]=i.useState(null),x=je(),C=rs(),{profiles:L}=Ue(),_=new Yn({clientId:"bJElCn3OlhyTtr9QNGeb_pBnEyPO0hhq7Jz47ykoGhk",redirectUri:`${window.location.origin}/connections/teamsnap/callback`}),A=[{icon:le,title:"Automatic Schedule Sync",description:"Keep your calendar up to date with automatic syncing of games, practices, and events"},{icon:ka,title:"Team Communication",description:"Stay connected with coaches and team members through integrated messaging"},{icon:_a,title:"Game Statistics",description:"Track performance metrics and game statistics in real-time"}];i.useEffect(()=>{var j;R(),(j=C.state)!=null&&j.teamSnapConnected&&(u("TeamSnap connected successfully! Your teams have been imported."),window.history.replaceState({},document.title),setTimeout(()=>u(null),5e3))},[C]);const R=async()=>{try{const{data:j,error:w}=await O.from("platform_teams").select("*").eq("platform","TeamSnap").order("created_at",{ascending:!1});if(w)throw w;j&&j.length>0?(n(!0),await q()):n(!1)}catch(j){console.error("Error checking connection status:",j)}finally{d(!1)}},q=async()=>{try{const{data:j,error:w}=await O.from("platform_teams").select("*").eq("platform","TeamSnap").order("created_at",{ascending:!1});if(w)throw w;const U=await Promise.all((j||[]).map(async H=>{const{data:W,error:X}=await O.from("profile_teams").select(`
              profile_id,
              profiles!inner(id, name, color)
            `).eq("platform_team_id",H.id);X&&console.error("Error fetching profile mappings:",X);const{count:J,error:ee}=await O.from("events").select("*",{count:"exact",head:!0}).eq("platform_team_id",H.id);ee&&console.error("Error fetching event count:",ee);const ne=(W==null?void 0:W.map(ce=>ce.profiles))||[];return{...H,mapped_profiles:ne,event_count:J||0}}));o(U)}catch(j){console.error("Error fetching teams:",j),h("Failed to fetch teams")}},z=async()=>{try{t(!0),h(null);const j=await _.initiateOAuth();window.location.href=j}catch(j){console.error("Failed to initiate OAuth:",j),h("Failed to initiate connection"),t(!1)}},G=async()=>{try{h(null),u(null);const{error:j}=await O.from("platform_teams").delete().eq("platform","TeamSnap");if(j)throw j;n(!1),o([]),u("TeamSnap disconnected successfully")}catch(j){console.error("Error disconnecting TeamSnap:",j),h("Failed to disconnect TeamSnap")}},Y=async j=>{try{h(null),u(null),p(j);const w=a.find(H=>H.id===j);if(!w)return;if(!w.mapped_profiles||w.mapped_profiles.length===0){h("Please map this team to at least one child profile before syncing events.");return}await O.from("platform_teams").update({sync_status:"pending"}).eq("id",j);const U=await _.syncEventsForTeam(j);u(`Team refreshed successfully! Synced ${U} events for ${w.mapped_profiles.length} profile(s).`),q()}catch(w){console.error("Error refreshing team:",w);const U=w instanceof Error?w.message:"Failed to refresh team";h(U),j&&await O.from("platform_teams").update({sync_status:"error",last_synced:new Date().toISOString()}).eq("id",j)}finally{p(null)}},T=async j=>{try{h(null),u(null);const{error:w}=await O.from("platform_teams").delete().eq("id",j);if(w)throw w;o(a.filter(U=>U.id!==j)),u("Team removed successfully"),a.length===1&&n(!1)}catch(w){console.error("Error deleting team:",w),h("Failed to remove team")}},V=(j,w)=>{N(j),S(w)},P=async j=>{try{if(h(null),u(null),!b.trim()){h("Team name cannot be empty");return}const{error:w}=await O.from("platform_teams").update({team_name:b.trim()}).eq("id",j);if(w)throw w;o(a.map(U=>U.id===j?{...U,team_name:b.trim()}:U)),N(null),S(""),u("Team name updated successfully")}catch(w){console.error("Error updating team name:",w),h("Failed to update team name")}},M=()=>{N(null),S("")},D=j=>{var U;const w=a.find(H=>H.id===j);w&&(m(((U=w.mapped_profiles)==null?void 0:U.map(H=>H.id))||[]),k(j))},F=async()=>{if(E)try{if(h(null),u(null),await O.from("profile_teams").delete().eq("platform_team_id",E),y.length>0){const{error:j}=await O.from("profile_teams").insert(y.map(w=>({profile_id:w,platform_team_id:E})));if(j)throw j;try{const w=await _.syncEventsForTeam(E);u(`Team mapping updated successfully! Synced ${w} events for ${y.length} profile(s).`)}catch(w){console.error("Error syncing events after mapping:",w),u("Team mapping updated successfully. Use the refresh button to sync events.")}}else u("Team mapping updated successfully.");k(null),m([]),q()}catch(j){console.error("Error saving team mapping:",j),h("Failed to update team mapping")}},$=()=>{k(null),m([])},B=j=>{m(w=>w.includes(j)?w.filter(U=>U!==j):[...w,j])};return l?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsxs("button",{onClick:()=>x("/connections"),className:"flex items-center text-gray-600 hover:text-gray-900 mb-6",children:[e.jsx(as,{className:"h-4 w-4 mr-2"}),"Back to Connections"]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-6 py-8 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-12 w-12 flex-shrink-0 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(ve,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"TeamSnap"}),e.jsx("p",{className:"mt-1 text-gray-500",children:r?"Connected - Manage your teams and schedules":"Connect to sync your TeamSnap schedules, events, and team information"})]})]}),r&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(fe,{className:"h-5 w-5 text-green-500"}),e.jsx("span",{className:"text-sm text-green-600 font-medium",children:"Connected"})]})]})}),c&&e.jsx("div",{className:"px-6 py-4 bg-red-50 border-b border-red-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center text-red-700",children:[e.jsx(Ve,{className:"h-5 w-5 mr-2"}),c]}),e.jsx("button",{onClick:()=>h(null),className:"text-red-400 hover:text-red-500",children:e.jsx(he,{className:"h-5 w-5"})})]})}),f&&e.jsx("div",{className:"px-6 py-4 bg-green-50 border-b border-green-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center text-green-700",children:[e.jsx(fe,{className:"h-5 w-5 mr-2"}),f]}),e.jsx("button",{onClick:()=>u(null),className:"text-green-400 hover:text-green-500",children:e.jsx(he,{className:"h-5 w-5"})})]})}),r?e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Connected Teams"}),e.jsx("button",{onClick:G,className:"px-4 py-2 border border-red-300 text-red-600 rounded-md hover:bg-red-50 text-sm font-medium",children:"Disconnect TeamSnap"})]}),e.jsx("div",{className:"space-y-4",children:a.length>0?a.map(j=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx(le,{className:"h-5 w-5 text-gray-400 mr-3"}),e.jsxs("div",{className:"flex-1",children:[v===j.id?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:b,onChange:w=>S(w.target.value),className:"flex-1 text-sm font-medium border-gray-300 rounded-md focus:border-purple-500 focus:ring-purple-500",onKeyDown:w=>{w.key==="Enter"?P(j.id):w.key==="Escape"&&M()},autoFocus:!0}),e.jsx("button",{onClick:()=>P(j.id),className:"p-1 text-purple-600 hover:text-purple-700",title:"Save",children:e.jsx(It,{className:"h-4 w-4"})}),e.jsx("button",{onClick:M,className:"p-1 text-gray-400 hover:text-gray-500",title:"Cancel",children:e.jsx(he,{className:"h-4 w-4"})})]}):e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:j.team_name}),e.jsx("button",{onClick:()=>V(j.id,j.team_name),className:"p-1 text-gray-400 hover:text-gray-500",title:"Edit team name",children:e.jsx(ls,{className:"h-3 w-3"})})]}),e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[j.event_count||0," events imported"]}),j.mapped_profiles&&j.mapped_profiles.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-xs text-gray-300",children:"•"}),e.jsxs("span",{className:"text-xs text-gray-500",children:["Mapped to ",j.mapped_profiles.length," profile(s)"]})]})]}),j.mapped_profiles&&j.mapped_profiles.length>0?e.jsx("div",{className:"flex items-center space-x-2",children:j.mapped_profiles.map(w=>e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs",style:{backgroundColor:w.color+"20",color:w.color},children:w.name},w.id))}):e.jsx("span",{className:"text-xs text-amber-600 bg-amber-50 px-2 py-1 rounded-full",children:"Not mapped to any profiles - events won't appear in calendars"})]}),e.jsxs("div",{className:"flex items-center mt-1",children:[j.sync_status==="success"?e.jsx(fe,{className:"h-4 w-4 text-green-500 mr-1"}):j.sync_status==="error"?e.jsx(AlertTriangle,{className:"h-4 w-4 text-red-500 mr-1"}):e.jsx(Ce,{className:"h-4 w-4 text-yellow-500 mr-1"}),e.jsx("span",{className:"text-xs text-gray-500",children:j.last_synced?`Last synced ${new Date(j.last_synced).toLocaleString()}`:"Never synced"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>D(j.id),className:"p-2 text-gray-400 hover:text-purple-500",title:"Map to profiles",children:e.jsx(ve,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>Y(j.id),disabled:g===j.id||!j.mapped_profiles||j.mapped_profiles.length===0,className:"p-2 text-gray-400 hover:text-gray-500 disabled:opacity-50 disabled:cursor-not-allowed",title:"Refresh team events",children:e.jsx(Ce,{className:`h-4 w-4 ${g===j.id?"animate-spin":""}`})}),e.jsx("button",{onClick:()=>T(j.id),className:"p-2 text-gray-400 hover:text-red-500",title:"Remove team",children:e.jsx(We,{className:"h-4 w-4"})})]})]})},j.id)):e.jsxs("div",{className:"text-center py-6 bg-gray-50 rounded-lg",children:[e.jsx(le,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500",children:"No teams found"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Teams will appear here after connecting to TeamSnap"})]})})]}):e.jsxs("div",{className:"px-6 py-8",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:A.map((j,w)=>e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[e.jsx("div",{className:"h-12 w-12 rounded-lg bg-purple-100 text-purple-600 flex items-center justify-center mb-4",children:e.jsx(j.icon,{className:"h-6 w-6"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:j.title}),e.jsx("p",{className:"text-gray-600",children:j.description})]},w))}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-6 mb-8",children:[e.jsx("h3",{className:"text-lg font-medium text-purple-900 mb-4",children:"Before you connect"}),e.jsxs("ul",{className:"space-y-3",children:[e.jsxs("li",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 h-5 w-5 rounded-full bg-purple-200 text-purple-600 flex items-center justify-center text-sm mr-3 mt-0.5",children:"1"}),e.jsx("p",{className:"text-purple-800",children:"Make sure you have an active TeamSnap account"})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 h-5 w-5 rounded-full bg-purple-200 text-purple-600 flex items-center justify-center text-sm mr-3 mt-0.5",children:"2"}),e.jsx("p",{className:"text-purple-800",children:"Have your TeamSnap login credentials ready"})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 h-5 w-5 rounded-full bg-purple-200 text-purple-600 flex items-center justify-center text-sm mr-3 mt-0.5",children:"3"}),e.jsx("p",{className:"text-purple-800",children:"Ensure you have permission to access team data"})]})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{onClick:z,disabled:s,className:"px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:s?e.jsxs(e.Fragment,{children:[e.jsx(Ce,{className:"animate-spin h-4 w-4 mr-2"}),"Connecting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ve,{className:"h-5 w-5 mr-2"}),"Connect TeamSnap Account"]})})})]})]})]}),E&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Map Team to Profiles"}),e.jsx("button",{onClick:$,className:"text-gray-400 hover:text-gray-500",children:e.jsx(he,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Select which children's profiles this team should be associated with. Events will be automatically synced for mapped profiles."}),L&&L.length>0?e.jsx("div",{className:"space-y-3",children:L.map(j=>e.jsxs("label",{className:`flex items-center p-3 rounded-lg border cursor-pointer transition-colors ${y.includes(j.id)?"border-purple-500 bg-purple-50":"border-gray-200 hover:bg-gray-50"}`,children:[e.jsx("input",{type:"checkbox",className:"sr-only",checked:y.includes(j.id),onChange:()=>B(j.id)}),e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-bold mr-3",style:{backgroundColor:j.color},children:j.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:j.name}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Age: ",j.age]})]})]}),y.includes(j.id)&&e.jsx(fe,{className:"h-5 w-5 text-purple-500"})]},j.id))}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx(ze,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500",children:"No profiles available"}),e.jsx("button",{onClick:()=>x("/profiles"),className:"mt-2 text-sm text-purple-600 hover:text-purple-700",children:"Create a profile first"})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex justify-end space-x-3",children:[e.jsx("button",{onClick:$,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:F,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-purple-600 hover:bg-purple-700",children:"Save & Sync Events"})]})]})})]})},el=()=>{const[s]=dn(),t=je(),[r,n]=i.useState("loading"),[a,o]=i.useState(null);return i.useEffect(()=>{(async()=>{const d=s.get("code");if(!d){o("No authorization code received"),n("error");return}try{await new Yn({clientId:"bJElCn3OlhyTtr9QNGeb_pBnEyPO0hhq7Jz47ykoGhk",redirectUri:`${window.location.origin}/connections/teamsnap/callback`}).handleCallback(d),n("syncing"),setTimeout(()=>{n("success"),setTimeout(()=>{t("/connections/teamsnap",{state:{teamSnapConnected:!0,showSuccessMessage:!0}})},1500)},2e3)}catch{o("Failed to complete authentication"),n("error")}})()},[s,t]),a?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsx("div",{className:"max-w-md w-full mx-auto p-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 text-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-red-600 mb-2",children:"Authentication Error"}),e.jsx("p",{className:"text-gray-600 mb-4",children:a}),e.jsx("button",{onClick:()=>t("/connections/teamsnap"),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-purple-600 hover:bg-purple-700",children:"Return to TeamSnap"})]})})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsx("div",{className:"max-w-md w-full mx-auto p-6",children:e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 text-center",children:r==="loading"?e.jsxs(e.Fragment,{children:[e.jsx(Ts,{className:"h-8 w-8 animate-spin text-purple-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Connecting to TeamSnap"}),e.jsx("p",{className:"text-gray-600",children:"Please wait while we complete the connection..."})]}):r==="syncing"?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"h-12 w-12 text-green-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Successfully Connected!"}),e.jsx("p",{className:"text-gray-600 mb-2",children:"Your TeamSnap account has been connected."}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("div",{className:"animate-pulse flex items-center text-sm text-gray-500",children:[e.jsx(Ts,{className:"h-4 w-4 animate-spin mr-2"}),"Syncing your teams..."]})})]}):e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"h-12 w-12 text-green-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Teams Synced Successfully!"}),e.jsx("p",{className:"text-gray-600",children:"Redirecting to manage your teams..."})]})})})})},tl=()=>{const s=je(),{profiles:t}=Ue(),[r,n]=i.useState([]),[a,o]=i.useState(!0),[l,d]=i.useState(""),[c,h]=i.useState(!1),[f,u]=i.useState(null),[v,N]=i.useState(null),[b,S]=i.useState(null),[E,k]=i.useState(""),[y,m]=i.useState(null),[g,p]=i.useState([]);i.useEffect(()=>{x()},[]);const x=async()=>{try{const{data:P,error:M}=await O.from("platform_teams").select("*").eq("platform","Playmetrics").order("created_at",{ascending:!1});if(M)throw M;const D=await Promise.all((P||[]).map(async F=>{const{data:$,error:B}=await O.from("profile_teams").select(`
              profile_id,
              profiles!inner(id, name, color)
            `).eq("platform_team_id",F.id);B&&console.error("Error fetching profile mappings:",B);const{count:j,error:w}=await O.from("events").select("*",{count:"exact",head:!0}).eq("platform_team_id",F.id);w&&console.error("Error fetching event count:",w);const U=($==null?void 0:$.map(H=>H.profiles))||[];return{...F,mapped_profiles:U,event_count:j||0}}));n(D)}catch(P){console.error("Error fetching teams:",P)}finally{o(!1)}},C=P=>{try{const M=new URL(P);return M.protocol==="https:"&&M.hostname==="api.playmetrics.com"&&M.pathname.includes("/calendar/")&&P.endsWith(".ics")}catch{return!1}},L=async P=>{var M;if(P.preventDefault(),u(null),N(null),!C(l)){u("Please enter a valid Playmetrics calendar URL");return}h(!0);try{const{data:{session:D},error:F}=await O.auth.getSession();if(F)throw F;if(!D)throw new Error("No authenticated session");const $=(M=l.split("/team/")[1])==null?void 0:M.split("-")[0],B=`Team ${$}`,{data:j,error:w}=await O.from("platform_teams").upsert({platform:"Playmetrics",team_id:$,team_name:B,sport:"Soccer",ics_url:l,sync_status:"pending",user_id:D.user.id},{onConflict:"platform,team_id"}).select().single();if(w)throw w;if(!j)throw new Error("Failed to create or update team");try{const U=await fetch("https://cwbdhswftljelgwgjxnc.supabase.co/functions/v1/sync-playmetrics-calendar",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${D.access_token}`},body:JSON.stringify({icsUrl:l,teamId:j.id,profileId:null})});if(!U.ok){const W=await U.json();throw new Error(W.error||"Failed to sync calendar")}const H=await U.json();N(`Team calendar added successfully! Found ${H.eventCount||0} events. You can now map it to your children's profiles.`)}catch(U){console.error("Error syncing calendar:",U),N("Team calendar added successfully! You can now map it to your children's profiles and sync events.")}d(""),x()}catch(D){console.error("Error adding team:",D),u(D instanceof Error?D.message:"Failed to add team calendar. Please try again.")}finally{h(!1)}},_=async P=>{try{u(null),N(null);const{error:M}=await O.from("platform_teams").delete().eq("id",P);if(M)throw M;n(r.filter(D=>D.id!==P)),N("Team removed successfully")}catch(M){console.error("Error deleting team:",M),u("Failed to remove team. Please try again.")}},A=async P=>{try{u(null),N(null);const M=r.find(B=>B.id===P);if(!M)return;if(!M.mapped_profiles||M.mapped_profiles.length===0){u("Please map this team to at least one child profile before syncing events.");return}const{data:{session:D},error:F}=await O.auth.getSession();if(F)throw F;if(!D)throw new Error("No authenticated session");await O.from("platform_teams").update({sync_status:"pending"}).eq("id",P);let $=0;for(const B of M.mapped_profiles){const j=await fetch("https://cwbdhswftljelgwgjxnc.supabase.co/functions/v1/sync-playmetrics-calendar",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${D.access_token}`},body:JSON.stringify({icsUrl:M.ics_url,teamId:M.id,profileId:B.id})});if(!j.ok){const U=await j.json();throw new Error(U.error||"Failed to sync calendar")}const w=await j.json();$+=w.eventCount||0}N(`Calendar refreshed successfully! Synced ${$} events for ${M.mapped_profiles.length} profile(s).`),x()}catch(M){console.error("Error refreshing calendar:",M),u(M instanceof Error?M.message:"Failed to refresh calendar. Please try again."),P&&await O.from("platform_teams").update({sync_status:"error",last_synced:new Date().toISOString()}).eq("id",P)}},R=(P,M)=>{S(P),k(M)},q=async P=>{try{if(u(null),N(null),!E.trim()){u("Team name cannot be empty");return}const{error:M}=await O.from("platform_teams").update({team_name:E.trim()}).eq("id",P);if(M)throw M;n(r.map(D=>D.id===P?{...D,team_name:E.trim()}:D)),S(null),k(""),N("Team name updated successfully")}catch(M){console.error("Error updating team name:",M),u("Failed to update team name. Please try again.")}},z=()=>{S(null),k("")},G=P=>{var D;const M=r.find(F=>F.id===P);M&&(p(((D=M.mapped_profiles)==null?void 0:D.map(F=>F.id))||[]),m(P))},Y=async()=>{if(y)try{if(u(null),N(null),await O.from("profile_teams").delete().eq("platform_team_id",y),g.length>0){const{error:P}=await O.from("profile_teams").insert(g.map(M=>({profile_id:M,platform_team_id:y})));if(P)throw P}m(null),p([]),N("Team mapping updated successfully. Use the refresh button to sync events for the mapped profiles."),x()}catch(P){console.error("Error saving team mapping:",P),u("Failed to update team mapping. Please try again.")}},T=()=>{m(null),p([])},V=P=>{p(M=>M.includes(P)?M.filter(D=>D!==P):[...M,P])};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsxs("button",{onClick:()=>s("/connections"),className:"flex items-center text-gray-600 hover:text-gray-900 mb-6",children:[e.jsx(as,{className:"h-4 w-4 mr-2"}),"Back to Connections"]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-6 py-8 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-12 w-12 rounded-lg flex items-center justify-center",style:{backgroundColor:"#10B98120",color:"#10B981"},children:e.jsx(is,{className:"h-6 w-6"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Connect to Playmetrics"}),e.jsx("p",{className:"mt-1 text-gray-500",children:"Import your team schedules from Playmetrics calendars"})]})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Add Team Calendar"}),e.jsxs("form",{onSubmit:L,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"ics-url",className:"block text-sm font-medium text-gray-700",children:"Calendar URL"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{type:"url",id:"ics-url",value:l,onChange:P=>d(P.target.value),placeholder:"https://api.playmetrics.com/calendar/1079/team/220548-46283CA0.ics",className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500",required:!0})}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Enter the Playmetrics calendar URL for your team. Events will be imported immediately, then you can map the team to your children's profiles."})]}),f&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4 text-red-700",children:f}),v&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-4 text-green-700",children:v}),e.jsx("button",{type:"submit",disabled:c,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed",children:c?e.jsxs(e.Fragment,{children:[e.jsx(Ce,{className:"animate-spin h-4 w-4 mr-2"}),"Adding & Syncing Team..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"}),"Add Team Calendar"]})})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Connected Teams"}),e.jsx("div",{className:"space-y-4",children:a?e.jsx("div",{className:"text-center py-4",children:e.jsx(Ce,{className:"animate-spin h-6 w-6 text-gray-400 mx-auto"})}):r.length>0?r.map(P=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx(le,{className:"h-5 w-5 text-gray-400 mr-3"}),e.jsxs("div",{className:"flex-1",children:[b===P.id?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",value:E,onChange:M=>k(M.target.value),className:"flex-1 text-sm font-medium border-gray-300 rounded-md focus:border-green-500 focus:ring-green-500",onKeyDown:M=>{M.key==="Enter"?q(P.id):M.key==="Escape"&&z()},autoFocus:!0}),e.jsx("button",{onClick:()=>q(P.id),className:"p-1 text-green-600 hover:text-green-700",title:"Save",children:e.jsx(It,{className:"h-4 w-4"})}),e.jsx("button",{onClick:z,className:"p-1 text-gray-400 hover:text-gray-500",title:"Cancel",children:e.jsx(he,{className:"h-4 w-4"})})]}):e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:P.team_name}),e.jsx("button",{onClick:()=>R(P.id,P.team_name),className:"p-1 text-gray-400 hover:text-gray-500",title:"Edit team name",children:e.jsx(ls,{className:"h-3 w-3"})})]}),e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[P.event_count||0," events imported"]}),P.mapped_profiles&&P.mapped_profiles.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-xs text-gray-300",children:"•"}),e.jsxs("span",{className:"text-xs text-gray-500",children:["Mapped to ",P.mapped_profiles.length," profile(s)"]})]})]}),P.mapped_profiles&&P.mapped_profiles.length>0?e.jsx("div",{className:"flex items-center space-x-2",children:P.mapped_profiles.map(M=>e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs",style:{backgroundColor:M.color+"20",color:M.color},children:M.name},M.id))}):e.jsx("span",{className:"text-xs text-amber-600 bg-amber-50 px-2 py-1 rounded-full",children:"Not mapped to any profiles - events won't appear in calendars"})]}),e.jsxs("div",{className:"flex items-center mt-1",children:[P.sync_status==="success"?e.jsx(fe,{className:"h-4 w-4 text-green-500 mr-1"}):P.sync_status==="error"?e.jsx(yt,{className:"h-4 w-4 text-red-500 mr-1"}):e.jsx(Ce,{className:"h-4 w-4 text-yellow-500 mr-1"}),e.jsx("span",{className:"text-xs text-gray-500",children:P.last_synced?`Last synced ${new Date(P.last_synced).toLocaleString()}`:"Never synced"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>G(P.id),className:"p-2 text-gray-400 hover:text-blue-500",title:"Map to profiles",children:e.jsx(ve,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>A(P.id),className:"p-2 text-gray-400 hover:text-gray-500",title:"Refresh calendar",disabled:!P.mapped_profiles||P.mapped_profiles.length===0,children:e.jsx(Ce,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>_(P.id),className:"p-2 text-gray-400 hover:text-red-500",title:"Remove team",children:e.jsx(We,{className:"h-4 w-4"})})]})]})},P.id)):e.jsxs("div",{className:"text-center py-6 bg-gray-50 rounded-lg",children:[e.jsx(le,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500",children:"No teams connected yet"})]})})]})]})]})]}),y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Map Team to Profiles"}),e.jsx("button",{onClick:T,className:"text-gray-400 hover:text-gray-500",children:e.jsx(he,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Select which children's profiles this team calendar should be associated with. Events will only appear in the calendars of mapped profiles."}),t&&t.length>0?e.jsx("div",{className:"space-y-3",children:t.map(P=>e.jsxs("label",{className:`flex items-center p-3 rounded-lg border cursor-pointer transition-colors ${g.includes(P.id)?"border-green-500 bg-green-50":"border-gray-200 hover:bg-gray-50"}`,children:[e.jsx("input",{type:"checkbox",className:"sr-only",checked:g.includes(P.id),onChange:()=>V(P.id)}),e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-bold mr-3",style:{backgroundColor:P.color},children:P.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:P.name}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Age: ",P.age]})]})]}),g.includes(P.id)&&e.jsx(fe,{className:"h-5 w-5 text-green-500"})]},P.id))}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx(ze,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500",children:"No profiles available"}),e.jsx("button",{onClick:()=>s("/profiles"),className:"mt-2 text-sm text-green-600 hover:text-green-700",children:"Create a profile first"})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex justify-end space-x-3",children:[e.jsx("button",{onClick:T,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:Y,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700",children:"Save Mapping"})]})]})})]})},sl=()=>{const s=je(),{profiles:t,friendsProfiles:r,addProfile:n,loading:a,error:o}=Ue(),[l,d]=i.useState(!1),[c,h]=i.useState([]),[f,u]=i.useState(null),[v,N]=i.useState(null),[b,S]=i.useState({name:"",age:"",color:"#3B82F6",notes:""}),E=[{name:"Blue",value:"#3B82F6"},{name:"Red",value:"#EF4444"},{name:"Green",value:"#10B981"},{name:"Yellow",value:"#F59E0B"},{name:"Purple",value:"#8B5CF6"},{name:"Pink",value:"#EC4899"},{name:"Indigo",value:"#6366F1"},{name:"Teal",value:"#14B8A6"},{name:"Orange",value:"#F97316"},{name:"Cyan",value:"#06B6D4"},{name:"Lime",value:"#84CC16"},{name:"Rose",value:"#F43F5E"}],k=[{name:"Soccer",color:"#10B981"},{name:"Baseball",color:"#F59E0B"},{name:"Basketball",color:"#EF4444"},{name:"Swimming",color:"#3B82F6"},{name:"Tennis",color:"#8B5CF6"},{name:"Volleyball",color:"#EC4899"}],y=x=>{var L;const C=(L=x.target.files)==null?void 0:L[0];if(C){u(C);const _=new FileReader;_.onloadend=()=>{N(_.result)},_.readAsDataURL(C)}},m=async x=>{x.preventDefault();try{let C=null;if(f){const L=f.name.split(".").pop(),_=`${Math.random()}.${L}`,{data:A,error:R}=await O.storage.from("profile-photos").upload(_,f);if(R)throw R;const{data:{publicUrl:q}}=O.storage.from("profile-photos").getPublicUrl(_);C=q}await n({name:b.name,age:parseInt(b.age),color:b.color,notes:b.notes,photo_url:C,sports:c.map(L=>{const _=k.find(A=>A.name===L);return{name:L,color:(_==null?void 0:_.color)||"#000000"}}),eventCount:0,isOwnProfile:!0}),d(!1),S({name:"",age:"",color:"#3B82F6",notes:""}),h([]),u(null),N(null)}catch(C){console.error("Failed to add profile:",C)}},g=x=>{s(`/profiles/${x}`)},p=x=>{const{name:C,value:L}=x.target;S(_=>({..._,[C]:L}))};return a?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):o?e.jsx("div",{className:"text-center text-red-600",children:e.jsxs("p",{children:["Error loading profiles: ",o]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Children Profiles"}),e.jsxs("button",{onClick:()=>d(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center",children:[e.jsx(Pe,{className:"h-5 w-5 mr-2"}),"Add Child"]})]}),t.length>0&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Your Children"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(x=>e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-full overflow-hidden flex items-center justify-center",children:x.photo_url?e.jsx("img",{src:x.photo_url,alt:x.name,className:"h-full w-full object-cover"}):e.jsx("div",{className:"h-full w-full flex items-center justify-center text-white text-xl font-bold",style:{backgroundColor:x.color},children:x.name.charAt(0)})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:x.name}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Age: ",x.age]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Sports"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:x.sports.map((C,L)=>e.jsx("span",{className:"px-3 py-1 rounded-full text-sm",style:{backgroundColor:C.color+"20",color:C.color},children:C.name},L))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Activity Summary"}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.jsxs("p",{children:[x.eventCount," events this week"]})})]}),e.jsx("button",{onClick:()=>g(x.id),className:"w-full mt-4 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"View Profile"})]})]})},x.id))})]}),r.length>0&&e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4 flex items-center",children:[e.jsx(Be,{className:"h-5 w-5 text-yellow-500 mr-2"}),"Friends' Children (Administrator Access)"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(x=>e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden border-l-4 border-yellow-500",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsxs("div",{className:"h-12 w-12 rounded-full overflow-hidden flex items-center justify-center relative",children:[x.photo_url?e.jsx("img",{src:x.photo_url,alt:x.name,className:"h-full w-full object-cover"}):e.jsx("div",{className:"h-full w-full flex items-center justify-center text-white text-xl font-bold",style:{backgroundColor:x.color},children:x.name.charAt(0)}),e.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-yellow-500 rounded-full flex items-center justify-center",children:e.jsx(Be,{className:"h-2.5 w-2.5 text-white"})})]}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:x.name}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Age: ",x.age]}),e.jsxs("p",{className:"text-xs text-blue-600 dark:text-blue-400 font-medium",children:[x.ownerName,"'s child"]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Sports"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:x.sports.map((C,L)=>e.jsx("span",{className:"px-3 py-1 rounded-full text-sm",style:{backgroundColor:C.color+"20",color:C.color},children:C.name},L))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Activity Summary"}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.jsxs("p",{children:[x.eventCount," events this week"]})})]}),e.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center text-yellow-800 dark:text-yellow-200",children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"text-xs font-medium",children:"Administrator Access"})]}),e.jsx("p",{className:"text-xs text-yellow-700 dark:text-yellow-300 mt-1",children:"You can view and manage all aspects of this profile"})]}),e.jsx("button",{onClick:()=>g(x.id),className:"w-full mt-4 px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700",children:"Manage Profile"})]})]})},x.id))})]}),t.length===0&&r.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-gray-400 mb-4",children:e.jsx(Pe,{className:"h-12 w-12 mx-auto"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No profiles yet"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"Get started by adding your first child's profile"}),e.jsx("button",{onClick:()=>d(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Add Your First Child"})]}),l&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-auto",children:e.jsxs("form",{onSubmit:m,children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Add New Child"}),e.jsx("button",{type:"button",onClick:()=>d(!1),className:"text-gray-400 hover:text-gray-500 dark:text-gray-300 dark:hover:text-gray-200",children:e.jsx(he,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex-shrink-0",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"h-32 w-32 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center overflow-hidden",children:v?e.jsx("img",{src:v,alt:"Preview",className:"h-full w-full object-cover"}):e.jsx(rt,{className:"h-8 w-8 text-gray-400 dark:text-gray-500"})}),e.jsxs("label",{htmlFor:"photo",className:"absolute bottom-0 right-0 bg-white dark:bg-gray-700 rounded-full p-2 shadow-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-600",children:[e.jsx(Pe,{className:"h-4 w-4 text-gray-600 dark:text-gray-300"}),e.jsx("input",{type:"file",id:"photo",className:"hidden",accept:"image/*",onChange:y})]})]}),e.jsx("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400 text-center",children:"Click to upload photo"})]}),e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Name"}),e.jsx("input",{type:"text",id:"name",name:"name",value:b.name,onChange:p,placeholder:"Enter child's name",className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0,autoComplete:"off"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"age",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Age"}),e.jsx("input",{type:"number",id:"age",name:"age",value:b.age,onChange:p,min:"1",max:"18",placeholder:"Enter age",className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0,autoComplete:"off"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"color",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Profile Color"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx("select",{id:"color",name:"color",value:b.color,onChange:p,className:"block w-full pl-8 pr-10 py-2 text-base border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md dark:bg-gray-700 dark:text-white",children:E.map(x=>e.jsx("option",{value:x.value,className:"flex items-center",children:x.name},x.value))}),e.jsx("div",{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 rounded-full pointer-events-none",style:{backgroundColor:b.color}})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Sports & Activities"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:k.map(x=>e.jsxs("label",{className:`flex items-center p-3 rounded-lg border dark:border-gray-600 cursor-pointer transition-colors ${c.includes(x.name)?"border-blue-500 bg-blue-50 dark:bg-blue-900/50":"border-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:[e.jsx("input",{type:"checkbox",className:"hidden",checked:c.includes(x.name),onChange:C=>{C.target.checked?h([...c,x.name]):h(c.filter(L=>L!==x.name))}}),e.jsx("span",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:x.color}}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:x.name})]},x.name))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Additional Notes"}),e.jsx("textarea",{id:"notes",name:"notes",value:b.notes,onChange:p,rows:3,placeholder:"Enter any important information about your child...",className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-50 dark:bg-gray-700 border-t border-gray-200 dark:border-gray-600 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>d(!1),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Add Child"})]})]})})})]})},rl=()=>{const[s,t]=i.useState([]),[r,n]=i.useState([]),[a,o]=i.useState([]),[l,d]=i.useState(""),[c,h]=i.useState([]),[f,u]=i.useState(""),[v,N]=i.useState(!0),[b,S]=i.useState(!1),[E,k]=i.useState(null),[y,m]=i.useState(null),[g,p]=i.useState(null),[x,C]=i.useState(""),[L,_]=i.useState(null),[A,R]=i.useState("none"),q=i.useCallback(async()=>{if(!l.trim()||l.trim().length<2){h([]),C("");return}S(!0),k(null),C("");try{if(!g){k("User not authenticated");return}const j=l.trim();console.log("🔍 STARTING SEARCH"),console.log("Search term:",j),console.log("Current user ID:",g);const{data:w,error:U}=await O.from("user_settings").select("user_id, full_name, profile_photo_url").ilike("full_name",`%${j}%`).limit(10);if(console.log("📊 DATABASE RESPONSE"),console.log("Error:",U),console.log("Data:",w),console.log("Data length:",(w==null?void 0:w.length)||0),U)throw console.error("❌ Search error:",U),C(`Database error: ${U.message}`),U;if(!w){console.log("❌ No data returned from database"),C("No data returned from database"),h([]);return}if(w.length===0){console.log("❌ Empty results from database"),C(`No users found in database with name containing "${j}"`),h([]);return}console.log("✅ Found users in database:",w.length),C(`Found ${w.length} users in database`);const H=s.map(ne=>ne.friend_id),W=r.map(ne=>ne.requester_id),X=a.map(ne=>ne.requested_id);console.log("🔍 FILTERING LOGIC"),console.log("Existing friend IDs:",H),console.log("Pending incoming request IDs:",W),console.log("Pending outgoing request IDs:",X);const J=w.filter(ne=>{const ce=ne.user_id===g,Z=H.includes(ne.user_id),K=W.includes(ne.user_id),ge=X.includes(ne.user_id);console.log(`--- Checking user: ${ne.full_name} (${ne.user_id}) ---`),console.log(`  Is current user: ${ce}`),console.log(`  Is existing friend: ${Z}`),console.log(`  Has pending incoming: ${K}`),console.log(`  Has pending outgoing: ${ge}`);const de=!ce&&!Z&&!K&&!ge;return console.log(`  ✅ Should include: ${de}`),de});console.log("🎯 FINAL FILTERING RESULTS"),console.log("Filtered users count:",J.length),console.log("Filtered users:",J);const ee=J.map(ne=>({id:ne.user_id,email:"Search by name only",full_name:ne.full_name,profile_photo_url:ne.profile_photo_url}));console.log("📋 FINAL RESULTS FOR UI"),console.log("Transformed users:",ee),console.log("Setting search results..."),h(ee),ee.length>0?(C(`✅ Found ${ee.length} available user(s) for "${j}"`),console.log(`✅ SUCCESS: Found ${ee.length} user(s) matching "${j}"`)):(C(`❌ No available users found for "${j}" after filtering (found ${w.length} in database but all were filtered out)`),console.log(`❌ NO RESULTS: Found ${w.length} users in database but all were filtered out`))}catch(j){console.error("💥 Error searching users:",j);const w=j instanceof Error?j.message:"Unknown error";k(`Failed to search users: ${w}`),C(`Error: ${w}`)}finally{S(!1),console.log("🏁 SEARCH COMPLETE")}},[l,g,s,r,a]);i.useEffect(()=>{z()},[]),i.useEffect(()=>{const j=setTimeout(()=>{l.trim().length>=2?q():(h([]),C(""))},300);return()=>clearTimeout(j)},[l,q]);const z=async()=>{try{const{data:{user:j}}=await O.auth.getUser();if(!j)return;p(j.id);const{data:w,error:U}=await O.from("friendships").select("id, friend_id, role, created_at").eq("user_id",j.id);if(U)throw U;const H=(w==null?void 0:w.map(ie=>ie.friend_id))||[];let W=[];if(H.length>0){const{data:ie,error:me}=await O.from("user_settings").select("user_id, full_name, profile_photo_url").in("user_id",H);if(me)throw me;W=H.map(ke=>{const ue=ie==null?void 0:ie.find(Ee=>Ee.user_id===ke);return{id:ke,email:"Email not available",full_name:ue==null?void 0:ue.full_name,profile_photo_url:ue==null?void 0:ue.profile_photo_url}})}const X=(w==null?void 0:w.map(ie=>({...ie,friend:W.find(me=>me.id===ie.friend_id)||{id:ie.friend_id,email:"Email not available",full_name:void 0,profile_photo_url:void 0}})))||[];t(X);const{data:J,error:ee}=await O.from("friend_requests").select("id, requester_id, requested_id, status, role, message, created_at").eq("requested_id",j.id).eq("status","pending");if(ee)throw ee;const ne=(J==null?void 0:J.map(ie=>ie.requester_id))||[];let ce=[];if(ne.length>0){const{data:ie,error:me}=await O.from("user_settings").select("user_id, full_name, profile_photo_url").in("user_id",ne);if(me)throw me;ce=ne.map(ke=>{const ue=ie==null?void 0:ie.find(Ee=>Ee.user_id===ke);return{id:ke,email:"Email not available",full_name:ue==null?void 0:ue.full_name,profile_photo_url:ue==null?void 0:ue.profile_photo_url}})}const Z=(J==null?void 0:J.map(ie=>({...ie,requester:ce.find(me=>me.id===ie.requester_id)})))||[];n(Z);const{data:K,error:ge}=await O.from("friend_requests").select("id, requester_id, requested_id, status, role, message, created_at").eq("requester_id",j.id).eq("status","pending");if(ge)throw ge;const de=(K==null?void 0:K.map(ie=>ie.requested_id))||[];let be=[];if(de.length>0){const{data:ie,error:me}=await O.from("user_settings").select("user_id, full_name, profile_photo_url").in("user_id",de);if(me)throw me;be=de.map(ke=>{const ue=ie==null?void 0:ie.find(Ee=>Ee.user_id===ke);return{id:ke,email:"Email not available",full_name:ue==null?void 0:ue.full_name,profile_photo_url:ue==null?void 0:ue.profile_photo_url}})}const ye=(K==null?void 0:K.map(ie=>({...ie,requested:be.find(me=>me.id===ie.requested_id)})))||[];o(ye)}catch(j){console.error("Error fetching friends data:",j),k("Failed to load friends data")}finally{N(!1)}},G=async j=>{try{k(null);const{data:{user:w}}=await O.auth.getUser();if(!w)return;let U=null;try{const{data:W,error:X}=await O.from("friend_requests").select("id").eq("requester_id",w.id).eq("requested_id",j).single();if(X&&X.code!=="PGRST116")throw X;U=W}catch(W){if(W.code!=="PGRST116")throw W}if(U){k("Friend request already exists");return}const{error:H}=await O.from("friend_requests").insert({requester_id:w.id,requested_id:j,role:"none",message:f.trim()||null});if(H)throw H;m("Friend request sent successfully!"),h([]),d(""),u(""),C(""),z()}catch(w){console.error("Error sending friend request:",w),(w instanceof Error?w.message:"Unknown error").includes("duplicate key value violates unique constraint")?k("Friend request already exists"):k("Failed to send friend request")}},Y=async(j,w)=>{try{k(null);const{data:{user:U}}=await O.auth.getUser();if(!U)return;const{data:H,error:W}=await O.from("friend_requests").update({status:w}).eq("id",j).select().single();if(W)throw W;if(w==="accepted"){const{error:X}=await O.from("friendships").insert([{user_id:H.requested_id,friend_id:H.requester_id,role:"none"},{user_id:H.requester_id,friend_id:H.requested_id,role:"none"}]);if(X)throw X;m("Friend request accepted!")}else m("Friend request declined");z()}catch(U){console.error("Error responding to friend request:",U),k("Failed to respond to friend request")}},T=async j=>{try{k(null);const{data:{user:w}}=await O.auth.getUser();if(!w)return;const{data:U,error:H}=await O.from("friendships").select("friend_id").eq("id",j).single();if(H)throw H;const{error:W}=await O.from("friendships").delete().or(`and(user_id.eq.${w.id},friend_id.eq.${U.friend_id}),and(user_id.eq.${U.friend_id},friend_id.eq.${w.id})`);if(W)throw W;m("Friend removed successfully"),z()}catch(w){console.error("Error removing friend:",w),k("Failed to remove friend")}},V=async j=>{try{k(null);const{error:w}=await O.from("friend_requests").delete().eq("id",j);if(w)throw w;m("Friend request cancelled"),z()}catch(w){console.error("Error cancelling request:",w),k("Failed to cancel request")}},P=async(j,w)=>{try{k(null);const{error:U}=await O.from("friendships").update({role:w}).eq("id",j);if(U)throw U;m(`Friend access level updated to ${$(w)}`),_(null),z()}catch(U){console.error("Error updating friend role:",U),k("Failed to update friend access level")}},M=(j,w)=>{_(j),R(w)},D=()=>{_(null),R("none")},F=j=>{switch(j){case"administrator":return e.jsx(Ea,{className:"h-4 w-4 text-red-500"});case"viewer":return e.jsx(Kt,{className:"h-4 w-4 text-blue-500"});case"none":default:return e.jsx(Yt,{className:"h-4 w-4 text-green-500"})}},$=j=>{switch(j){case"administrator":return"Administrator";case"viewer":return"Viewer";case"none":default:return"Friend"}},B=j=>{switch(j){case"administrator":return"Can view and manage all schedules, events, and profiles";case"viewer":return"Can view schedules and events in dashboard and calendar";case"none":default:return"Can chat and send messages only"}};return v?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[E&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-md p-4 text-red-700 flex items-center",children:[e.jsx(Ve,{className:"h-5 w-5 mr-2"}),E]}),y&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-md p-4 text-green-700 flex items-center",children:[e.jsx(bt,{className:"h-5 w-5 mr-2"}),y]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3 flex items-center",children:[e.jsx(ze,{className:"h-4 w-4 mr-2"}),"Add Friend"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(tt,{className:"h-4 w-4 text-gray-400"})}),e.jsx("input",{type:"text",value:l,onChange:j=>d(j.target.value),placeholder:"Start typing a user's name...",className:"w-full pl-10 pr-4 py-2 rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-600 dark:text-white text-sm"}),b&&e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-blue-600 border-t-transparent"})})]}),x&&e.jsxs("div",{className:"text-xs p-2 bg-blue-50 dark:bg-blue-900/50 border border-blue-200 dark:border-blue-800 rounded",children:[e.jsx("strong",{children:"Debug:"})," ",x]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Search results will appear as you type (minimum 2 characters). Search is by user name only."}),c.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{children:e.jsx("input",{type:"text",value:f,onChange:j=>u(j.target.value),placeholder:"Optional message with your friend request",className:"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-600 dark:text-white text-sm"})}),e.jsxs("div",{className:"bg-white dark:bg-gray-600 rounded-md border border-gray-200 dark:border-gray-500 max-h-60 overflow-y-auto",children:[e.jsx("div",{className:"p-2 bg-green-50 dark:bg-green-900/50 border-b border-green-200 dark:border-green-800",children:e.jsxs("p",{className:"text-xs text-green-700 dark:text-green-300",children:["✅ Found ",c.length,' user(s) matching "',l.trim(),'"']})}),c.map(j=>e.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-gray-100 dark:border-gray-500 last:border-b-0",children:[e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-300 dark:bg-gray-500 flex items-center justify-center mr-3",children:j.profile_photo_url?e.jsx("img",{src:j.profile_photo_url,alt:"",className:"w-8 h-8 rounded-full object-cover"}):e.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:(j.full_name||"U").charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:j.full_name||"No name set"}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:j.email})]})]}),e.jsxs("button",{onClick:()=>G(j.id),className:"px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm flex items-center",children:[e.jsx(ze,{className:"h-3 w-3 mr-1"}),"Send Request"]})]},j.id))]})]}),l.trim().length>=2&&!b&&c.length===0&&e.jsxs("div",{className:"text-center py-4 text-gray-500 dark:text-gray-400 bg-white dark:bg-gray-600 rounded-md border border-gray-200 dark:border-gray-500",children:[e.jsx(tt,{className:"h-6 w-6 mx-auto mb-2 opacity-50"}),e.jsxs("p",{className:"text-sm",children:['No available users found for "',l.trim(),'"']}),e.jsx("p",{className:"text-xs",children:"They may already be your friend, have a pending request, or don't exist"})]})]})]}),r.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3 flex items-center",children:[e.jsx(os,{className:"h-4 w-4 mr-2"}),"Incoming Requests (",r.length,")"]}),e.jsx("div",{className:"space-y-2",children:r.map(j=>{var w,U,H,W;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 dark:bg-blue-900/50 rounded-md border border-blue-200 dark:border-blue-800",children:[e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-300 dark:bg-gray-500 flex items-center justify-center mr-3",children:(w=j.requester)!=null&&w.profile_photo_url?e.jsx("img",{src:j.requester.profile_photo_url,alt:"",className:"w-8 h-8 rounded-full object-cover"}):e.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:(((U=j.requester)==null?void 0:U.full_name)||"U").charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:((H=j.requester)==null?void 0:H.full_name)||"No name set"}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:((W=j.requester)==null?void 0:W.email)||`ID: ${j.requester_id.slice(0,8)}...`}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Wants to be your friend"}),j.message&&e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1 italic bg-white dark:bg-gray-700 p-2 rounded",children:['"',j.message,'"']})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>Y(j.id,"accepted"),className:"p-1 text-green-600 hover:text-green-700",title:"Accept",children:e.jsx(bt,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>Y(j.id,"declined"),className:"p-1 text-red-600 hover:text-red-700",title:"Decline",children:e.jsx(he,{className:"h-4 w-4"})})]})]},j.id)})})]}),a.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3 flex items-center",children:[e.jsx(Fe,{className:"h-4 w-4 mr-2"}),"Pending Requests (",a.length,")"]}),e.jsx("div",{className:"space-y-2",children:a.map(j=>{var w,U,H,W;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-yellow-50 dark:bg-yellow-900/50 rounded-md border border-yellow-200 dark:border-yellow-800",children:[e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-300 dark:bg-gray-500 flex items-center justify-center mr-3",children:(w=j.requested)!=null&&w.profile_photo_url?e.jsx("img",{src:j.requested.profile_photo_url,alt:"",className:"w-8 h-8 rounded-full object-cover"}):e.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:(((U=j.requested)==null?void 0:U.full_name)||"U").charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:((H=j.requested)==null?void 0:H.full_name)||"No name set"}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:((W=j.requested)==null?void 0:W.email)||`ID: ${j.requested_id.slice(0,8)}...`}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Friend request sent"})]})]}),e.jsx("button",{onClick:()=>V(j.id),className:"p-1 text-red-600 hover:text-red-700",title:"Cancel request",children:e.jsx(he,{className:"h-4 w-4"})})]},j.id)})})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3 flex items-center",children:[e.jsx(ve,{className:"h-4 w-4 mr-2"}),"Friends (",s.length,")"]}),s.length>0?e.jsx("div",{className:"space-y-2",children:s.map(j=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-gray-700 rounded-md border border-gray-200 dark:border-gray-600",children:[e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-300 dark:bg-gray-500 flex items-center justify-center mr-3",children:j.friend.profile_photo_url?e.jsx("img",{src:j.friend.profile_photo_url,alt:"",className:"w-8 h-8 rounded-full object-cover"}):e.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:(j.friend.full_name||"U").charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:j.friend.full_name||"No name set"}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:j.friend.email||`ID: ${j.friend_id.slice(0,8)}...`}),L===j.id?e.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[e.jsxs("select",{value:A,onChange:w=>R(w.target.value),className:"text-xs border border-gray-300 dark:border-gray-600 rounded px-2 py-1 dark:bg-gray-600 dark:text-white",children:[e.jsx("option",{value:"none",children:"Friend (Chat only)"}),e.jsx("option",{value:"viewer",children:"Viewer (View schedules)"}),e.jsx("option",{value:"administrator",children:"Administrator (Full access)"})]}),e.jsx("button",{onClick:()=>P(j.id,A),className:"p-1 text-green-600 hover:text-green-700",title:"Save",children:e.jsx(It,{className:"h-3 w-3"})}),e.jsx("button",{onClick:D,className:"p-1 text-gray-400 hover:text-gray-500",title:"Cancel",children:e.jsx(he,{className:"h-3 w-3"})})]}):e.jsxs("div",{className:"mt-1 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[F(j.role),e.jsxs("div",{className:"ml-1",children:[e.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:$(j.role)}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-500",children:B(j.role)})]})]}),e.jsx("button",{onClick:()=>M(j.id,j.role),className:"p-1 text-gray-400 hover:text-blue-500",title:"Edit access level",children:e.jsx(ls,{className:"h-3 w-3"})})]})]})]}),e.jsx("button",{onClick:()=>T(j.id),className:"p-1 text-red-600 hover:text-red-700",title:"Remove friend",children:e.jsx(We,{className:"h-4 w-4"})})]},j.id))}):e.jsxs("div",{className:"text-center py-6 text-gray-500 dark:text-gray-400",children:[e.jsx(ve,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No friends added yet"}),e.jsx("p",{className:"text-xs",children:"Search for users by name to send friend requests"})]})]})]})},nl=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ve,{className:"h-8 w-8 text-blue-600 mr-3"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Friends"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Manage your friends and share your children's schedules and events"})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Friends & Sharing"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Add friends to share your children's schedules and events. You can give them viewer or administrator access to control what they can see and do."})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4 mb-6",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-800 dark:text-blue-200 mb-2",children:"Access Levels Explained"}),e.jsxs("div",{className:"space-y-2 text-sm text-blue-700 dark:text-blue-300",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"font-medium mr-2",children:"💬 Friend:"}),e.jsx("span",{children:"Can chat and send messages only"})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"font-medium mr-2",children:"👁️ Viewer:"}),e.jsx("span",{children:"Can view schedules and events in dashboard and calendar"})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"font-medium mr-2",children:"👑 Administrator:"}),e.jsx("span",{children:"Can view and manage all schedules, events, and profiles"})]})]})]}),e.jsx(rl,{})]})})]});/*! Capacitor: https://capacitorjs.com/ - MIT License */const al=s=>{const t=new Map;t.set("web",{name:"web"});const r=s.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:t},n=(o,l)=>{r.platforms.set(o,l)},a=o=>{r.platforms.has(o)&&(r.currentPlatform=r.platforms.get(o))};return r.addPlatform=n,r.setPlatform=a,r},il=s=>s.CapacitorPlatforms=al(s),Jn=il(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});Jn.addPlatform;Jn.setPlatform;var He;(function(s){s.Unimplemented="UNIMPLEMENTED",s.Unavailable="UNAVAILABLE"})(He||(He={}));class Gt extends Error{constructor(t,r,n){super(t),this.message=t,this.code=r,this.data=n}}const ol=s=>{var t,r;return s!=null&&s.androidBridge?"android":!((r=(t=s==null?void 0:s.webkit)===null||t===void 0?void 0:t.messageHandlers)===null||r===void 0)&&r.bridge?"ios":"web"},ll=s=>{var t,r,n,a,o;const l=s.CapacitorCustomPlatform||null,d=s.Capacitor||{},c=d.Plugins=d.Plugins||{},h=s.CapacitorPlatforms,f=()=>l!==null?l.name:ol(s),u=((t=h==null?void 0:h.currentPlatform)===null||t===void 0?void 0:t.getPlatform)||f,v=()=>u()!=="web",N=((r=h==null?void 0:h.currentPlatform)===null||r===void 0?void 0:r.isNativePlatform)||v,b=C=>{const L=g.get(C);return!!(L!=null&&L.platforms.has(u())||k(C))},S=((n=h==null?void 0:h.currentPlatform)===null||n===void 0?void 0:n.isPluginAvailable)||b,E=C=>{var L;return(L=d.PluginHeaders)===null||L===void 0?void 0:L.find(_=>_.name===C)},k=((a=h==null?void 0:h.currentPlatform)===null||a===void 0?void 0:a.getPluginHeader)||E,y=C=>s.console.error(C),m=(C,L,_)=>Promise.reject(`${_} does not have an implementation of "${L}".`),g=new Map,p=(C,L={})=>{const _=g.get(C);if(_)return console.warn(`Capacitor plugin "${C}" already registered. Cannot register plugins twice.`),_.proxy;const A=u(),R=k(C);let q;const z=async()=>(!q&&A in L?q=typeof L[A]=="function"?q=await L[A]():q=L[A]:l!==null&&!q&&"web"in L&&(q=typeof L.web=="function"?q=await L.web():q=L.web),q),G=(D,F)=>{var $,B;if(R){const j=R==null?void 0:R.methods.find(w=>F===w.name);if(j)return j.rtype==="promise"?w=>d.nativePromise(C,F.toString(),w):(w,U)=>d.nativeCallback(C,F.toString(),w,U);if(D)return($=D[F])===null||$===void 0?void 0:$.bind(D)}else{if(D)return(B=D[F])===null||B===void 0?void 0:B.bind(D);throw new Gt(`"${C}" plugin is not implemented on ${A}`,He.Unimplemented)}},Y=D=>{let F;const $=(...B)=>{const j=z().then(w=>{const U=G(w,D);if(U){const H=U(...B);return F=H==null?void 0:H.remove,H}else throw new Gt(`"${C}.${D}()" is not implemented on ${A}`,He.Unimplemented)});return D==="addListener"&&(j.remove=async()=>F()),j};return $.toString=()=>`${D.toString()}() { [capacitor code] }`,Object.defineProperty($,"name",{value:D,writable:!1,configurable:!1}),$},T=Y("addListener"),V=Y("removeListener"),P=(D,F)=>{const $=T({eventName:D},F),B=async()=>{const w=await $;V({eventName:D,callbackId:w},F)},j=new Promise(w=>$.then(()=>w({remove:B})));return j.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await B()},j},M=new Proxy({},{get(D,F){switch(F){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return R?P:T;case"removeListener":return V;default:return Y(F)}}});return c[C]=M,g.set(C,{name:C,proxy:M,platforms:new Set([...Object.keys(L),...R?[A]:[]])}),M},x=((o=h==null?void 0:h.currentPlatform)===null||o===void 0?void 0:o.registerPlugin)||p;return d.convertFileSrc||(d.convertFileSrc=C=>C),d.getPlatform=u,d.handleError=y,d.isNativePlatform=N,d.isPluginAvailable=S,d.pluginMethodNoop=m,d.registerPlugin=x,d.Exception=Gt,d.DEBUG=!!d.DEBUG,d.isLoggingEnabled=!!d.isLoggingEnabled,d.platform=d.getPlatform(),d.isNative=d.isNativePlatform(),d},cl=s=>s.Capacitor=ll(s),Le=cl(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Oe=Le.registerPlugin;Le.Plugins;class Qn{constructor(t){this.listeners={},this.windowListeners={},t&&(console.warn(`Capacitor WebPlugin "${t.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=t)}addListener(t,r){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(r);const a=this.windowListeners[t];a&&!a.registered&&this.addWindowListener(a);const o=async()=>this.removeListener(t,r),l=Promise.resolve({remove:o});return Object.defineProperty(l,"remove",{value:async()=>{console.warn("Using addListener() without 'await' is deprecated."),await o()}}),l}async removeAllListeners(){this.listeners={};for(const t in this.windowListeners)this.removeWindowListener(this.windowListeners[t]);this.windowListeners={}}notifyListeners(t,r){const n=this.listeners[t];n&&n.forEach(a=>a(r))}hasListeners(t){return!!this.listeners[t].length}registerWindowListener(t,r){this.windowListeners[r]={registered:!1,windowEventName:t,pluginEventName:r,handler:n=>{this.notifyListeners(r,n)}}}unimplemented(t="not implemented"){return new Le.Exception(t,He.Unimplemented)}unavailable(t="not available"){return new Le.Exception(t,He.Unavailable)}async removeListener(t,r){const n=this.listeners[t];if(!n)return;const a=n.indexOf(r);this.listeners[t].splice(a,1),this.listeners[t].length||this.removeWindowListener(this.windowListeners[t])}addWindowListener(t){window.addEventListener(t.windowEventName,t.handler),t.registered=!0}removeWindowListener(t){t&&(window.removeEventListener(t.windowEventName,t.handler),t.registered=!1)}}const tn=s=>encodeURIComponent(s).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),sn=s=>s.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class dl extends Qn{async getCookies(){const t=document.cookie,r={};return t.split(";").forEach(n=>{if(n.length<=0)return;let[a,o]=n.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");a=sn(a).trim(),o=sn(o).trim(),r[a]=o}),r}async setCookie(t){try{const r=tn(t.key),n=tn(t.value),a=`; expires=${(t.expires||"").replace("expires=","")}`,o=(t.path||"/").replace("path=",""),l=t.url!=null&&t.url.length>0?`domain=${t.url}`:"";document.cookie=`${r}=${n||""}${a}; path=${o}; ${l};`}catch(r){return Promise.reject(r)}}async deleteCookie(t){try{document.cookie=`${t.key}=; Max-Age=0`}catch(r){return Promise.reject(r)}}async clearCookies(){try{const t=document.cookie.split(";")||[];for(const r of t)document.cookie=r.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(t){return Promise.reject(t)}}async clearAllCookies(){try{await this.clearCookies()}catch(t){return Promise.reject(t)}}}Oe("CapacitorCookies",{web:()=>new dl});const ul=async s=>new Promise((t,r)=>{const n=new FileReader;n.onload=()=>{const a=n.result;t(a.indexOf(",")>=0?a.split(",")[1]:a)},n.onerror=a=>r(a),n.readAsDataURL(s)}),ml=(s={})=>{const t=Object.keys(s);return Object.keys(s).map(a=>a.toLocaleLowerCase()).reduce((a,o,l)=>(a[o]=s[t[l]],a),{})},hl=(s,t=!0)=>s?Object.entries(s).reduce((n,a)=>{const[o,l]=a;let d,c;return Array.isArray(l)?(c="",l.forEach(h=>{d=t?encodeURIComponent(h):h,c+=`${o}=${d}&`}),c.slice(0,-1)):(d=t?encodeURIComponent(l):l,c=`${o}=${d}`),`${n}&${c}`},"").substr(1):null,gl=(s,t={})=>{const r=Object.assign({method:s.method||"GET",headers:s.headers},t),a=ml(s.headers)["content-type"]||"";if(typeof s.data=="string")r.body=s.data;else if(a.includes("application/x-www-form-urlencoded")){const o=new URLSearchParams;for(const[l,d]of Object.entries(s.data||{}))o.set(l,d);r.body=o.toString()}else if(a.includes("multipart/form-data")||s.data instanceof FormData){const o=new FormData;if(s.data instanceof FormData)s.data.forEach((d,c)=>{o.append(c,d)});else for(const d of Object.keys(s.data))o.append(d,s.data[d]);r.body=o;const l=new Headers(r.headers);l.delete("content-type"),r.headers=l}else(a.includes("application/json")||typeof s.data=="object")&&(r.body=JSON.stringify(s.data));return r};class fl extends Qn{async request(t){const r=gl(t,t.webFetchExtra),n=hl(t.params,t.shouldEncodeUrlParams),a=n?`${t.url}?${n}`:t.url,o=await fetch(a,r),l=o.headers.get("content-type")||"";let{responseType:d="text"}=o.ok?t:{};l.includes("application/json")&&(d="json");let c,h;switch(d){case"arraybuffer":case"blob":h=await o.blob(),c=await ul(h);break;case"json":c=await o.json();break;case"document":case"text":default:c=await o.text()}const f={};return o.headers.forEach((u,v)=>{f[v]=u}),{data:c,headers:f,status:o.status,url:o.url}}async get(t){return this.request(Object.assign(Object.assign({},t),{method:"GET"}))}async post(t){return this.request(Object.assign(Object.assign({},t),{method:"POST"}))}async put(t){return this.request(Object.assign(Object.assign({},t),{method:"PUT"}))}async patch(t){return this.request(Object.assign(Object.assign({},t),{method:"PATCH"}))}async delete(t){return this.request(Object.assign(Object.assign({},t),{method:"DELETE"}))}}Oe("CapacitorHttp",{web:()=>new fl});const vt=Oe("App",{web:()=>Tt(()=>import("./web.Bmh9vDzE.js"),__vite__mapDeps([0,1,2])).then(s=>new s.AppWeb)});var ss;(function(s){s.Dark="DARK",s.Light="LIGHT",s.Default="DEFAULT"})(ss||(ss={}));var rn;(function(s){s.None="NONE",s.Slide="SLIDE",s.Fade="FADE"})(rn||(rn={}));const nn=Oe("StatusBar"),pl=Oe("SplashScreen",{web:()=>Tt(()=>import("./web.BX5UnY3j.js"),__vite__mapDeps([3,1,2])).then(s=>new s.SplashScreenWeb)});var an;(function(s){s.Dark="DARK",s.Light="LIGHT",s.Default="DEFAULT"})(an||(an={}));var on;(function(s){s.Body="body",s.Ionic="ionic",s.Native="native",s.None="none"})(on||(on={}));const et=Oe("Keyboard"),Rt=()=>{const[s,t]=i.useState(!1),[r,n]=i.useState("web");return i.useEffect(()=>((async()=>{const o=Le.isNativePlatform(),l=Le.getPlatform();if(t(o),n(l),o){try{await nn.setStyle({style:ss.Light}),await nn.setBackgroundColor({color:"#2563eb"})}catch(d){console.log("StatusBar not available:",d)}try{await pl.hide()}catch(d){console.log("SplashScreen not available:",d)}vt.addListener("appStateChange",({isActive:d})=>{console.log("App state changed. Is active?",d)}),vt.addListener("backButton",({canGoBack:d})=>{d?window.history.back():vt.exitApp()}),et.addListener("keyboardWillShow",d=>{console.log("Keyboard will show with height:",d.keyboardHeight)}),et.addListener("keyboardDidShow",d=>{console.log("Keyboard did show with height:",d.keyboardHeight)}),et.addListener("keyboardWillHide",()=>{console.log("Keyboard will hide")}),et.addListener("keyboardDidHide",()=>{console.log("Keyboard did hide")})}})(),()=>{s&&(vt.removeAllListeners(),et.removeAllListeners())}),[s]),{isNative:s,platform:r,isIOS:r==="ios",isAndroid:r==="android",isWeb:r==="web"}};var Ot;(function(s){s.Prompt="PROMPT",s.Camera="CAMERA",s.Photos="PHOTOS"})(Ot||(Ot={}));var ln;(function(s){s.Rear="REAR",s.Front="FRONT"})(ln||(ln={}));var Dt;(function(s){s.Uri="uri",s.Base64="base64",s.DataUrl="dataUrl"})(Dt||(Dt={}));const cn=Oe("Camera",{web:()=>Tt(()=>import("./web.CoCiFJBs.js"),__vite__mapDeps([4,1,2])).then(s=>new s.CameraWeb)}),xl=()=>{const[s,t]=i.useState(!1);return{takePhoto:async()=>{if(!Le.isNativePlatform())return null;t(!0);try{return(await cn.getPhoto({quality:90,allowEditing:!0,resultType:Dt.DataUrl,source:Ot.Prompt,width:300,height:300})).dataUrl||null}catch(a){return console.error("Error taking photo:",a),null}finally{t(!1)}},selectFromGallery:async()=>{if(!Le.isNativePlatform())return null;t(!0);try{return(await cn.getPhoto({quality:90,allowEditing:!0,resultType:Dt.DataUrl,source:Ot.Photos,width:300,height:300})).dataUrl||null}catch(a){return console.error("Error selecting from gallery:",a),null}finally{t(!1)}},isLoading:s}},vl=({currentPhotoUrl:s,onPhotoChange:t})=>{const{takePhoto:r,selectFromGallery:n,isLoading:a}=xl(),{isNative:o}=Rt(),[l,d]=i.useState(!1),c=async()=>{const u=await r();u&&t(u),d(!1)},h=async()=>{const u=await n();u&&t(u),d(!1)},f=u=>{var N;const v=(N=u.target.files)==null?void 0:N[0];v&&t(v)};return o?e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"h-32 w-32 rounded-full overflow-hidden bg-gray-100 dark:bg-gray-700",children:s?e.jsx("img",{src:(typeof s=="string"&&s.startsWith("data:"),s),alt:"Profile",className:"h-full w-full object-cover"}):e.jsx("div",{className:"h-full w-full flex items-center justify-center text-gray-400 dark:text-gray-500",children:e.jsx(rt,{className:"h-8 w-8"})})}),e.jsx("button",{onClick:()=>d(!0),disabled:a,className:"absolute bottom-0 right-0 bg-white dark:bg-gray-700 rounded-full p-2 shadow-lg hover:bg-gray-50 dark:hover:bg-gray-600 disabled:opacity-50",children:a?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-blue-600 border-t-transparent"}):e.jsx(Ut,{className:"h-4 w-4 text-gray-600 dark:text-gray-300"})}),l&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-t-lg w-full max-w-md p-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white text-center",children:"Choose Photo"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:c,className:"w-full flex items-center justify-center px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(Ut,{className:"h-5 w-5 mr-2"}),"Take Photo"]}),e.jsxs("button",{onClick:h,className:"w-full flex items-center justify-center px-4 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700",children:[e.jsx(wa,{className:"h-5 w-5 mr-2"}),"Choose from Gallery"]}),e.jsx("button",{onClick:()=>d(!1),className:"w-full flex items-center justify-center px-4 py-3 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700",children:"Cancel"})]})]})})]}):e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"h-32 w-32 rounded-full overflow-hidden bg-gray-100 dark:bg-gray-700",children:s?e.jsx("img",{src:s,alt:"Profile",className:"h-full w-full object-cover"}):e.jsx("div",{className:"h-full w-full flex items-center justify-center text-gray-400 dark:text-gray-500",children:e.jsx(rt,{className:"h-8 w-8"})})}),e.jsxs("label",{htmlFor:"photo-upload",className:"absolute bottom-0 right-0 bg-white dark:bg-gray-700 rounded-full p-2 shadow-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-600",children:[e.jsx(Ut,{className:"h-4 w-4 text-gray-600 dark:text-gray-300"}),e.jsx("input",{id:"photo-upload",type:"file",className:"hidden",accept:"image/*",onChange:f})]})]})},yl=({currentPhotoUrl:s,onPhotoChange:t})=>{const r=i.useRef(null),[n,a]=i.useState(s||void 0),{isNative:o}=Rt();i.useEffect(()=>{a(s||void 0)},[s]);const l=c=>{var f;const h=(f=c.target.files)==null?void 0:f[0];if(h){const u=new FileReader;u.onloadend=()=>{a(u.result)},u.readAsDataURL(h),t(h)}},d=c=>{if(typeof c=="string")a(c);else{const h=new FileReader;h.onloadend=()=>{a(h.result)},h.readAsDataURL(c)}t(c)};return o?e.jsx(vl,{currentPhotoUrl:n,onPhotoChange:d}):e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"h-32 w-32 rounded-full overflow-hidden bg-gray-100 dark:bg-gray-700",children:n?e.jsx("img",{src:n,alt:"Profile",className:"h-full w-full object-cover"}):e.jsx("div",{className:"h-full w-full flex items-center justify-center text-gray-400 dark:text-gray-500",children:e.jsx(rt,{className:"h-8 w-8"})})}),e.jsxs("label",{htmlFor:"photo-upload",className:"absolute bottom-0 right-0 bg-white dark:bg-gray-700 rounded-full p-2 shadow-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-600",children:[e.jsx(Pe,{className:"h-4 w-4 text-gray-600 dark:text-gray-300"}),e.jsx("input",{ref:r,id:"photo-upload",type:"file",className:"hidden",accept:"image/*",onChange:l})]}),e.jsx("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400 text-center",children:"Click to upload photo"})]})},bl={full_name:"",phone_number:"",profile_photo_url:null,email_notifications:!0,sms_notifications:!1,in_app_notifications:!0,schedule_updates:!0,team_communications:!0,all_notifications:!0,language:"en",theme:"light",additional_emails:[]},wl=()=>{const s=je(),{theme:t,toggleTheme:r}=Sn(),[n,a]=i.useState([]),[o,l]=i.useState(""),[d,c]=i.useState(!1),[h,f]=i.useState(""),[u,v]=i.useState(bl),[N,b]=i.useState(!1),[S,E]=i.useState(null);i.useEffect(()=>{k(),y()},[]);const k=async()=>{const{data:{session:L}}=await O.auth.getSession();L||s("/auth/signin",{state:{returnTo:"/settings"}})},y=async()=>{try{const{data:{user:L}}=await O.auth.getUser();L!=null&&L.email&&f(L.email);const{data:_,error:A}=await O.from("user_settings").select("*").eq("user_id",L==null?void 0:L.id).maybeSingle();if(A&&A.code!=="PGRST116"){console.error("Error loading settings:",A);return}_&&(v(_),_.additional_emails&&a(_.additional_emails.map(R=>({id:Math.random().toString(),email:R}))))}catch(L){console.error("Error loading user data:",L)}},m=()=>{o&&o.includes("@")&&(a([...n,{id:Date.now().toString(),email:o}]),l(""),c(!0))},g=L=>{a(n.filter(_=>_.id!==L)),c(!0)},p=L=>{E(L),c(!0)},x=async()=>{try{b(!0);const{data:{session:L}}=await O.auth.getSession();if(!L){s("/auth/signin",{state:{returnTo:"/settings"}});return}await Oa({...u,photo_file:S,additional_emails:n.map(_=>_.email)}),c(!1)}catch(L){console.error("Failed to save settings:",L)}finally{b(!1)}},C=(L,_)=>{v(A=>({...A,[L]:_})),c(!0)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Settings"}),d&&e.jsxs("button",{onClick:x,disabled:N,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(It,{className:"h-4 w-4 mr-2"}),N?"Saving...":"Save Changes"]})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg",children:e.jsx("div",{className:"p-6 space-y-6",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Account Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx(yl,{currentPhotoUrl:u.profile_photo_url,onPhotoChange:p}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Full Name"}),e.jsx("input",{type:"text",value:u.full_name||"",onChange:L=>C("full_name",L.target.value),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Email"}),e.jsx("input",{type:"email",value:h,disabled:!0,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm bg-gray-50 dark:bg-gray-600 text-gray-500 dark:text-gray-400"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"This is your primary email address used for authentication."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Phone Number"}),e.jsx("input",{type:"tel",value:u.phone_number||"",onChange:L=>C("phone_number",L.target.value),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"})]})]})})]}),e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Notifications"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Notification Methods"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:u.email_notifications,onChange:L=>C("email_notifications",L.target.checked),className:"rounded text-blue-600 focus:ring-blue-500 dark:bg-gray-700"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Email notifications"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:u.sms_notifications,onChange:L=>C("sms_notifications",L.target.checked),className:"rounded text-blue-600 focus:ring-blue-500 dark:bg-gray-700"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"SMS notifications"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:u.in_app_notifications,onChange:L=>C("in_app_notifications",L.target.checked),className:"rounded text-blue-600 focus:ring-blue-500 dark:bg-gray-700"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"In-app notifications"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Notification Types"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:u.schedule_updates,onChange:L=>C("schedule_updates",L.target.checked),className:"rounded text-blue-600 focus:ring-blue-500 dark:bg-gray-700"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Schedule updates"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:u.team_communications,onChange:L=>C("team_communications",L.target.checked),className:"rounded text-blue-600 focus:ring-blue-500 dark:bg-gray-700"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Team communications"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:u.all_notifications,onChange:L=>C("all_notifications",L.target.checked),className:"rounded text-blue-600 focus:ring-blue-500 dark:bg-gray-700"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"All notifications"})]})]})]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Additional Email Addresses"}),e.jsxs("div",{className:"space-y-2",children:[n.map(L=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"email",value:L.email,readOnly:!0,className:"flex-1 rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"}),e.jsx("button",{onClick:()=>g(L.id),className:"p-2 text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300",children:e.jsx(We,{className:"h-4 w-4"})})]},L.id)),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"email",value:o,onChange:L=>l(L.target.value),placeholder:"Add another email",className:"flex-1 rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"}),e.jsx("button",{onClick:m,className:"px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600",children:"Add"})]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Calendar Sync"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{className:"w-full flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600",children:[e.jsx(le,{className:"h-5 w-5 mr-2 text-red-600 dark:text-red-400"}),"Sync with Google Calendar"]}),e.jsxs("button",{className:"w-full flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600",children:[e.jsx(le,{className:"h-5 w-5 mr-2"}),"Sync with Apple Calendar"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(jt,{className:"h-5 w-5 text-gray-400 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Password"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Update your password"})]})]}),e.jsx("button",{onClick:()=>c(!0),className:"text-sm text-blue-600 dark:text-blue-400 hover:text-blue-500",children:"Change"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ba,{className:"h-5 w-5 text-gray-400 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Language"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Choose your preferred language"})]})]}),e.jsxs("select",{value:u.language,onChange:L=>C("language",L.target.value),className:"text-sm text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700",children:[e.jsx("option",{value:"en",children:"English"}),e.jsx("option",{value:"es",children:"Spanish"}),e.jsx("option",{value:"fr",children:"French"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Jt,{className:"h-5 w-5 text-gray-400 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Theme"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Choose light or dark theme"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:r,className:`p-2 rounded-md ${t==="light"?"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-300":"text-gray-600 dark:text-gray-300"}`,children:e.jsx(Jt,{className:"h-5 w-5"})}),e.jsx("button",{onClick:r,className:`p-2 rounded-md ${t==="dark"?"bg-gray-700 text-gray-300":"text-gray-600 dark:text-gray-300"}`,children:e.jsx(wn,{className:"h-5 w-5"})})]})]})]})]})})})]})},jl=({profileId:s,onClose:t,onEventAdded:r,sports:n})=>{const[a,o]=i.useState({title:"",description:"",date:"",time:"",duration:"60",location:""}),{isLoaded:l}=us({googleMapsApiKey:"AIzaSyBX5zRALfwGxan0wA6EGtcQuBbLqB2gj_E",libraries:["places"]}),d=i.useRef(null),c=u=>{const{name:v,value:N}=u.target;o(b=>({...b,[v]:N}))},h=()=>{var v;const u=(v=d.current)==null?void 0:v.getPlace();u!=null&&u.formatted_address&&o(N=>({...N,location:u.formatted_address}))},f=async u=>{var v,N;u.preventDefault();try{const b=new Date(`${a.date}T${a.time}`),S=new Date(b.getTime()+parseInt(a.duration)*6e4),{error:E}=await O.from("events").insert({profile_id:s,title:a.title,description:a.description,start_time:b.toISOString(),end_time:S.toISOString(),location:a.location,sport:((v=n[0])==null?void 0:v.name)||"General",color:((N=n[0])==null?void 0:N.color)||"#3B82F6"});if(E)throw E;r(),t()}catch(b){console.error("Failed to add event:",b),alert("Failed to add event. Please try again.")}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-auto",children:e.jsxs("form",{onSubmit:f,children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(le,{className:"h-6 w-6 text-blue-600 mr-2"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Add New Event"})]}),e.jsx("button",{type:"button",onClick:t,className:"text-gray-400 hover:text-gray-500 dark:text-gray-300 dark:hover:text-gray-200",children:e.jsx(he,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Event Title"}),e.jsx("input",{type:"text",id:"title",name:"title",value:a.title,onChange:c,required:!0,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Description"}),e.jsx("textarea",{id:"description",name:"description",value:a.description,onChange:c,rows:3,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Date"}),e.jsx("input",{type:"date",id:"date",name:"date",value:a.date,onChange:c,required:!0,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"time",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Start Time"}),e.jsx("input",{type:"time",id:"time",name:"time",value:a.time,onChange:c,required:!0,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"duration",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Duration (minutes)"}),e.jsxs("select",{id:"duration",name:"duration",value:a.duration,onChange:c,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"30",children:"30 minutes"}),e.jsx("option",{value:"45",children:"45 minutes"}),e.jsx("option",{value:"60",children:"1 hour"}),e.jsx("option",{value:"90",children:"1.5 hours"}),e.jsx("option",{value:"120",children:"2 hours"}),e.jsx("option",{value:"180",children:"3 hours"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"location",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Location"}),l?e.jsx(gs,{onLoad:u=>{d.current=u},onPlaceChanged:h,options:{types:["establishment","geocode"]},children:e.jsx("input",{type:"text",id:"location",name:"location",value:a.location,onChange:c,placeholder:"Start typing to search locations...",className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"})}):e.jsx("input",{type:"text",id:"location",name:"location",value:a.location,onChange:c,placeholder:"Loading places search...",className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",disabled:!0})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-50 dark:bg-gray-700 border-t border-gray-200 dark:border-gray-600 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Add Event"})]})]})})})},Nl=({profileId:s,onClose:t})=>{const[r,n]=i.useState([]),[a,o]=i.useState([]),[l,d]=i.useState(!0),[c,h]=i.useState(!1),[f,u]=i.useState(null);i.useEffect(()=>{(async()=>{try{const{data:E,error:k}=await O.from("platform_teams").select("*");if(k)throw k;const{data:y,error:m}=await O.from("profile_teams").select("platform_team_id").eq("profile_id",s);if(m)throw m;n(E),o(y.map(g=>g.platform_team_id))}catch(E){console.error("Error fetching teams:",E)}finally{d(!1)}})()},[s]);const v=async()=>{try{if(h(!0),await O.from("profile_teams").delete().eq("profile_id",s),a.length>0){const{error:S}=await O.from("profile_teams").insert(a.map(E=>({profile_id:s,platform_team_id:E})));if(S)throw S}for(const S of a){const E=r.find(k=>k.id===S);if(E&&E.platform==="TeamSnap")try{u(S),console.log(`TeamSnap team ${E.team_name} mapped. Events will be synced on next refresh.`)}catch(k){console.error(`Error syncing events for team ${E.team_name}:`,k)}}u(null),t()}catch(S){console.error("Error saving team mappings:",S)}finally{h(!1)}},N=S=>{o(E=>E.includes(S)?E.filter(k=>k!==S):[...E,S])};if(l)return e.jsx("div",{className:"flex items-center justify-center h-48",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});const b=r.reduce((S,E)=>(S[E.platform]||(S[E.platform]=[]),S[E.platform].push(E),S),{});return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-auto",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Map Teams"}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500 dark:text-gray-300 dark:hover:text-gray-200",children:e.jsx(he,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[Object.entries(b).map(([S,E])=>e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:S}),e.jsx("div",{className:"space-y-3",children:E.map(k=>e.jsxs("label",{className:`flex items-center p-4 rounded-lg border ${a.includes(k.id)?"border-blue-500 bg-blue-50 dark:bg-blue-900/50":"border-gray-200 dark:border-gray-700"} cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 relative`,children:[e.jsx("input",{type:"checkbox",className:"sr-only",checked:a.includes(k.id),onChange:()=>N(k.id)}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-900 dark:text-white",children:k.team_name}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:k.sport})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[f===k.id&&e.jsx(Ce,{className:"h-4 w-4 text-blue-600 animate-spin"}),a.includes(k.id)&&e.jsx(bt,{className:"h-5 w-5 text-blue-600"})]})]})})]},k.id))})]},S)),r.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No teams available. Connect to platforms to import teams."})})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-50 dark:bg-gray-700 border-t border-gray-200 dark:border-gray-600 flex justify-end space-x-3",children:[e.jsx("button",{onClick:t,className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700",children:"Cancel"}),e.jsx("button",{onClick:v,disabled:c||f!==null,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:c?e.jsxs(e.Fragment,{children:[e.jsx(Ce,{className:"h-4 w-4 mr-2 animate-spin"}),"Saving..."]}):"Save Changes"})]}),a.some(S=>{var E;return((E=r.find(k=>k.id===S))==null?void 0:E.platform)==="TeamSnap"})&&e.jsx("div",{className:"px-6 py-3 bg-blue-50 dark:bg-blue-900/50 border-t border-blue-200 dark:border-blue-800",children:e.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:[e.jsx("strong",{children:"Note:"})," TeamSnap events will be synced when you refresh the team connection or manually sync events."]})})]})})},kl=()=>{const{id:s}=aa(),t=je(),{getProfile:r,deleteProfile:n,updateProfile:a}=Ue(),[o,l]=i.useState(null),[d,c]=i.useState([]),[h,f]=i.useState(!0),[u,v]=i.useState(!1),[N,b]=i.useState(!1),[S,E]=i.useState(!1),[k,y]=i.useState(!1),[m,g]=i.useState(!1),[p,x]=i.useState("month"),[C,L]=i.useState([]),[_,A]=i.useState(null),[R,q]=i.useState(null),[z,G]=i.useState(new Date),[Y,T]=i.useState(null),[V,P]=i.useState({name:"",age:"",color:"#3B82F6",notes:""}),M=[{name:"Blue",value:"#3B82F6"},{name:"Red",value:"#EF4444"},{name:"Green",value:"#10B981"},{name:"Yellow",value:"#F59E0B"},{name:"Purple",value:"#8B5CF6"},{name:"Pink",value:"#EC4899"},{name:"Indigo",value:"#6366F1"},{name:"Teal",value:"#14B8A6"},{name:"Orange",value:"#F97316"},{name:"Cyan",value:"#06B6D4"},{name:"Lime",value:"#84CC16"},{name:"Rose",value:"#F43F5E"}],D=[{name:"Soccer",color:"#10B981"},{name:"Baseball",color:"#F59E0B"},{name:"Basketball",color:"#EF4444"},{name:"Swimming",color:"#3B82F6"},{name:"Tennis",color:"#8B5CF6"},{name:"Volleyball",color:"#EC4899"}];i.useEffect(()=>{(async()=>{if(s)try{const K=await r(s);l(K),P({name:K.name,age:K.age.toString(),color:K.color,notes:K.notes||""}),L(K.sports.map(ye=>ye.name)),q(K.photo_url||null);const{data:ge,error:de}=await O.from("events").select("*").eq("profile_id",s).order("start_time",{ascending:!0});if(de)throw de;const be=ge.map(ye=>({...ye,startTime:new Date(ye.start_time),endTime:new Date(ye.end_time),child:K,platformIcon:le}));c(be)}catch(K){console.error("Error fetching profile:",K)}finally{f(!1)}})()},[s,r]);const F=()=>{window.location.reload()},$=()=>{E(!0)},B=async()=>{try{s&&(await n(s),t("/profiles"))}catch(Z){console.error("Error deleting profile:",Z)}},j=Z=>{var ge;const K=(ge=Z.target.files)==null?void 0:ge[0];if(K){A(K);const de=new FileReader;de.onloadend=()=>{q(de.result)},de.readAsDataURL(K)}},w=Z=>{const{name:K,value:ge}=Z.target;P(de=>({...de,[K]:ge}))},U=async Z=>{if(Z.preventDefault(),!(!s||!o))try{let K=o.photo_url;if(_){const de=_.name.split(".").pop(),be=`${Math.random()}.${de}`,{data:ye,error:ie}=await O.storage.from("profile-photos").upload(be,_);if(ie)throw ie;const{data:{publicUrl:me}}=O.storage.from("profile-photos").getPublicUrl(be);K=me}await a(s,{name:V.name,age:parseInt(V.age),color:V.color,notes:V.notes,photo_url:K,sports:C.map(de=>{const be=D.find(ye=>ye.name===de);return{name:de,color:(be==null?void 0:be.color)||"#000000"}})});const ge=await r(s);l(ge),E(!1)}catch(K){console.error("Failed to update profile:",K)}},H=()=>{const Z=new Date(z);switch(p){case"month":Z.setMonth(Z.getMonth()-1);break;case"week":Z.setDate(Z.getDate()-7);break;case"day":Z.setDate(Z.getDate()-1);break}G(Z)},W=()=>{const Z=new Date(z);switch(p){case"month":Z.setMonth(Z.getMonth()+1);break;case"week":Z.setDate(Z.getDate()+7);break;case"day":Z.setDate(Z.getDate()+1);break}G(Z)},X=()=>{G(new Date)},J=()=>{const Z={year:"numeric"};switch(p){case"month":Z.month="long";break;case"week":Z.month="short",Z.day="numeric";const K=new Date(z);return K.setDate(z.getDate()+6),`${z.toLocaleDateString("en-US",{month:"short",day:"numeric"})} - ${K.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`;case"day":Z.weekday="long",Z.month="long",Z.day="numeric";break}return z.toLocaleDateString("en-US",Z)},ee=()=>{switch(p){case"month":return e.jsx(ts,{currentDate:z,events:d});case"week":return e.jsx(Hn,{currentDate:z,events:d});case"day":return e.jsx(Vn,{currentDate:z,events:d});case"agenda":return e.jsx(Wn,{currentDate:z,events:d});default:return e.jsx(ts,{currentDate:z,events:d})}};if(h)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});if(!o)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Profile not found"})});const ne=d.filter(Z=>Z.startTime>=new Date).sort((Z,K)=>Z.startTime.getTime()-K.startTime.getTime()).slice(0,5),ce=!o.isOwnProfile;return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"h-20 w-20 rounded-full overflow-hidden flex items-center justify-center relative",children:[o.photo_url?e.jsx("img",{src:o.photo_url,alt:o.name,className:"h-full w-full object-cover"}):e.jsx("div",{className:"h-full w-full flex items-center justify-center text-white text-3xl font-bold",style:{backgroundColor:o.color},children:o.name.charAt(0)}),ce&&e.jsx("div",{className:"absolute -top-1 -right-1 w-6 h-6 bg-yellow-500 rounded-full flex items-center justify-center",children:e.jsx(Be,{className:"h-3 w-3 text-white"})})]}),e.jsxs("div",{className:"ml-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:o.name}),ce&&e.jsxs("span",{className:"bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded-full font-medium",children:[o.ownerName,"'s child"]})]}),e.jsx("div",{className:"flex items-center mt-2 space-x-2",children:o.sports.map((Z,K)=>e.jsx("span",{className:"px-3 py-1 rounded-full text-sm",style:{backgroundColor:Z.color+"20",color:Z.color},children:Z.name},K))}),ce&&e.jsxs("div",{className:"mt-2 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-2",children:[e.jsxs("div",{className:"flex items-center text-yellow-800 dark:text-yellow-200",children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"text-xs font-medium",children:"Administrator Access"})]}),e.jsx("p",{className:"text-xs text-yellow-700 dark:text-yellow-300 mt-1",children:"You have full management access to this profile"})]})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>y(!0),className:"p-2 text-gray-400 hover:text-blue-500 dark:text-gray-500 dark:hover:text-blue-400 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",title:"Map teams",children:e.jsx(ve,{className:"h-5 w-5"})}),e.jsx("button",{onClick:$,className:"p-2 text-gray-400 hover:text-blue-500 dark:text-gray-500 dark:hover:text-blue-400 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",title:"Edit profile",children:e.jsx(Ca,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>b(!0),className:"p-2 text-gray-400 hover:text-red-500 dark:text-gray-500 dark:hover:text-red-400 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",title:"Delete profile",children:e.jsx(We,{className:"h-5 w-5"})})]})]})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Upcoming Events"})}),e.jsxs("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:[ne.map(Z=>e.jsx("div",{className:"p-4 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer",onClick:()=>T(Z),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full",style:{backgroundColor:Z.color}}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:Z.sport})]}),e.jsx("h3",{className:"text-base font-medium text-gray-900 dark:text-white mt-1",children:Z.title}),e.jsxs("div",{className:"mt-1 space-y-1",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:[e.jsx(Fe,{className:"h-4 w-4 mr-1"}),Z.startTime.toLocaleString()," - ",Z.endTime.toLocaleTimeString()]}),Z.location&&e.jsxs("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:[e.jsx(at,{className:"h-4 w-4 mr-1"}),Z.location]})]})]}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-500 dark:text-gray-500 dark:hover:text-gray-400",onClick:K=>{K.stopPropagation()},children:e.jsx(Nn,{className:"h-5 w-5"})})]})},Z.id)),ne.length===0&&e.jsx("div",{className:"p-6 text-center",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No upcoming events"})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:H,className:"p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",children:e.jsx(pn,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"})}),e.jsx("button",{onClick:X,className:"px-3 py-1 text-sm bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600",children:"Today"}),e.jsx("button",{onClick:W,className:"p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",children:e.jsx(xn,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"})}),e.jsx("h2",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300 ml-2",children:J()})]}),e.jsxs("button",{onClick:()=>g(!m),className:"flex items-center px-3 py-1.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 text-sm",children:[e.jsx(vn,{className:"h-4 w-4 mr-1"}),"Filter"]}),e.jsxs("div",{className:"bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md p-1 flex",children:[e.jsx("button",{onClick:()=>x("month"),className:`p-1 rounded ${p==="month"?"bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-400":"text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-600"}`,title:"Month view",children:e.jsx(le,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>x("agenda"),className:`p-1 rounded ${p==="agenda"?"bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-400":"text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-600"}`,title:"List view",children:e.jsx(bn,{className:"h-5 w-5"})})]})]}),e.jsxs("button",{onClick:()=>v(!0),className:`px-4 py-2 text-white rounded-md hover:opacity-90 flex items-center ${ce?"bg-yellow-600 hover:bg-yellow-700":"bg-blue-600 hover:bg-blue-700"}`,children:[e.jsx(Pe,{className:"h-5 w-5 mr-2"}),"Add Event"]})]})}),e.jsx("div",{className:"h-[600px] overflow-auto",children:ee()})]}),u&&e.jsx(jl,{profileId:o.id,onClose:()=>v(!1),onEventAdded:F,sports:o.sports}),Y&&e.jsx(Ze,{event:Y,onClose:()=>T(null)}),N&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsx("div",{className:"flex items-center justify-center text-red-600 dark:text-red-400 mb-4",children:e.jsx(yt,{className:"h-12 w-12"})}),e.jsx("h3",{className:"text-lg font-medium text-center text-gray-900 dark:text-white mb-2",children:"Delete Profile"}),e.jsxs("p",{className:"text-center text-gray-500 dark:text-gray-400 mb-6",children:["Are you sure you want to delete ",o.name,"'s profile? This action cannot be undone."]}),e.jsxs("div",{className:"flex justify-center space-x-3",children:[e.jsx("button",{onClick:()=>b(!1),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600",children:"Cancel"}),e.jsx("button",{onClick:B,className:"px-4 py-2 border border-transparent rounded-md text-sm font-medium text-white bg-red-600 hover:bg-red-700",children:"Delete Profile"})]})]})}),S&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-auto",children:e.jsxs("form",{onSubmit:U,children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:ce?e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{children:"Edit Profile"}),e.jsxs("span",{className:"ml-2 bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded-full font-medium",children:[o.ownerName,"'s child"]})]}):"Edit Profile"}),e.jsx("button",{type:"button",onClick:()=>E(!1),className:"text-gray-400 hover:text-gray-500 dark:text-gray-300 dark:hover:text-gray-200",children:e.jsx(he,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex-shrink-0",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"h-32 w-32 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center overflow-hidden",children:R?e.jsx("img",{src:R,alt:"Preview",className:"h-full w-full object-cover"}):e.jsx(rt,{className:"h-8 w-8 text-gray-400 dark:text-gray-500"})}),e.jsxs("label",{htmlFor:"photo",className:"absolute bottom-0 right-0 bg-white dark:bg-gray-700 rounded-full p-2 shadow-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-600",children:[e.jsx(Pe,{className:"h-4 w-4 text-gray-600 dark:text-gray-300"}),e.jsx("input",{type:"file",id:"photo",className:"hidden",accept:"image/*",onChange:j})]})]}),e.jsx("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400 text-center",children:"Click to upload photo"})]}),e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Name"}),e.jsx("input",{type:"text",id:"name",name:"name",value:V.name,onChange:w,placeholder:"Enter child's name",className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0,autoComplete:"off"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"age",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Age"}),e.jsx("input",{type:"number",id:"age",name:"age",value:V.age,onChange:w,min:"1",max:"18",placeholder:"Enter age",className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",required:!0,autoComplete:"off"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"color",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Profile Color"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx("select",{id:"color",name:"color",value:V.color,onChange:w,className:"block w-full pl-8 pr-10 py-2 text-base border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md dark:bg-gray-700 dark:text-white",children:M.map(Z=>e.jsx("option",{value:Z.value,className:"flex items-center",children:Z.name},Z.value))}),e.jsx("div",{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 rounded-full pointer-events-none",style:{backgroundColor:V.color}})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Sports & Activities"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:D.map(Z=>e.jsxs("label",{className:`flex items-center p-3 rounded-lg border dark:border-gray-600 cursor-pointer transition-colors ${C.includes(Z.name)?"border-blue-500 bg-blue-50 dark:bg-blue-900/50":"border-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:[e.jsx("input",{type:"checkbox",className:"hidden",checked:C.includes(Z.name),onChange:K=>{K.target.checked?L([...C,Z.name]):L(C.filter(ge=>ge!==Z.name))}}),e.jsx("span",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:Z.color}}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:Z.name})]},Z.name))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Additional Notes"}),e.jsx("textarea",{id:"notes",name:"notes",value:V.notes,onChange:w,rows:3,placeholder:"Enter any important information about your child...",className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"})]}),ce&&e.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center text-yellow-800 dark:text-yellow-200 mb-2",children:[e.jsx(Be,{className:"h-5 w-5 mr-2"}),e.jsx("span",{className:"font-medium",children:"Administrator Access"})]}),e.jsxs("p",{className:"text-sm text-yellow-700 dark:text-yellow-300",children:["You are editing ",o.ownerName,"'s child profile. Any changes you make will be visible to them."]})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-50 dark:bg-gray-700 border-t border-gray-200 dark:border-gray-600 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>E(!1),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700",children:"Cancel"}),e.jsx("button",{type:"submit",className:`px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white focus:outline-none focus:ring-2 focus:ring-offset-2 ${ce?"bg-yellow-600 hover:bg-yellow-700 focus:ring-yellow-500":"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500"}`,children:"Save Changes"})]})]})})}),k&&e.jsx(Nl,{profileId:o.id,onClose:()=>y(!1)})]})},Cl=()=>e.jsx("div",{className:"min-h-[80vh] flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-6xl font-bold text-gray-900 mb-4",children:"404"}),e.jsx("p",{className:"text-xl text-gray-600 mb-8",children:"Page not found"}),e.jsxs(qe,{to:"/",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[e.jsx(yn,{className:"h-5 w-5 mr-2"}),"Back to Dashboard"]})]})});async function Ll(){try{const s=new Promise((l,d)=>setTimeout(()=>d(new Error("Connection timeout")),1e4)),t=O.from("profiles").select("count").limit(0).throwOnError(),{data:r,error:n}=await Promise.race([t,s]);if(n)return console.error("Database connection test failed:",n),{success:!1,error:"Database connection failed",details:{message:n.message,code:n.code,hint:n.hint}};const{data:a,error:o}=await O.auth.getSession();return o?(console.error("Auth service test failed:",o),{success:!1,error:"Authentication service failed",details:{message:o.message,name:o.name}}):{success:!0,message:"Connection successful",details:{dbConnected:!0,authConnected:!0}}}catch(s){return console.error("Connection test failed:",s),{success:!1,error:"Connection test failed",details:s instanceof Error?{message:s.message,name:s.name}:{message:"Unknown error occurred"}}}}const El=()=>{var d;const s=je(),r=((d=rs().state)==null?void 0:d.returnTo)||"/",[n,a]=i.useState(null),[o,l]=i.useState(null);return i.useEffect(()=>{(async()=>{const f=await Ll();l(f)})();const{data:{subscription:h}}=O.auth.onAuthStateChange((f,u)=>{f==="SIGNED_IN"&&u&&s(r),a(null)});return()=>h.unsubscribe()},[s,r]),e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Sign in to TeamSync"}),e.jsxs("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Or"," ",e.jsx(qe,{to:"/auth/signup",className:"font-medium text-blue-600 hover:text-blue-500",children:"create a new account"})]})]}),e.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:e.jsxs("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:[o&&!o.success&&e.jsx("div",{className:"mb-4 bg-red-50 border border-red-200 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(Ve,{className:"h-5 w-5 text-red-400"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Connection Error"}),e.jsxs("div",{className:"mt-2 text-sm text-red-700",children:[e.jsx("p",{children:o.error}),o.details&&e.jsx("pre",{className:"mt-2 text-xs bg-red-100 p-2 rounded overflow-auto",children:JSON.stringify(o.details,null,2)})]})]})]})}),n&&e.jsx("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded relative",role:"alert",children:e.jsx("p",{className:"text-sm",children:n})}),e.jsx(un,{supabaseClient:O,appearance:{theme:mn,style:{message:{color:"red"}}},providers:["google","apple","facebook"],redirectTo:`${window.location.origin}/auth/callback`,view:"sign_in",onError:c=>{a(c.message)}}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx(qe,{to:"/auth/forgot-password",className:"text-sm font-medium text-blue-600 hover:text-blue-500",children:"Forgot your password?"})})]})})]})},Sl=()=>{const s=je();return i.useEffect(()=>{const{data:{subscription:t}}=O.auth.onAuthStateChange(r=>{r==="SIGNED_IN"&&s("/settings")});return()=>t.unsubscribe()},[s]),e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Create your account"}),e.jsxs("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Already have an account?"," ",e.jsx(qe,{to:"/auth/signin",className:"font-medium text-blue-600 hover:text-blue-500",children:"Sign in here"})]})]}),e.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:e.jsx("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:e.jsx(un,{supabaseClient:O,appearance:{theme:mn},providers:[],redirectTo:`${window.location.origin}/auth/callback`,view:"sign_up"})})})]})},_l=()=>{const[s,t]=i.useState(""),[r,n]=i.useState(!1),[a,o]=i.useState(!1),[l,d]=i.useState(null),c=async h=>{h.preventDefault(),n(!0),d(null);try{const f=`${window.location.origin}/auth/reset-password`,{error:u}=await O.auth.resetPasswordForEmail(s,{redirectTo:f});if(u)throw u;o(!0)}catch(f){d(f instanceof Error?f.message:"An error occurred")}finally{n(!1)}};return a?e.jsx("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:e.jsx("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:e.jsx("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 mb-4",children:e.jsx(fe,{className:"h-6 w-6 text-green-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Check your email"}),e.jsxs("p",{className:"text-gray-600 mb-6",children:["We've sent a password reset link to ",e.jsx("strong",{children:s})]}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Didn't receive the email? Check your spam folder or try again."}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>{o(!1),t("")},className:"w-full flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Try again"}),e.jsx(qe,{to:"/auth/signin",className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Back to sign in"})]})]})})})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"mt-6 text-3xl font-extrabold text-gray-900",children:"Forgot your password?"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Enter your email address and we'll send you a link to reset your password."})]})}),e.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:e.jsxs("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:[e.jsxs("form",{onSubmit:c,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(os,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:s,onChange:h=>t(h.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Enter your email address"})]})]}),l&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(Ve,{className:"h-5 w-5 text-red-400"}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-700",children:l})})]})}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:r||!s,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"}),"Sending..."]}):"Send reset link"})})]}),e.jsx("div",{className:"mt-6",children:e.jsxs(qe,{to:"/auth/signin",className:"flex items-center justify-center text-sm font-medium text-blue-600 hover:text-blue-500",children:[e.jsx(as,{className:"h-4 w-4 mr-2"}),"Back to sign in"]})})]})})]})},Ml=()=>{const s=je(),[t]=dn(),[r,n]=i.useState(""),[a,o]=i.useState(""),[l,d]=i.useState(!1),[c,h]=i.useState(!1),[f,u]=i.useState(!1),[v,N]=i.useState(null),[b,S]=i.useState(!1);i.useEffect(()=>{const y=t.get("access_token"),m=t.get("refresh_token");if(!y||!m){N("Invalid or expired reset link. Please request a new password reset.");return}O.auth.setSession({access_token:y,refresh_token:m})},[t]);const E=y=>y.length<8?"Password must be at least 8 characters long":/(?=.*[a-z])/.test(y)?/(?=.*[A-Z])/.test(y)?/(?=.*\d)/.test(y)?null:"Password must contain at least one number":"Password must contain at least one uppercase letter":"Password must contain at least one lowercase letter",k=async y=>{if(y.preventDefault(),N(null),r!==a){N("Passwords do not match");return}const m=E(r);if(m){N(m);return}u(!0);try{const{error:g}=await O.auth.updateUser({password:r});if(g)throw g;S(!0),setTimeout(()=>{s("/auth/signin",{state:{message:"Password updated successfully. Please sign in with your new password."}})},3e3)}catch(g){N(g instanceof Error?g.message:"An error occurred while updating your password")}finally{u(!1)}};return b?e.jsx("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:e.jsx("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:e.jsx("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 mb-4",children:e.jsx(fe,{className:"h-6 w-6 text-green-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Password updated!"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Your password has been successfully updated."}),e.jsx("p",{className:"text-sm text-gray-500",children:"Redirecting you to the sign in page..."}),e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-blue-600 border-t-transparent mx-auto"})})]})})})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"mt-6 text-3xl font-extrabold text-gray-900",children:"Reset your password"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Enter your new password below"})]})}),e.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:e.jsx("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:e.jsxs("form",{onSubmit:k,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"New Password"}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(jt,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"password",name:"password",type:l?"text":"password",required:!0,value:r,onChange:y=>n(y.target.value),className:"block w-full pl-10 pr-10 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Enter your new password"}),e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx("button",{type:"button",onClick:()=>d(!l),className:"text-gray-400 hover:text-gray-500 focus:outline-none",children:l?e.jsx(Ds,{className:"h-5 w-5"}):e.jsx(Kt,{className:"h-5 w-5"})})})]}),e.jsx("div",{className:"mt-2 text-xs text-gray-500",children:"Password must be at least 8 characters with uppercase, lowercase, and number"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm New Password"}),e.jsxs("div",{className:"mt-1 relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(jt,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:c?"text":"password",required:!0,value:a,onChange:y=>o(y.target.value),className:"block w-full pl-10 pr-10 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Confirm your new password"}),e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx("button",{type:"button",onClick:()=>h(!c),className:"text-gray-400 hover:text-gray-500 focus:outline-none",children:c?e.jsx(Ds,{className:"h-5 w-5"}):e.jsx(Kt,{className:"h-5 w-5"})})})]})]}),v&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(Ve,{className:"h-5 w-5 text-red-400"}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-700",children:v})})]})}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:f||!r||!a,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"}),"Updating password..."]}):"Update password"})})]})})})]})},Pl=()=>{const s=je();return i.useEffect(()=>{O.auth.onAuthStateChange(t=>{t==="SIGNED_IN"&&s("/")})},[s]),e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})},Te=Oe("PushNotifications",{}),Ol=()=>{const[s,t]=i.useState(null),[r,n]=i.useState(!1);return i.useEffect(()=>Le.isNativePlatform()?((async()=>{try{(await Te.requestPermissions()).receive==="granted"&&(await Te.register(),n(!0)),Te.addListener("registration",d=>{console.log("Push registration success, token: "+d.value),t(d.value)}),Te.addListener("registrationError",d=>{console.error("Error on registration: "+JSON.stringify(d))}),Te.addListener("pushNotificationReceived",d=>{console.log("Push notification received: ",d)}),Te.addListener("pushNotificationActionPerformed",d=>{console.log("Push notification action performed",d);const c=d.notification.data;(c==null?void 0:c.type)==="message"||(c==null?void 0:c.type)==="friend_request"?window.location.href="/friends":(c==null?void 0:c.type)==="schedule_change"&&(window.location.href="/calendar")})}catch(l){console.error("Error initializing push notifications:",l)}})(),()=>{Te.removeAllListeners()}):void 0,[]),{token:s,isRegistered:r,sendLocalNotification:async(o,l,d)=>{if(Le.isNativePlatform())try{const{LocalNotifications:c}=await Tt(async()=>{const{LocalNotifications:h}=await import("./index.DKlBgY7z.js");return{LocalNotifications:h}},__vite__mapDeps([5,2,1]));await c.schedule({notifications:[{title:o,body:l,id:Date.now(),extra:d,schedule:{at:new Date(Date.now()+1e3)}}]})}catch(c){console.error("Error sending local notification:",c)}}}},Dl=({children:s})=>{const{isNative:t,isIOS:r,isAndroid:n}=Rt();return Ol(),i.useEffect(()=>{if(t){document.body.classList.add("mobile-app"),r&&(document.body.classList.add("ios"),document.documentElement.style.setProperty("--safe-area-inset-top","env(safe-area-inset-top)"),document.documentElement.style.setProperty("--safe-area-inset-bottom","env(safe-area-inset-bottom)")),n&&document.body.classList.add("android");const a=document.querySelector("meta[name=viewport]");a&&a.setAttribute("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"),document.addEventListener("touchstart",()=>{},{passive:!0}),document.addEventListener("touchmove",()=>{},{passive:!0})}return()=>{t&&document.body.classList.remove("mobile-app","ios","android")}},[t,r,n]),i.useEffect(()=>{if(t){const a=document.createElement("style");return a.textContent=`
        .mobile-app {
          -webkit-touch-callout: none;
          -webkit-user-select: none;
          -webkit-tap-highlight-color: transparent;
          overscroll-behavior: none;
        }
        
        .ios {
          padding-top: var(--safe-area-inset-top, 0);
          padding-bottom: var(--safe-area-inset-bottom, 0);
        }
        
        .mobile-app input,
        .mobile-app textarea {
          font-size: 16px !important; /* Prevent zoom on iOS */
        }
        
        .mobile-app .scroll-container {
          -webkit-overflow-scrolling: touch;
        }
        
        /* Better touch targets */
        .mobile-app button,
        .mobile-app a {
          min-height: 44px;
          min-width: 44px;
        }
        
        /* Smooth scrolling */
        .mobile-app {
          scroll-behavior: smooth;
        }
      `,document.head.appendChild(a),()=>{document.head.removeChild(a)}}},[t]),e.jsx(e.Fragment,{children:s})};function Tl(){const[s,t]=i.useState(null),[r,n]=i.useState(!0);return i.useEffect(()=>{O.auth.getSession().then(({data:{session:o}})=>{t((o==null?void 0:o.user)??null),n(!1)});const{data:{subscription:a}}=O.auth.onAuthStateChange((o,l)=>{t((l==null?void 0:l.user)??null),n(!1)});return()=>a.unsubscribe()},[]),{user:s,loading:r}}const ps=()=>e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),Al=({children:s})=>{const[t,r]=Me.useState(!1),[n,a]=Me.useState("");return Me.useEffect(()=>{const o=l=>{r(!0),a(l.message)};return window.addEventListener("error",o),()=>window.removeEventListener("error",o)},[]),t?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-xl font-bold text-red-600 mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:n}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Reload Page"})]})}):e.jsx(e.Fragment,{children:s})},Il=({children:s})=>{const{user:t,loading:r}=Tl();return r?e.jsx(ps,{}):t?e.jsx(e.Fragment,{children:s}):e.jsx(la,{to:"/auth/signin",replace:!0})},Rl=()=>{const[s,t]=Me.useState(!1),[r,n]=Me.useState(null);return Rt(),i.useEffect(()=>{(async()=>{try{if(!await kn())throw new Error("Failed to connect to the backend services");t(!0)}catch(o){n(o instanceof Error?o.message:"Failed to initialize application")}})()},[]),r?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-xl font-bold text-red-600 mb-2",children:"Connection Error"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:r}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Retry Connection"})]})}):s?e.jsx(ia,{children:e.jsxs(oa,{children:[e.jsx(xe,{path:"/auth/signin",element:e.jsx(El,{})}),e.jsx(xe,{path:"/auth/signup",element:e.jsx(Sl,{})}),e.jsx(xe,{path:"/auth/forgot-password",element:e.jsx(_l,{})}),e.jsx(xe,{path:"/auth/reset-password",element:e.jsx(Ml,{})}),e.jsx(xe,{path:"/auth/callback",element:e.jsx(Pl,{})}),e.jsx(xe,{path:"/connections/teamsnap/callback",element:e.jsx(el,{})}),e.jsxs(xe,{path:"/",element:e.jsx(Il,{children:e.jsx(Ba,{})}),children:[e.jsx(xe,{index:!0,element:e.jsx(Po,{})}),e.jsx(xe,{path:"calendar",element:e.jsx(Do,{})}),e.jsx(xe,{path:"connections",element:e.jsx(To,{})}),e.jsx(xe,{path:"connections/teamsnap",element:e.jsx(Xo,{})}),e.jsx(xe,{path:"connections/playmetrics",element:e.jsx(tl,{})}),e.jsx(xe,{path:"profiles",element:e.jsx(sl,{})}),e.jsx(xe,{path:"profiles/:id",element:e.jsx(kl,{})}),e.jsx(xe,{path:"friends",element:e.jsx(nl,{})}),e.jsx(xe,{path:"settings",element:e.jsx(wl,{})}),e.jsx(xe,{path:"*",element:e.jsx(Cl,{})})]})]})}):e.jsx(ps,{})};function Fl(){return e.jsx(Al,{children:e.jsx("div",{className:"min-h-screen min-w-full bg-gray-50 dark:bg-gray-900",children:e.jsx(Ia,{children:e.jsx(Aa,{children:e.jsx(Da,{children:e.jsx(Dl,{children:e.jsx(i.Suspense,{fallback:e.jsx(ps,{}),children:e.jsx(Rl,{})})})})})})})})}const Xn=document.getElementById("root");if(!Xn)throw new Error("Root element not found");const Ul=fn(Xn);O.auth.onAuthStateChange((s,t)=>{(s==="SIGNED_OUT"||s==="USER_DELETED")&&window.localStorage.removeItem("supabase.auth.token")});Ul.render(e.jsx(i.StrictMode,{children:e.jsx(Fl,{})}));export{Ot as C,Qn as W,ln as a,Gt as b,Oe as r};
//# sourceMappingURL=index.BLLJjg3v.js.map
